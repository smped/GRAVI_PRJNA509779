<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>H3K27ac Differential Binding: E2DHT Vs. E2</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/core-js-2.5.3/shim.min.js"></script>
<script src="site_libs/react-17.0.0/react.min.js"></script>
<script src="site_libs/react-17.0.0/react-dom.min.js"></script>
<script src="site_libs/reactwidget-1.0.0/react-tools.js"></script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="site_libs/reactable-0.4.4/reactable.css" rel="stylesheet" />
<script src="site_libs/reactable-binding-0.4.4/reactable.js"></script>
<link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="gravi.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GRAVI</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="annotation_description.html">Annotations</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    MACS2 Peak Calling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="AR_macs2_summary.html">AR</a>
    </li>
    <li>
      <a href="ER_macs2_summary.html">ER</a>
    </li>
    <li>
      <a href="H3K27ac_macs2_summary.html">H3K27ac</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Differential Binding
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">AR</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="AR_E2_E2DHT_differential_binding.html">E2DHT Vs. E2</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">ER</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="ER_E2_E2DHT_differential_binding.html">E2DHT Vs. E2</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">H3K27ac</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="H3K27ac_E2_E2DHT_differential_binding.html">E2DHT Vs. E2</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pairwise Comparisons
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">AR-ER</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="AR_E2_E2DHT_ER_E2_E2DHT_pairwise_comparison.html">E2DHT Vs. E2 / E2DHT Vs. E2</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">AR-H3K27ac</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="AR_E2_E2DHT_H3K27ac_E2_E2DHT_pairwise_comparison.html">E2DHT Vs. E2 / E2DHT Vs. E2</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">ER-H3K27ac</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="ER_E2_E2DHT_H3K27ac_E2_E2DHT_pairwise_comparison.html">E2DHT Vs. E2 / E2DHT Vs. E2</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/steveped/GRAVI">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">H3K27ac Differential Binding: E2DHT Vs.
E2</h1>
<h4 class="date">29 June, 2023</h4>

</div>


<pre class="r"><code>target &lt;- &quot;H3K27ac&quot;
treat_levels &lt;- c(&quot;E2&quot;, &quot;E2DHT&quot;)
threads &lt;- 1</code></pre>
<pre class="r"><code>library(tidyverse)
library(glue)
library(pander)
library(BiocParallel)
library(yaml)
library(plyranges)
library(rtracklayer)
library(GenomeInfoDb)
library(Rsamtools)
library(cowplot)
library(ngsReports)
library(csaw)
library(edgeR)
library(scales)
library(magrittr)
library(statmod)
library(IHW)
library(ggrepel)
library(rlang)
library(ggside)
library(InteractionSet)
library(GenomicInteractions)
library(reactable)
library(htmltools)
library(msigdbr)
library(goseq)
library(extraChIPs)
library(tidygraph)
library(ggraph)
library(metap)</code></pre>
<pre class="r"><code>panderOptions(&quot;big.mark&quot;, &quot;,&quot;)
panderOptions(&quot;missing&quot;, &quot;&quot;)
panderOptions(&quot;table.split.table&quot;, Inf)
theme_set(
  theme_bw() +
  theme(
    plot.title = element_text(hjust = 0.5)
  )
)
register(MulticoreParam(workers = threads))
source(here::here(&quot;workflow&quot;, &quot;scripts&quot;, &quot;custom_functions.R&quot;))</code></pre>
<pre class="r"><code>params &lt;- read_yaml(here::here(&quot;config&quot;, &quot;params.yml&quot;))
config &lt;- read_yaml(here::here(&quot;config&quot;, &quot;config.yml&quot;))
macs2_path &lt;- here::here(&quot;output&quot;, &quot;macs2&quot;, target)
samples &lt;- file.path(macs2_path, &quot;qc_samples.tsv&quot;) %&gt;% 
  read_tsv() %&gt;% 
  dplyr::filter(
    qc == &quot;pass&quot;,
    treat %in% treat_levels
  ) %&gt;% 
  mutate(treat = factor(treat, levels = treat_levels)) %&gt;% 
  droplevels()
stopifnot(nrow(samples) &gt; 0)
rep_col &lt;- setdiff(
  colnames(samples), c(&quot;sample&quot;, &quot;treat&quot;, &quot;target&quot;, &quot;input&quot;, &quot;label&quot;, &quot;qc&quot;)
)
samples[[rep_col]] &lt;- as.factor(samples[[rep_col]])
fdr_alpha &lt;- config$comparisons$fdr
db_method &lt;- match.arg(config$comparisons$method, c(&quot;sq-lt&quot;, &quot;ls-ql&quot;))
ihw_opts &lt;- c(&quot;regions&quot;, &quot;features&quot;, &quot;targets&quot;)
ihw_method &lt;- c(
  intersect(str_to_lower(config$comparisons$ihw), ihw_opts), &quot;none&quot;
)
ihw_method &lt;- ihw_method[[1]]</code></pre>
<pre class="r"><code>bam_path &lt;- here::here(config$paths$bam)
stopifnot(dir.exists(bam_path))
annotation_path &lt;- here::here(&quot;output&quot;, &quot;annotations&quot;)
stopifnot(dir.exists(annotation_path))
out_path &lt;- here::here(&quot;output&quot;, &quot;differential_binding&quot;, target)
if (!dir.exists(out_path)) dir.create(out_path)</code></pre>
<pre class="r"><code>sq &lt;- file.path(annotation_path, &quot;seqinfo.rds&quot;) %&gt;% 
  read_rds()
blacklist &lt;- here::here(annotation_path, &quot;blacklist.bed.gz&quot;) %&gt;%
  import.bed(seqinfo = sq) %&gt;%
  sort()

cb &lt;- config$genome$build %&gt;% 
  str_to_lower() %&gt;% 
  paste0(&quot;.cytobands&quot;) 
data(list = cb)
bands_df &lt;- get(cb)
stopifnot(
  colnames(bands_df) == c(&quot;chrom&quot;, &quot;chromStart&quot;, &quot;chromEnd&quot;, &quot;name&quot;, &quot;gieStain&quot;)
)

all_gr &lt;- file.path(annotation_path, &quot;all_gr.rds&quot;) %&gt;% 
  read_rds() 
genes_gr &lt;- all_gr$gene
id2gene &lt;- structure(genes_gr$gene_name, names = genes_gr$gene_id)
trans_models &lt;- file.path(annotation_path, &quot;trans_models.rds&quot;) %&gt;% 
  read_rds() 

external_features &lt;- GRanges(seqinfo = sq)
if (!is.null(config$external$features)) {
  external_features &lt;- suppressWarnings(
    import.gff(here::here(config$external$features), genome = sq)
  )
  keep_cols &lt;- !vapply(
    mcols(external_features), function(x) all(is.na(x)), logical(1)
  )
  mcols(external_features) &lt;- mcols(external_features)[keep_cols]
}
has_features &lt;- length(external_features) &gt; 0
gene_regions &lt;- file.path(annotation_path, &quot;gene_regions.rds&quot;) %&gt;% 
  read_rds()
regions &lt;- vapply(gene_regions, function(x) unique(x$region), character(1))

rna_path &lt;- here::here(config$external$rnaseq)
rnaseq &lt;- tibble(gene_id = character())
if (length(rna_path) &gt; 0) {
  stopifnot(file.exists(rna_path))
  if (str_detect(rna_path, &quot;tsv$&quot;)) rnaseq &lt;- read_tsv(rna_path)
  if (str_detect(rna_path, &quot;csv$&quot;)) rnaseq &lt;- read_csv(rna_path)
  if (!&quot;gene_id&quot; %in% colnames(rnaseq)) stop(&quot;Supplied RNA-Seq data must contain the column &#39;gene_id&#39;&quot;)
  genes_gr &lt;- subset(genes_gr, gene_id %in% rnaseq$gene_id)
  rna_lfc_col &lt;- colnames(rnaseq)[str_detect(str_to_lower(colnames(rnaseq)), &quot;logfc&quot;)][1]
  rna_fdr_col &lt;- colnames(rnaseq)[str_detect(str_to_lower(colnames(rnaseq)), &quot;fdr|adjp&quot;)][1]
}
has_rnaseq &lt;- as.logical(nrow(rnaseq))
tx_col &lt;- intersect(c(&quot;tx_id&quot;, &quot;transcript_id&quot;), colnames(rnaseq))
rna_gr_col &lt;- ifelse(length(tx_col) &gt; 0, &quot;transcript_id&quot;, &quot;gene_id&quot;)
rna_col &lt;- c(tx_col, &quot;gene_id&quot;)[[1]]</code></pre>
<pre class="r"><code>colours &lt;- read_rds(here::here(&quot;output&quot;, &quot;annotations&quot;, &quot;colours.rds&quot;)) %&gt;% 
  lapply(unlist)
region_colours &lt;- setNames(colours$regions, regions[names(colours$regions)])
if (has_features)
  feature_colours &lt;- setNames(
    colours$features, str_sep_to_title(names(colours$features))
  )
direction_colours &lt;- colours$direction %&gt;% 
  setNames(str_to_title(names(.))) %&gt;% 
  .[names(.) %in% c(&quot;Up&quot;, &quot;Down&quot;, &quot;Unchanged&quot;, &quot;Ambiguous&quot;)]
treat_colours &lt;- colours$treat[treat_levels]
fig_dev &lt;- knitr::opts_chunk$get(&quot;dev&quot;)
fig_type &lt;- fig_dev[[1]]
if (is.null(fig_type)) stop(&quot;Couldn&#39;t detect figure type&quot;)</code></pre>
<pre class="r"><code>hic &lt;- GInteractions()
hic_path &lt;- here::here(config$external$hic)
if (length(hic_path) &gt; 0)
  if (file.exists(hic_path)) {
    has_hic &lt;- TRUE
    hic &lt;- makeGenomicInteractionsFromFile(hic_path, type = &quot;bedpe&quot;)
    reg_combs &lt;- expand.grid(regions, regions) %&gt;% 
      as.matrix() %&gt;% 
      apply(
        MARGIN = 1, 
        function(x) {
          x &lt;- sort(factor(x, levels = regions))
          paste(as.character(x), collapse = &quot; - &quot;)
        }
      ) %&gt;% 
      unique()
    hic$regions &lt;- anchors(hic) %&gt;% 
      vapply(
        bestOverlap,
        y = GRangesList(lapply(gene_regions, granges)),
        character(length(hic))
      ) %&gt;% 
      apply(MARGIN = 2, function(x) regions[x]) %&gt;% 
      apply(
        MARGIN = 1, 
        function(x) {
          x &lt;- sort(factor(x, levels = regions))
          paste(as.character(x), collapse = &quot; - &quot;)
        }
      ) %&gt;% 
      factor(levels = reg_combs) %&gt;%
      fct_relabel(
        str_replace_all,
        pattern = &quot;Promoter \\([0-9kbp/\\+-]+\\)&quot;, replacement = &quot;Promoter&quot;
      )
    if (has_features) {
      feat_combs &lt;- expand.grid(names(feature_colours), names(feature_colours)) %&gt;% 
        as.matrix() %&gt;% 
        apply(
          MARGIN = 1, 
          function(x) {
            x &lt;- sort(factor(x, levels = names(feature_colours)))
            paste(as.character(x), collapse = &quot; - &quot;)
          }
        ) %&gt;% 
        unique()
      hic$features &lt;- vapply(
        anchors(hic),
        function(x) bestOverlap(
          x, external_features, var = &quot;feature&quot;, missing = &quot;no_feature&quot;
        ),
        character(length(hic))
      )  %&gt;% 
        apply(
          MARGIN = 1, 
          function(x) {
            x &lt;- sort(factor(x, levels = names(feature_colours)))
            paste(as.character(x), collapse = &quot; - &quot;)
          }
        ) %&gt;% 
        factor(levels = feat_combs) %&gt;%
        fct_relabel(str_sep_to_title, pattern = &quot;_&quot;)
    }
  }
stopifnot(is(hic, &quot;GInteractions&quot;))
seqlevels(hic) &lt;- seqlevels(sq)
seqinfo(hic) &lt;- sq
hic &lt;- hic[!overlapsAny(hic, blacklist)]
has_hic &lt;- as.logical(length(hic))</code></pre>
<pre class="r"><code>facet_labeller &lt;- as_labeller(
  c(
    c(
      `TRUE` = &quot;Consensus Peak&quot;,
      `FALSE` = &quot;No Consensus Peak&quot;
    ),
    structure(treat_levels, names = treat_levels),
    c(
      Up = glue(&quot;Increased {target} Binding&quot;),
      Down = glue(&quot;Decreased {target} Binding&quot;)
    ),
    c(
      AveExpr = &quot;logCPM&quot;, logFC = &quot;logFC&quot;
    )
  )
)</code></pre>
<pre class="r"><code>all_out &lt;- list(
  results = file.path(
    out_path, 
    glue(&quot;{target}_{treat_levels[[1]]}_{treat_levels[[2]]}-differential_binding.rds&quot;)
  ),
  csv = file.path(
    out_path, 
    glue(&quot;{target}_{treat_levels[[1]]}_{treat_levels[[2]]}-differential_binding.csv.gz&quot;)
  ),
  windows  = file.path(
    out_path,
    glue(&quot;{target}_{treat_levels[[1]]}_{treat_levels[[2]]}-filtered_windows.rds&quot;)
  ),
  up_regions = file.path(
    out_path, glue(&quot;{target}_{treat_levels[[1]]}_{treat_levels[[2]]}-up.bed&quot;)
  ),
  down_regions = file.path(
    out_path, glue(&quot;{target}_{treat_levels[[1]]}_{treat_levels[[2]]}-down.bed&quot;)
  ),
  de_genes = file.path(
    out_path, glue(&quot;{target}_{treat_levels[1]}_{treat_levels[2]}-DE_genes.csv&quot;)
  ),
  enrichment = file.path(
    out_path, glue(&quot;{target}_{treat_levels[1]}_{treat_levels[2]}-enrichment.csv&quot;)
  ),
  rna_enrichment = file.path(
    out_path, 
    glue(&quot;{target}_{treat_levels[1]}_{treat_levels[2]}-rnaseq_enrichment.csv&quot;)
  ),
  renv = here::here(
    &quot;output/envs&quot;,
    glue(
      &quot;{target}_{treat_levels[[1]]}_{treat_levels[[2]]}-differential_binding.RData&quot;
    )
  )
)
## Initialise outputs from RNA-Seq
cmn_diff &lt;- cmn_up &lt;- cmn_down &lt;- tibble(leadingEdge = list())</code></pre>
<div id="outline" class="section level1">
<h1>Outline</h1>
<div id="differential-binding" class="section level2">
<h2>Differential Binding</h2>
<p>This step of the workflow uses a sliding window approach to
differential binding, as a logical extension to the methods suggested
and implemented in the <code>csaw</code> package <span
class="citation">(<a href="#ref-LunSmythF1000" role="doc-biblioref">A.
T. Lun and Smyth 2015</a>)</span>.</p>
<ol style="list-style-type: decimal">
<li>Consensus Peaks derived from <code>macs2 callpeak</code> <span
class="citation">(<a href="#ref-Zhang18798982"
role="doc-biblioref">Zhang et al. 2008</a>)</span> results are used to
determine inclusion/exclusion values for sliding windows</li>
<li>Smooth Quantile Normalisation <span class="citation">(<a
href="#ref-HicksSQN2017" role="doc-biblioref">Stephanie C. Hicks et al.
2017</a>)</span> is used on the set of logCPM values obtained from
retained sliding windows. This was chosen given that many transcription
factors can show vastly different cytoplasmic/nuclear distributions
across treatments</li>
<li>The <em>limma-trend</em> method <span class="citation">(<a
href="#ref-LawVoom2014" role="doc-biblioref">Law et al. 2014</a>)</span>
is used alongside <code>treat</code> <span class="citation">(<a
href="#ref-McCarthyTreat2009" role="doc-biblioref">McCarthy and Smyth
2009</a>)</span> for detection of differential binding. This should
correctly control the FDR, and allows the specification as a percentage
of a suitable threshold for the estimated change in binding, below which
we are not interested in any changed signal</li>
<li>Independent Hypothesis Weighting (IHW) <span class="citation">(<a
href="#ref-IgnatiadisIHW2016" role="doc-biblioref">Ignatiadis et al.
2016</a>)</span> is additionally used to improve the power of the
results. Under this strategy, p-values are partitioned based on the
presence/absence of any other ChIP targets under consideration in any
condition, which is considered here to be a statistically independent
variable.</li>
</ol>
<p>The workflow also depends heavily on the function implemented in the
Bioconductor package <a
href="https://bioconductor.org/packages/release/bioc/html/extraChIPs.html">extraChIPs</a></p>
</div>
<div id="enrichment-analysis" class="section level2">
<h2>Enrichment Analysis</h2>
<p>Beyond the simple analysis of differential binding, peaks are mapped
to genes and enrichment testing is performed on the following:</p>
<ol style="list-style-type: decimal">
<li>Genes mapped to any window with detected H3K27ac are compared to all
genes not mapped to any window</li>
<li>Genes mapped to <em>all differentially bound windows</em> are
compared to genes mapped to windows which are not differentially
bound</li>
<li>Genes mapped to windows with <em>increasing</em> H3K27ac binding are
compared to genes mapped to windows which are not differentially
bound</li>
<li>Genes mapped to windows with <em>decreasing</em> H3K27ac binding are
compared to genes mapped to windows which are not differentially
bound</li>
</ol>
<p>Enrichment testing is performed using <code>goseq</code> <span
class="citation">(<a href="#ref-YoungGoseq2010"
role="doc-biblioref">Young et al. 2010</a>)</span> with <em>no term
accounting for sampling bias</em>, except when comparing genes mapped to
any window. For this case <strong>only</strong>, gene width is used to
capture any sampling bias and Wallenius’ Non-Central Hypergeometric
Distribution is used. As RNA-seq data was provided, the genes considered
for enrichment analysis are the 12,990 genes considered as detected in
the RNA-Seq data.</p>
</div>
<div id="incorporation-with-rna-seq" class="section level2">
<h2>Incorporation with RNA-Seq</h2>
<p>Any association between differentially expressed genes and
differentially bound sites will be assessed using Gene Set Enrichment
Analysis <span class="citation">(<a href="#ref-SubramanianGsea2005"
role="doc-biblioref">Subramanian et al. 2005</a>)</span>, as implemented
in the fgsea package <span class="citation">(<a
href="#ref-KorotkevichFgsea2019" role="doc-biblioref">Korotkevich,
Sukhov, and Sergushichev 2019</a>)</span>. The sets of genes associated
with changed binding will be subset by regions and any provided external
features, and these novel gene-sets will be used to test for enrichment
within the RNA-Seq results. ChIP-seq derived gene-sets will be tested
for differential expression using genes ranked directionally and by
significance alone.</p>
</div>
</div>
<div id="data-preparation" class="section level1">
<h1>Data Preparation</h1>
<pre class="r"><code>consensus_peaks &lt;- here::here(macs2_path, &quot;consensus_peaks.bed&quot;) %&gt;%
    import.bed(seqinfo = sq)</code></pre>
<pre class="r"><code>bfl &lt;- bam_path %&gt;%
  file.path(target, glue(&quot;{samples$sample}.bam&quot;)) %&gt;%
  c(
    file.path(bam_path, &quot;Input&quot;, glue(&quot;{unique(samples$input)}.bam&quot;))
  ) %&gt;% 
  BamFileList() %&gt;%
  setNames(c(samples$sample, unique(samples$input)))</code></pre>
<pre class="r"><code>ys &lt;- 1000
bfl_summary &lt;- bfl %&gt;%
    bplapply(
        function(x) {
            yieldSize(x) &lt;- ys
            sbp &lt;- ScanBamParam(what = c(&quot;qwidth&quot;, &quot;mapq&quot;))
            open(x)
            vals &lt;- scanBam(x, param = sbp)[[1]]
            close(x)
            list(as_tibble(vals))
        }
    ) %&gt;% 
    as_tibble() %&gt;%
    pivot_longer(everything(), names_to = &quot;sample&quot;) %&gt;%
    unnest(value) %&gt;% 
    pivot_longer(
        cols = c(&quot;qwidth&quot;, &quot;mapq&quot;),
        names_to = &quot;stat&quot;,
        values_to = &quot;value&quot;
    ) %&gt;%
    left_join(samples, by = &quot;sample&quot;) %&gt;% 
    mutate(
        across(
            all_of(c(&quot;target&quot;, &quot;label&quot;, &quot;treat&quot;)),
            str_replace_na, replacement = &quot;Input&quot;
        ),
        treat = factor(treat, levels = c(&quot;Input&quot;, treat_levels)),
        label = fct_inorder(label)
    ) %&gt;% 
    split(f = .$stat)
anyDups &lt;- bplapply(
    bfl,
    function(x) {
        sbp &lt;- ScanBamParam(
            flag = scanBamFlag(isDuplicate = TRUE),
            which = GRanges(sq)[which.min(seqlengths(sq))],
            what = &quot;qname&quot;
            )
        length(scanBam(x, param = sbp)[[1]]$qname)  &gt; 0
    }
) %&gt;%
  unlist()
anyPE &lt;- bplapply(
    bfl,
    function(x){
        yieldSize(x) &lt;- ys
        open(x)
        flag &lt;- scanBam(x, param=ScanBamParam(what=&quot;flag&quot;))[[1]]$flag
        close(x)
        any(bamFlagTest(flag, &quot;isPaired&quot;))
    }
) %&gt;% 
  unlist()</code></pre>
<p>Taking the first 1,000 alignments, a brief inspection of the Bam
Files revealed:</p>
<ul>
<li>Aligned read lengths ranged between 50 and 76. The median length was
76.</li>
<li>MAPQ scores of aligned reads ranged between 2 and 42. The median
score was 30.</li>
<li>All bam files have been de-duplicated</li>
<li>All alignments were single-end</li>
</ul>
<div id="sliding-window-counts" class="section level2">
<h2>Sliding Window Counts</h2>
<pre class="r"><code>greylist &lt;- file.path(
  annotation_path, glue(&quot;{unique(samples$input)}_greylist.bed&quot;)
  ) %&gt;%
  lapply(import.bed, seqinfo = sq) %&gt;%
  GRangesList() %&gt;%
  unlist() %&gt;%
  reduce()</code></pre>
<p>Prior to this workflow, high-signal regions were detected in any
input samples associated with H3K27ac libraries and grey-lists formed.
For these samples, this constituted 3,985 regions with total width of
82,913kb. Regions assigned to the greylist were added to the blacklisted
regions and excluded from all analyses.</p>
<pre class="r"><code>macs2_merged_logs &lt;- file.path(
  macs2_path, glue(&quot;{treat_levels}_merged_callpeak.log&quot;)
    ) %&gt;%
    importNgsLogs()
fl &lt;- max(macs2_merged_logs$fragment_length)
rp &lt;- readParam(
  pe = ifelse(any(anyPE), &quot;both&quot;, &quot;none&quot;),
  dedup = any(anyDups),
  restrict = seqnames(sq),
  discard = c(granges(blacklist), greylist)
)
win_step &lt;- 10*(1 + fl %/% 60)
win_size &lt;- 3*win_step
window_counts &lt;- windowCounts(
  bam.files = bfl,
  spacing = win_step,
  width = win_size,
  ext = fl,
  filter = length(bfl) - 1,
  param = rp,
  BPPARAM = bpparam()
)
colData(window_counts) &lt;- colData(window_counts) %&gt;% 
  as_tibble(rownames = &quot;sample&quot;) %&gt;% 
  dplyr::select(all_of(c(&quot;sample&quot;, &quot;bam.files&quot;, &quot;totals&quot;, &quot;ext&quot;, &quot;rlen&quot;))) %&gt;% 
  left_join(samples, by = &quot;sample&quot;) %&gt;% 
  mutate(
    treat = fct_explicit_na(treat, &quot;Input&quot;), 
    target = str_replace_na(target, &quot;Input&quot;)
  ) %&gt;% 
  as.data.frame() %&gt;% 
  column_to_rownames(&quot;sample&quot;) %&gt;% 
  DataFrame()
window_counts &lt;- sortSeqlevels(window_counts)
seqinfo(window_counts) &lt;- sq</code></pre>
<p>Using the macs2-estimated fragment length of 230nt, a set of genomic
sliding windows were defined using a window size of 120bp, sliding in
increments of 40bp. With the exclusion of black-listed and grey-listed
regions, all alignments within each window were counted for each
H3K27ac-associated sample, and all relevant input samples. Any windows
with fewer than 6 alignments (i.e.1 read/sample) across all samples were
discarded, leaving a total of 34,610,621 sliding windows, covering 52%
of the reference genome.</p>
<p>These windows were then filtered using the <code>dualFilter()</code>
function from <code>extraChIPs</code>, discarding windows with low
counts. Under this approach, two thresholds are determined above which
windows are retained, and with values chosen to return 60% of sliding
windows which overlap a macs2-derived consensus peak. These values are
set to filter based on 1) signal relative to input over an extended
range and, 2) overall signal level. Both filtering strategies rely on
the infrastructure provided by <code>csaw</code> <span
class="citation">(<a href="#ref-LunSmythCsaw2014"
role="doc-biblioref">A. T. L. Lun and Smyth 2014</a>)</span>.</p>
<pre class="r"><code>filtered_counts &lt;- dualFilter(
  x = window_counts[, samples$sample],
  bg = window_counts[, samples$input],
  ref = consensus_peaks,
  keep.totals = TRUE,
  q = config$comparisons$filter_q
)
colData(filtered_counts) &lt;- droplevels(colData(filtered_counts))
n_max &lt;- min(5e4, nrow(filtered_counts))
sample_labeller &lt;- as_labeller(
  setNames(colData(filtered_counts)$label, colnames(filtered_counts))
)</code></pre>
<pre class="r"><code>list(
  `Genomic Windows` = window_counts,
  `Retained Windows` = filtered_counts,
  `Consensus Peaks` = consensus_peaks
) %&gt;% 
  lapply(granges) %&gt;% 
  lapply(
    function(x) {
      tibble(
        N = comma(length(x)),
        `Total Width (kb)` = comma(sum(width(reduce(x))) / 1e3),
        `Median Width (bp)` = median(width(x))
      )
    }
  ) %&gt;% 
  lapply(list) %&gt;% 
  as_tibble() %&gt;% 
  pivot_longer(everything(), names_to = &quot;Dataset&quot;) %&gt;% 
  unnest(everything()) %&gt;% 
  left_join(
    tibble(
      Dataset = c(&quot;Retained Windows&quot;, &quot;Consensus Peaks&quot;),
      `Unique (kb)` = c(
        round(sum(width(setdiff(granges(filtered_counts), consensus_peaks))) / 1e3, 1),
        round(sum(width(setdiff(consensus_peaks, granges(filtered_counts)))) / 1e3, 1)
      ),
      `% Unique` = percent(
        1e3*`Unique (kb)` / c(
          sum(width(reduce(granges(filtered_counts)))),
          sum(width(consensus_peaks))
        ),
        0.1
      )
    )
  ) %&gt;% 
  pander(
    justify = &quot;lrrrrr&quot;,
    caption = paste(
      &quot;A dual filtering strategy was used based on retaining&quot;, 
      percent(config$comparisons$filter_q, 0.1), 
      &quot;of genomic windows overlapping the consensus peaks identified by &quot;, 
      &quot;`macs2 callpeak` on merged samples. This approach combined both &quot;, 
      &quot;1) expression percentiles, and 2) signal strength in relation to the input sample.&quot;,
      &quot;The complete set of sliding windows covered the majority of the genome,&quot;,
      &quot;whilst those retained after filtering were focussed on strong binding&quot;,
      &quot;signal. Consensus peaks were as identified by `macs2 callpeak` in a&quot;, 
      &quot;previous step of the workflow.&quot;,
      &quot;Importantly, consensus peaks are non-overlapping, whilst the other two&quot;,
      &quot;datasets are derived from overlapping sliding windows.&quot;,
      &quot;This strategy of filtering the set of initial sliding windows retained&quot;,
      percent(
        1 - sum(width(setdiff(consensus_peaks, rowRanges(filtered_counts)))) / sum(width(consensus_peaks))
      ), 
      &quot;of the genomic regions covered by consensus peaks, with&quot;, 
      percent(
        sum(width(setdiff(rowRanges(filtered_counts), consensus_peaks))) / sum(width(reduce(granges(filtered_counts)))))
      , 
      &quot;of the retained windows being outside genomic regions covered by consensus peaks.&quot;,
      ifelse(
        n_max == 5e4, 
        &quot;For subsequent density and RLE plots, a subsample of 50,000 genomic regions will be used for speed.&quot;, 
        &quot;&quot;
      )
    )
  )</code></pre>
<table>
<caption>A dual filtering strategy was used based on retaining 60.0% of
genomic windows overlapping the consensus peaks identified by
<code>macs2 callpeak</code> on merged samples. This approach combined
both 1) expression percentiles, and 2) signal strength in relation to
the input sample. The complete set of sliding windows covered the
majority of the genome, whilst those retained after filtering were
focussed on strong binding signal. Consensus peaks were as identified by
<code>macs2 callpeak</code> in a previous step of the workflow.
Importantly, consensus peaks are non-overlapping, whilst the other two
datasets are derived from overlapping sliding windows. This strategy of
filtering the set of initial sliding windows retained 79% of the genomic
regions covered by consensus peaks, with 1% of the retained windows
being outside genomic regions covered by consensus peaks. For subsequent
density and RLE plots, a subsample of 50,000 genomic regions will be
used for speed.</caption>
<colgroup>
<col width="19%" />
<col width="13%" />
<col width="19%" />
<col width="20%" />
<col width="14%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Dataset</th>
<th align="right">N</th>
<th align="right">Total Width (kb)</th>
<th align="right">Median Width (bp)</th>
<th align="right">Unique (kb)</th>
<th align="right">% Unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Genomic Windows</td>
<td align="right">34,610,621</td>
<td align="right">1,605,126</td>
<td align="right">120</td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">Retained Windows</td>
<td align="right">1,407,130</td>
<td align="right">60,081</td>
<td align="right">120</td>
<td align="right">666.6</td>
<td align="right">1.1%</td>
</tr>
<tr class="odd">
<td align="left">Consensus Peaks</td>
<td align="right">49,998</td>
<td align="right">75,059</td>
<td align="right">957</td>
<td align="right">15,644</td>
<td align="right">20.8%</td>
</tr>
</tbody>
</table>
</div>
<div id="normalisation" class="section level2">
<h2>Normalisation</h2>
<pre class="r"><code>library(quantro)
library(qsmooth)</code></pre>
<p>The <code>quantro</code> test was first applied <span
class="citation">(<a href="#ref-HicksQuantro2015"
role="doc-biblioref">S. C. Hicks and Irizarry 2015</a>)</span> to
determine if treatment-specific binding distributions were found in the
data. Whilst this may not always be the case, the robustness of
smooth-quantile normalisation (SQN) <span class="citation">(<a
href="#ref-HicksSQN2017" role="doc-biblioref">Stephanie C. Hicks et al.
2017</a>)</span> will be applicable if data is drawn from different or
near-identical distributions, and this method was applied grouping data
by treatment.</p>
<pre class="r"><code>qtest &lt;- quantro(
  assay(filtered_counts, &quot;logCPM&quot;),
  groupFactor = filtered_counts$treat
)
pander(
  anova(qtest), 
  caption = paste(
    &quot;*Results from qtest suggesting that the two treatment groups are drawn from&quot;,
    ifelse(
      qtest@anova$`Pr(&gt;F)`[[1]] &lt; 0.05,
      &quot;different distributions.*&quot;,
      &quot;the same distribution.*&quot;
    )
  )
)</code></pre>
<table style="width:93%;">
<caption><em>Results from qtest suggesting that the two treatment groups
are drawn from the same distribution.</em></caption>
<colgroup>
<col width="25%" />
<col width="6%" />
<col width="16%" />
<col width="16%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>groupFactor</strong></td>
<td align="center">1</td>
<td align="center">0.0009618</td>
<td align="center">0.0009618</td>
<td align="center">1.697</td>
<td align="center">0.2626</td>
</tr>
<tr class="even">
<td align="center"><strong>Residuals</strong></td>
<td align="center">4</td>
<td align="center">0.002267</td>
<td align="center">0.0005668</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<pre class="r"><code>qs &lt;-qsmooth(
  assay(filtered_counts, &quot;logCPM&quot;), group_factor = filtered_counts$treat
)
assay(filtered_counts, &quot;qsmooth&quot;) &lt;- qsmoothData(qs)</code></pre>
</div>
<div id="data-inspection" class="section level2 tabset">
<h2 class="tabset">Data Inspection</h2>
<div id="qsmooth-weights" class="section level3">
<h3>QSmooth Weights</h3>
<pre class="r"><code>qsmoothPlotWeights(qs, xLab = &quot;Quantiles&quot;, yLab = &quot;Weights&quot;, mainLab = &quot;QSmooth Weights&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-qs-weights-1.png" alt="*Quantile-specific weights used by the Smooth-Quantile normalisation. Low weights indicate signal quantiles which appear to be more specific within a group, whilst higher weights indicate similarity between groups.*" width="960" />
<p class="caption">
<em>Quantile-specific weights used by the Smooth-Quantile normalisation.
Low weights indicate signal quantiles which appear to be more specific
within a group, whilst higher weights indicate similarity between
groups.</em>
</p>
</div>
</div>
<div id="density-plot-all-sliding-windows" class="section level3">
<h3>Density Plot: All Sliding Windows</h3>
<pre class="r"><code>plotAssayDensities(
  window_counts, trans = &quot;log1p&quot;, n_max = n_max, colour = &quot;treat&quot;,
  linetype = &quot;target&quot;
) +
  scale_colour_manual(values = colours$treat) + 
  labs(
    x = &quot;log(counts + 1)&quot;, y = &quot;Density&quot;, colour = &quot;Treat&quot;, linetype = &quot;Target&quot;
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-density-windows-1.png" alt="*Density plot for __all windows prior to the selection of windows__ more likely to contain true signal. Retained windows will be those at the upper end, whilst discarded windows will be at the lower end.*" width="768" />
<p class="caption">
<em>Density plot for <strong>all windows prior to the selection of
windows</strong> more likely to contain true signal. Retained windows
will be those at the upper end, whilst discarded windows will be at the
lower end.</em>
</p>
</div>
</div>
<div id="logcpm-densities" class="section level3">
<h3>logCPM Densities</h3>
<pre class="r"><code>a &lt;- filtered_counts %&gt;% 
  plotAssayDensities(&quot;logCPM&quot;, colour = &quot;treat&quot;, n_max = n_max) +
  scale_colour_manual(values = treat_colours) +
  labs(colour = &quot;Treat&quot;)
b &lt;- filtered_counts %&gt;% 
  plotAssayDensities(&quot;qsmooth&quot;, colour = &quot;treat&quot;, n_max = n_max) +
  scale_colour_manual(values = treat_colours) +
  labs(
    x = &quot;Normalised logCPM&quot;, colour = &quot;Treat&quot;
  )
plot_grid(
  a + theme(legend.position = &quot;none&quot;), 
  b + theme(legend.position = &quot;none&quot;),
  get_legend(b),
  nrow = 1,
  rel_widths = c(5, 5, 1),
  labels = c(&quot;A&quot;, &quot;B&quot;)
)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-logcpm-densities-1.png" alt="*logCPM distributions for all retained windows A) prior to smooth quantile normalisation, and 2) after SQ normalisation.*" width="960" />
<p class="caption">
<em>logCPM distributions for all retained windows A) prior to smooth
quantile normalisation, and 2) after SQ normalisation.</em>
</p>
</div>
</div>
<div id="rle-pre-normalisation" class="section level3">
<h3>RLE (Pre-Normalisation)</h3>
<pre class="r"><code>filtered_counts %&gt;% 
  plotAssayRle(
  &quot;logCPM&quot;, fill = &quot;treat&quot;, rle_group = &quot;treat&quot;, n_max = n_max
) +
  geom_hline(yintercept = 0) + 
  facet_grid(.~treat, scales = &quot;free_x&quot;, space = &quot;free_x&quot;) +
  scale_x_discrete(labels = sample_labeller) +
  scale_fill_manual(values = treat_colours) +
  labs(x = &quot;Sample&quot;, fill = &quot;Treat&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-rle-1.png" alt="*RLE plot showing logCPM values. RLE values were calculated within each treatment group to account for the potentially different binding dynamics of H3K27ac.*" width="960" />
<p class="caption">
<em>RLE plot showing logCPM values. RLE values were calculated within
each treatment group to account for the potentially different binding
dynamics of H3K27ac.</em>
</p>
</div>
</div>
<div id="rle-post-normalisation" class="section level3">
<h3>RLE (Post-Normalisation)</h3>
<pre class="r"><code>filtered_counts %&gt;% 
  plotAssayRle(
  &quot;qsmooth&quot;, fill = &quot;treat&quot;, rle_group = &quot;treat&quot;, n_max = n_max
) +
  geom_hline(yintercept = 0) + 
  facet_grid(.~treat, scales = &quot;free_x&quot;, space = &quot;free_x&quot;) +
  scale_x_discrete(labels = sample_labeller) +
  scale_fill_manual(values = treat_colours) +
  labs(x = &quot;Sample&quot;, fill = &quot;Treat&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-rle-normalised-1.png" alt="*RLE plot showing normalised logCPM. RLE values were calculated within each treatment group to account for the potentially different binding dynamics of H3K27ac.*" width="960" />
<p class="caption">
<em>RLE plot showing normalised logCPM. RLE values were calculated
within each treatment group to account for the potentially different
binding dynamics of H3K27ac.</em>
</p>
</div>
</div>
<div id="pca" class="section level3">
<h3>PCA</h3>
<pre class="r"><code>a &lt;- plotAssayPCA(filtered_counts, &quot;logCPM&quot;, colour = &quot;treat&quot;, label = &quot;label&quot;) +
  scale_colour_manual(values = treat_colours) +
  ggtitle(&quot;Pre-Normalisation&quot;)
b &lt;- plotAssayPCA(filtered_counts, &quot;qsmooth&quot;, colour = &quot;treat&quot;, label = &quot;label&quot;) +
  scale_colour_manual(values = treat_colours) +
  ggtitle(&quot;Post-Normalisation&quot;)
plot_grid(
  a + theme(legend.position = &quot;none&quot;), b + theme(legend.position = &quot;none&quot;), 
  get_legend(b + labs(colour = &quot;Treat&quot;)), rel_widths = c(1, 1, 0.2), 
  nrow = 1, labels = c(&quot;A&quot;, &quot;B&quot;)
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-pca-1.png" alt="*PCA plots for logCPM values A) before and B) after Smooth Quantile normalisation*" width="960" />
<p class="caption">
<em>PCA plots for logCPM values A) before and B) after Smooth Quantile
normalisation</em>
</p>
</div>
</div>
</div>
</div>
<div id="differential-binding-analysis" class="section level1">
<h1>Differential Binding Analysis</h1>
<div id="primary-analysis" class="section level2 tabset">
<h2 class="tabset">Primary Analysis</h2>
<pre class="r"><code>X &lt;- model.matrix(~treat, data = colData(filtered_counts)) %&gt;%
  set_colnames(str_remove(colnames(.), &quot;treat&quot;))
colData(filtered_counts)$design &lt;- X
paired_cors &lt;- block &lt;- txt &lt;- NULL
if (config$comparisons$paired) {
  block &lt;- colData(filtered_counts)[[rep_col]]
  set.seed(1e6)
  ind &lt;- sample.int(nrow(filtered_counts), n_max, replace = FALSE)
  paired_cors &lt;- duplicateCorrelation(
    object = assay(filtered_counts, &quot;qsmooth&quot;)[ind, ],
    design = X,
    block = block
  )$consensus.correlation
  txt &lt;- glue(
    &quot;Data were nested within {{rep_col}} as a potential source of correlation. &quot;,
    &quot;The estimated correlation within replicate samples was $\\hat{\\rho} = {{round(paired_cors, 3)}}$&quot;,
    .open = &quot;{{&quot;, .close = &quot;}}&quot;
  )
}
fc &lt;- ifelse(is.null(config$comparisons$fc), 1, config$comparisons$fc)
fit &lt;- assay(filtered_counts, &quot;qsmooth&quot;) %&gt;%
  lmFit(design = X, block = block, correlation = paired_cors) %&gt;% 
  treat(fc = fc, trend = TRUE, robust = FALSE)
fit_mu0 &lt;- assay(filtered_counts, &quot;qsmooth&quot;) %&gt;%
  lmFit(design = X, block = block, correlation = paired_cors) %&gt;% 
  treat(fc = 1, trend = TRUE, robust = FALSE)
res_cols &lt;- c(&quot;logFC&quot;, &quot;AveExpr&quot;, &quot;t&quot;, &quot;P.Value&quot;, &quot;fdr&quot;)
rowData(filtered_counts) &lt;- rowData(filtered_counts) %&gt;% 
  .[!colnames(.) %in% c(res_cols, &quot;p_mu0&quot;)] %&gt;% 
  cbind(
    fit %&gt;% 
      topTable(sort.by = &quot;none&quot;, number = Inf) %&gt;% 
      as.list %&gt;% 
      setNames(res_cols) %&gt;% 
      c(
        list(
          p_mu0 = topTable(fit_mu0, sort.by = &quot;none&quot;, number = Inf)$P.Value
        )
      )
  ) </code></pre>
<p>After SQ-normalisation of logCPM values, the <code>limma-trend</code>
method <span class="citation">(<a href="#ref-LawVoom2014"
role="doc-biblioref">Law et al. 2014</a>)</span> was applied to all
retained windows. A simple linear model was fitted taking E2 as the
baseline and estimating the effects of E2DHT on H3K27ac binding within
each sliding window, incorporating a trended prior-variance.</p>
<p>After model fitting, hypothesis testing was performed testing:</p>
<p><span class="math display">\[
H_0: -\lambda &lt; \mu &lt; \lambda
\]</span> against <span class="math display">\[
H_A: |\mu| &gt; \lambda
\]</span> where <span class="math inline">\(\mu\)</span> represents the
true mean change in H3K27ac binding. The value <span
class="math inline">\(\lambda =\)</span> 0.26 was chosen as this
corresponds to a 20% change in detected signal on the log<sub>2</sub>
scale. This is known as the <code>treat</code> method <span
class="citation">(<a href="#ref-McCarthyTreat2009"
role="doc-biblioref">McCarthy and Smyth 2009</a>)</span>, and p-values
were obtained for each initial window, before merging adjoining
windows.</p>
<p>For subsequent classification when combining across multiple
differential binding results, an additional p-value testing <span
class="math inline">\(\mu = 0\)</span> was added, however this is not
used for detection of sites showing evidence of altered H3K27ac
binding.</p>
<pre class="r"><code>merged_results &lt;- mergeByCol(
  filtered_counts, col = &quot;AveExpr&quot;, merge_within = 2 * win_step,
  inc_cols = &quot;p_mu0&quot;
) %&gt;% 
  mutate(
    overlaps_ref = overlapsAny(., consensus_peaks),
    direction = case_when(
      n_up == 0 &amp; n_down == 0 ~ &quot;Unchanged&quot;,
      logFC &gt; 0 &amp; n_up &gt; n_down ~ &quot;Up&quot;,
      logFC &lt; 0 &amp; n_up &lt; n_down ~ &quot;Down&quot;,
      TRUE ~ &quot;Ambiguous&quot;
    ) %&gt;% 
      factor(levels = c(&quot;Up&quot;, &quot;Down&quot;, &quot;Ambiguous&quot;, &quot;Unchanged&quot;)) %&gt;% 
      droplevels()
  ) </code></pre>
<p>After selection of the 1,407,130 sliding windows (120bp), these were
merged into 41,089 genomic regions with size ranging from 120 to
35560bp, with the median width being 1000bp. Representative estimates of
differential binding (i.e. logFC) were taken from the sliding window
with the <em>highest average signal</em> across all samples, within each
set of windows to be merged. Similarly, p-values from the above tests
were also selected from the same sliding window as representative of the
merged region <span class="citation">(<a href="#ref-LunSmythF1000"
role="doc-biblioref">A. T. Lun and Smyth 2015</a>)</span>. The number of
windows showing increased or decreased binding within each merged region
were also included, by counting those within each set of windows with
p-values lower than the selected window. FDR-adjustment was performed
with 225 regions (0.5%) showing significance, based on an FDR-adjusted
p-value alone.</p>
</div>
<div id="independent-hypothesis-weighting"
class="section level2 tabset">
<h2 class="tabset">Independent Hypothesis Weighting</h2>
<pre class="r"><code>fdr_column &lt;- str_subset(names(mcols(merged_results)), &quot;fdr|FDR&quot;)
## Add status (direction) for the ihw = &quot;none&quot; possibility
merged_results &lt;- merged_results %&gt;% 
  mutate(
    status = case_when(
      !!sym(fdr_column) &lt; fdr_alpha ~ as.character(direction),
      !!sym(fdr_column) &gt;= fdr_alpha ~ &quot;Unchanged&quot;
    ) %&gt;% 
      factor(levels = c(levels(direction), &quot;Unchanged&quot;)) %&gt;% 
      droplevels()
  )</code></pre>
<pre class="r"><code>other_targets &lt;- here::here(config$samples$file) %&gt;% 
  read_tsv() %&gt;% 
  pull(&quot;target&quot;) %&gt;% 
  unique() %&gt;% 
  setdiff(target)
ihw_all &lt;- other_targets %&gt;% 
  sapply(
    function(x) {
      here::here(dirname(macs2_path), x, &quot;consensus_peaks.bed&quot;) %&gt;%
        import.bed(seqinfo = sq)
    },
    simplify = FALSE
  ) %&gt;% 
  lapply(granges) %&gt;% 
  lapply(
    function(x) overlapsAny(merged_results, x)
  ) %&gt;% 
  as_tibble() %&gt;% 
  mutate(
    range = as.character(merged_results), id = seq_along(range)
  ) %&gt;% 
  pivot_longer(
    cols = all_of(other_targets),
    names_to = &quot;targets&quot;, 
    values_to = &quot;overlap&quot;
  ) %&gt;% 
  group_by(id, range) %&gt;% 
  summarise(
    targets = ifelse(
      any(overlap), 
      paste(sort(targets[overlap]), collapse = &quot;+ &quot;),
      &quot;No Other Targets&quot;
    ),
    .groups = &quot;drop&quot;
  ) %&gt;% 
  arrange(id) %&gt;% 
  mutate(targets = fct_infreq(targets)) %&gt;% 
  .[[&quot;targets&quot;]]
n_levels &lt;- sum(table(ihw_all) &gt; 1e3) - 1
merged_results$ihw_covariate &lt;- fct_lump_n(ihw_all, n = n_levels)
ihw_proceed &lt;- length(levels(merged_results$ihw_covariate)) &gt; 1
if (ihw_proceed)  fdr_column &lt;- &quot;fdr_ihw&quot;
if (ihw_proceed) {
  ihw &lt;- ihw(
    pvalues = merged_results$P.Value,
    covariates = merged_results$ihw_covariate,
    alpha &lt;- fdr_alpha,
    covariate_type = &quot;nominal&quot;
  )
  merged_results &lt;- mutate(merged_results, fdr_ihw = adj_pvalues(ihw))
} 
merged_results &lt;- merged_results %&gt;% 
  mutate(
    status = case_when(
      !!sym(fdr_column) &lt; fdr_alpha ~ as.character(direction),
      !!sym(fdr_column) &gt;= fdr_alpha ~ &quot;Unchanged&quot;
    ) %&gt;% 
      factor(levels = c(levels(direction), &quot;Unchanged&quot;)) %&gt;% 
      droplevels()
  )</code></pre>
<p>Independent Hypothesis Weighting (IHW) <span class="citation">(<a
href="#ref-IgnatiadisIHW2016" role="doc-biblioref">Ignatiadis et al.
2016</a>)</span> was then used to partition the raw p-values for H3K27ac
differential binding by the detection of the other ChIP targets under
investigation in this workflow (AR and ER). The presence of AR and ER
was defined simply using the consensus peaks detected under any
treatment by <code>macs2 callpeak</code>, as determined <a
href="H3K27ac_macs2_summary.html">previously</a>. This allows
recalculation of the FDR using <em>weighted p-values</em> instead of
<em>raw p-values</em>. In order for IHW to be a viable strategy,
partitions should be greater than 1000. The provided consensus peaks
were used as initial partitions in combination, merging the smallest
groups below this size until all partitions were of a suitable size.</p>
<p>Windows were classified as overlapping a peak from a secondary ChIP
target if <em>any</em> section of the window overlapped the secondary
peak.</p>
<div id="summary-table" class="section level3">
<h3>Summary Table</h3>
<pre class="r"><code>ihw %&gt;%
  as.data.frame() %&gt;% 
  mutate(
    fdr = p.adjust(pvalue, &quot;fdr&quot;),
    status = case_when(
      fdr &lt; fdr_alpha &amp; adj_pvalue &gt; fdr_alpha ~ &quot;Lost&quot;,
      fdr &lt; fdr_alpha &amp; adj_pvalue &lt; fdr_alpha ~ &quot;Retained&quot;,
      fdr &gt; fdr_alpha &amp; adj_pvalue &lt; fdr_alpha ~ &quot;Gained&quot;,
      fdr &gt; fdr_alpha &amp; adj_pvalue &gt; fdr_alpha ~ &quot;Never Significant&quot;
    ) %&gt;% 
      factor(
        levels = c(&quot;Never Significant&quot;, &quot;Retained&quot;, &quot;Gained&quot;, &quot;Lost&quot;)
      )
  ) %&gt;% 
  as_tibble() %&gt;% 
  group_by(covariate, status) %&gt;% 
  tally() %&gt;% 
  ungroup() %&gt;% 
  complete(status = status, covariate = covariate, fill = list(n = 0)) %&gt;% 
  pivot_wider(
    names_from = status, values_from = n, values_fill = 0
  ) %&gt;% 
  mutate(
    `Nett Change` = Gained - Lost
  ) %&gt;% 
  bind_rows(
    summarise_if(., is.numeric, sum)
  ) %&gt;% 
  mutate(
    covariate = str_replace_na(covariate, &quot;Total&quot;),
    Significant = Retained + Gained
  ) %&gt;% 
  dplyr::select(
    Covariate = covariate, ends_with(&quot;Significant&quot;), Retained, everything()
  ) %&gt;% 
  pander(
    justify = &quot;lrrrrrr&quot;,
    caption = paste(
      &quot;*Summary of changes introduced by IHW for windows considered as being&quot;, 
      paste0(&quot;differentially bound by &quot;, target, &quot;.&quot;),
      &quot;This corresponds to a __nett change of&quot;, 
        dplyr::slice(., nrow(.)) %&gt;% 
        mutate(p = `Nett Change` / (Significant - `Nett Change`)) %&gt;% 
        .[[&quot;p&quot;]] %&gt;% 
        percent(0.1),
      &quot;from the initial list__.*&quot;
    ),
    emphasize.strong.rows = nrow(.)
  )</code></pre>
<table>
<caption><em>Summary of changes introduced by IHW for windows considered
as being differentially bound by H3K27ac. This corresponds to a
<strong>nett change of 49.8% from the initial
list</strong>.</em></caption>
<colgroup>
<col width="19%" />
<col width="20%" />
<col width="14%" />
<col width="11%" />
<col width="10%" />
<col width="9%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Covariate</th>
<th align="right">Never Significant</th>
<th align="right">Significant</th>
<th align="right">Retained</th>
<th align="right">Gained</th>
<th align="right">Lost</th>
<th align="right">Nett Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">No Other Targets</td>
<td align="right">32,993</td>
<td align="right">23</td>
<td align="right">23</td>
<td align="right">0</td>
<td align="right">18</td>
<td align="right">-18</td>
</tr>
<tr class="even">
<td align="left">AR</td>
<td align="right">3,479</td>
<td align="right">219</td>
<td align="right">120</td>
<td align="right">99</td>
<td align="right">0</td>
<td align="right">99</td>
</tr>
<tr class="odd">
<td align="left">ER</td>
<td align="right">2,349</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">Other</td>
<td align="right">1,912</td>
<td align="right">94</td>
<td align="right">62</td>
<td align="right">32</td>
<td align="right">0</td>
<td align="right">32</td>
</tr>
<tr class="odd">
<td align="left"><strong>Total</strong></td>
<td align="right"><strong>40,733</strong></td>
<td align="right"><strong>337</strong></td>
<td align="right"><strong>206</strong></td>
<td align="right"><strong>131</strong></td>
<td align="right"><strong>19</strong></td>
<td align="right"><strong>112</strong></td>
</tr>
</tbody>
</table>
</div>
<div id="initial-group-sizes" class="section level3">
<h3>Initial Group Sizes</h3>
<pre class="r"><code>tibble(ihw = ihw_all) %&gt;% 
  ggplot(
    aes(ihw, fill = ihw)
  ) +
  geom_bar() +
  geom_hline(yintercept = 1e3, colour = &quot;blue&quot;) +
  geom_text(
    aes(y = n + 0.025*max(n), label = comma(n, 1)),
    data = . %&gt;%
      group_by(ihw) %&gt;%
      summarise(n = dplyr::n(), .groups = &quot;drop&quot;) 
  ) +
  scale_y_continuous(expand = expansion(c(0, 0.05)), labels = comma) +
  labs(x = &quot;Peaks Overlapping Other ChIP Targets&quot;, y = &quot;Total&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/ihw-partitions-raw-1.png" alt="*Breakdown of all windows which overlapped peaks from additional ChIP targets. Any partitions with fewer than 1000 windows (indicated as the blue horizontal line) were combined into the next smallest partition consecutively, until all partitions contained &gt; 1000 windows.*" width="960" />
<p class="caption">
<em>Breakdown of all windows which overlapped peaks from additional ChIP
targets. Any partitions with fewer than 1000 windows (indicated as the
blue horizontal line) were combined into the next smallest partition
consecutively, until all partitions contained &gt; 1000 windows.</em>
</p>
</div>
</div>
<div id="p-value-distributions" class="section level3">
<h3>P-Value Distributions</h3>
<pre class="r"><code>y &lt;- ggplot_build(
  tibble(
    P.Value = merged_results$P.Value,
    ihw_covariate = merged_results$ihw_covariate
    ) %&gt;% 
    ggplot(aes(P.Value, stat(density))) + 
    geom_histogram(bins = 100) +
    facet_wrap(~ihw_covariate) 
) %&gt;% .[[&quot;data&quot;]] %&gt;% 
  .[[1]] %&gt;% 
  .[[&quot;y&quot;]] %&gt;% 
  max()
merged_results %&gt;% 
  select(P.Value, ihw_covariate) %&gt;% 
  mcols() %&gt;% 
  as_tibble() %&gt;% 
  ggplot(aes(P.Value, stat(density))) +
  geom_histogram(fill = &quot;grey&quot;, colour = &quot;black&quot;, bins = 100) +
  geom_text(
    aes(0.8, y, label = lab),
    data = . %&gt;% 
      group_by(ihw_covariate) %&gt;% 
      summarise(n = dplyr::n(), .groups = &quot;drop&quot;) %&gt;% 
      mutate(
        lab = glue(&quot;N = {comma(n, 1)}&quot;),
        y = y
      )
  ) +
  facet_wrap(~ihw_covariate) +
  scale_y_continuous(expand = expansion(c(0, 0.05))) +
  labs(x = &quot;P Value&quot;, y = &quot;Density&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-ihw-pvals-1.png" alt="*P-Value distributions within all final data partitions. The size of each partition is given within each panel.*" width="960" />
<p class="caption">
<em>P-Value distributions within all final data partitions. The size of
each partition is given within each panel.</em>
</p>
</div>
</div>
<div id="ihw-weights" class="section level3">
<h3>IHW Weights</h3>
<pre class="r"><code>plot(ihw) +
  geom_hline(yintercept = 1) +
  facet_wrap(~group) +
  scale_y_continuous(expand = expansion(c(0, 0.05))) +
  labs(x = &quot;Fold&quot;, y = &quot;Weight&quot;, fill = &quot;Fold&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-ihw-weights-1.png" alt="*Weights applied to p-values within each partition. 'Folds' represent random sub-partitions within each larger partition generated as part of the IHW process.*" width="960" />
<p class="caption">
<em>Weights applied to p-values within each partition. ‘Folds’ represent
random sub-partitions within each larger partition generated as part of
the IHW process.</em>
</p>
</div>
</div>
<div id="fdr-comparison" class="section level3">
<h3>FDR Comparison</h3>
<pre class="r"><code>ihw %&gt;%
  as.data.frame() %&gt;% 
  ggplot(
    aes(-log10(pvalue), -log10(weighted_pvalue), colour = fold)
  ) +
  geom_point(size = 0.4) +
  geom_hline(
    aes(yintercept = -log10(weighted_pvalue)),
    data = . %&gt;% 
      dplyr::select(-group) %&gt;% 
      dplyr::filter(adj_pvalue &lt; fdr_alpha) %&gt;% 
      dplyr::filter(weighted_pvalue == max(weighted_pvalue)),
    linetype = 2, colour = &quot;blue&quot;
  ) +
  geom_vline(
    aes(xintercept = -log10(pvalue)),
    data =. %&gt;% 
      dplyr::filter(p.adjust(pvalue, &quot;fdr&quot;) &lt; fdr_alpha) %&gt;% 
      dplyr::filter(pvalue == max(pvalue)) %&gt;% 
      dplyr::select(-group),
    linetype = 2, colour = &quot;blue&quot;
  ) +
  facet_wrap(~group, scales = &quot;free&quot;) +
  coord_cartesian(xlim = c(0, 5), ylim = c(0, 5)) +
  labs(
    x = expression(-log[10](p)),
    y = expression(-log[10](p[IHW])),
    colour = &quot;Fold&quot;
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-fdr-comparison-1.png" alt="*Comparison of raw and weighted p-values for each partition. Blue dashed lines indicate FDR = 0.05 for each set of p-values. Those in the lower-right quadrant would no longer be considered significant after IHW, whilst those in the upper-left quadrant would only be considered as significant after the IHW process. Those in the upper-right quadrant would be considered as significant regardless of the methodology.*" width="960" />
<p class="caption">
<em>Comparison of raw and weighted p-values for each partition. Blue
dashed lines indicate FDR = 0.05 for each set of p-values. Those in the
lower-right quadrant would no longer be considered significant after
IHW, whilst those in the upper-left quadrant would only be considered as
significant after the IHW process. Those in the upper-right quadrant
would be considered as significant regardless of the methodology.</em>
</p>
</div>
</div>
</div>
<div id="mapping-windows" class="section level2">
<h2>Mapping Windows</h2>
<pre class="r"><code>merged_results &lt;- merged_results %&gt;% 
  mutate(
    region = bestOverlap(
      ., 
      gene_regions %&gt;% 
        lapply(select, region) %&gt;% 
        GRangesList() %&gt;% 
        unlist(),
      var = &quot;region&quot;
    ) %&gt;% 
      factor(levels = regions)
  )
if (has_features) {
  merged_results &lt;- merged_results %&gt;% 
    mutate(
      feature = bestOverlap(
        ., external_features, &quot;feature&quot;, missing = &quot;no_feature&quot;
      ) %&gt;% 
        factor(levels = names(colours$features)) %&gt;% 
        fct_relabel(str_sep_to_title)
    )
}
merged_results &lt;- merged_results %&gt;%
  mapByFeature(
    genes = genes_gr, 
    prom = GRangesList(
      ## Add any external features which appear to be promoters
      ifelse(
        &quot;feature&quot; %in% colnames(mcols(external_features)), 
        list(granges(subset(external_features, str_detect(feature, &quot;[Pp]rom&quot;)))), 
        list(GRanges())
      )[[1]], 
      granges(gene_regions$promoters)) %&gt;% 
      unlist() %&gt;% 
      reduce(),
    enh = ifelse(
      &quot;feature&quot; %in% colnames(mcols(external_features)), 
      list(granges(subset(external_features, str_detect(feature, &quot;[Ee]nhanc&quot;)))), 
      list(GRanges())
    )[[1]],
    gi = hic, 
    gr2gene = params$mapping$gr2gene,
    prom2gene = params$mapping$prom2gene,
    enh2gene = params$mapping$enh2gene,
    gi2gene = params$mapping$gi2gene
  )</code></pre>
<p>In addition to statistical analysis, merged windows were first mapped
to the gene-centric region with the largest overlap. Windows were then
mapped to the external features provided in the same manner, followed by
mapping to all annotated genes.</p>
<p>During mapping to genes, promoters were defined the union of all
regions defined based on transcript-level annotation, and any external
features which were defined as promoters. Enhancers were any regions
defined in enhancer_atlas_2.0_zr75.gtf.gz as enhancers.</p>
<p>These features were used to map merged windows to features using the
process defined in the function
<code>extraChIPs::mapByFeature()</code>:</p>
<ol style="list-style-type: decimal">
<li>Ranges <em>overlapping a promoter</em> are assigned to genes
directly overlapping that specific promoter</li>
<li>Ranges <em>overlapping an enhancer</em> are assigned to all genes
within 100 kb of the enhancer</li>
<li>Ranges <em>overlapping a long-range interaction</em> are assigned to
all genes directly overlapping either end of the interaction</li>
<li>Ranges with <em>no gene assignment from the previous steps</em> are
assigned to all overlapping genes, or the nearest gene within 100kb</li>
</ol>
<p>Notably, genes are only passed to step 4 if no gene assignment has
been made in steps 1, 2 or 3. For visualisation purposes, only genes
which were considered as detected in any provided RNA-Seq data will be
shown as the mapping targets.</p>
</div>
</div>
<div id="results" class="section level1">
<h1>Results</h1>
<div id="result-tables" class="section level2 tabset">
<h2 class="tabset">Result Tables</h2>
<pre class="r"><code>up_col &lt;- function(x) {
  if (is.na(x) | is.nan(x)) return(&quot;#ffffff&quot;)
  rgb(
    colorRamp(c(&quot;#ffffff&quot;, colours$direction[[&quot;up&quot;]]))(x), maxColorValue = 255
  )
}
down_col &lt;- function(x) {
  if (is.na(x) | is.nan(x)) return(&quot;#ffffff&quot;)
  rgb(
    colorRamp(c(&quot;#ffffff&quot;, colours$direction[[&quot;down&quot;]]))(x), maxColorValue = 255
  )
}
unch_col &lt;- function(x) {
  if (is.na(x) | is.nan(x)) return(&quot;#ffffff&quot;)
  rgb(
    colorRamp(c(&quot;#ffffff&quot;, colours$direction[[&quot;unchanged&quot;]]))(x), 
    maxColorValue = 255
  )
}
lfc_col &lt;- function(x){
  if (is.na(x) | is.nan(x)) return(&quot;#ffffff&quot;)
  rgb(
    colorRamp(c(colours$direction[[&quot;down&quot;]], &quot;#ffffff&quot;, colours$direction[[&quot;up&quot;]]))(x), 
    maxColorValue = 255
  )
}
expr_col &lt;- function(x){
  if (is.na(x) | is.nan(x)) return(&quot;#ffffff&quot;)
  rgb(colorRamp(hcl.colors(9, &quot;TealRose&quot;))(x), maxColorValue = 255)
}
bar_style &lt;- function(width = 1, fill = &quot;#e6e6e6&quot;, height = &quot;75%&quot;, align = c(&quot;left&quot;, &quot;right&quot;), color = NULL, fontSize = c()) {
  align &lt;- match.arg(align)
  if (align == &quot;left&quot;) {
    position &lt;- paste0(width * 100, &quot;%&quot;)
    image &lt;- sprintf(&quot;linear-gradient(90deg, %1$s %2$s, transparent %2$s)&quot;, fill, position)
  } else {
    position &lt;- paste0(100 - width * 100, &quot;%&quot;)
    image &lt;- sprintf(&quot;linear-gradient(90deg, transparent %1$s, %2$s %1$s)&quot;, position, fill)
  }
  styles &lt;- list(
    backgroundImage = image,
    backgroundSize = paste(&quot;100%&quot;, height),
    backgroundRepeat = &quot;no-repeat&quot;,
    backgroundPosition = &quot;center&quot;,
    color = color
  )
  if (!is.null(fontSize)) styles$fontSize = fontSize
  styles
}
with_tooltip &lt;- function(value, width = 30) {
  tags$span(title = value, str_trunc(value, width))
}
n_unch &lt;- sum(merged_results$status == &quot;Unchanged&quot;)
n_windows &lt;- length(merged_results)
tbl_cols &lt;- list(
  Region = colDef(
    footer = htmltools::tags$b(&quot;Total&quot;), minWidth = 200
  ),
  Feature = colDef(
    footer = htmltools::tags$b(&quot;Total&quot;), minWidth = 200
  ),
  Up = colDef(
    cell = function(value) comma(value, 1),
    style = function(value) {
      normalized &lt;- value / (n_windows - n_unch)
      color &lt;- up_col(normalized)
      list(background = color)
    },
    footer = function(values) htmltools::tags$b(comma(sum(values)))
  ),
  Down = colDef(
    cell = function(value) comma(value, 1),
    style = function(value) {
      normalized &lt;- value / (n_windows - n_unch)
      color &lt;- down_col(normalized)
      list(background = color)
    },
    footer = function(values) htmltools::tags$b(comma(sum(values)))
  ),
  Ambiguous = colDef(
    cell = function(value) comma(value, 1),
    style = function(value) {
      normalized &lt;- value / (n_windows - n_unch)
      color &lt;- unch_col(normalized)
      list(background = color)
    },
    footer = function(values) htmltools::tags$b(comma(sum(values)))
  ),
  Unchanged = colDef(
    cell = function(value) comma(value, 1),
    style = function(value) {
      normalized &lt;- value / n_windows
      color &lt;- unch_col(normalized)
      list(background = color)
    },
    footer = function(values) htmltools::tags$b(comma(sum(values)))
  ),
  `% Changed` = colDef(
    cell = function(value) percent(value, 0.1),
    style = function(value) bar_style(width = value, fill = &quot;#B3B3B3&quot;, align = &quot;right&quot;),
    align = &quot;right&quot;,
    footer = htmltools::tags$b(
      percent(sum(1 - n_unch/ n_windows), 0.1)
    )
  ),
  Total = colDef(
    cell = function(value) comma(value, 1),
    style = function(value) {
      bar_style(width = value / n_windows, fill = &quot;#B3B3B3&quot;, align = &quot;right&quot;)
    },
    align = &quot;right&quot;,
    footer = function(values) htmltools::tags$b(comma(sum(values)))
  ),
  `% Of All Windows` = colDef(
    style = function(value) bar_style(width = value, fill = &quot;#B3B3B3&quot;, align = &quot;right&quot;),
    format = colFormat(digits = 2, percent = TRUE)
  )
)</code></pre>
<div id="overall-results" class="section level3">
<h3>Overall Results</h3>
<pre class="r"><code>tbl &lt;- merged_results %&gt;% 
  mutate(w = width) %&gt;% 
  as_tibble() %&gt;% 
  group_by(status) %&gt;% 
  summarise(
    n = dplyr::n(), 
    width = median(w),
    AveExpr = median(AveExpr),
    .groups = &quot;drop&quot;
  ) %&gt;% 
  mutate(`%` = n / sum(n)) %&gt;% 
  dplyr::select(status, n, `%`, everything()) %&gt;% 
  reactable(
    searchable = FALSE, filterable = FALSE,
    columns = list(
      status = colDef(
        name = &quot;Status&quot;, maxWidth = 150,
        footer = htmltools::tags$b(&quot;Overall&quot;)
      ),
      n = colDef(
        name = &quot;Nbr of Windows&quot;, maxWidth = 150, format = colFormat(separators = TRUE),
        footer = htmltools::tags$b(comma(length(merged_results)))
      ),
      width = colDef(
        name = &quot;Median Width (bp)&quot;, format = colFormat(digits = 1),
        footer = htmltools::tags$b(round(median(width(merged_results)), 1)),
        maxWidth = 200
      ),
      `%` = colDef(
        name = &quot;% Total Windows&quot;, format = colFormat(percent = TRUE, digits = 1),
        style = function(value) bar_style(width = value, align = &quot;right&quot;),
        maxWidth = 150
      ),
      AveExpr = colDef(
        name = &quot;Median Signal (logCPM)&quot;,
        format = colFormat(digits = 3),
        maxWidth = 200,
        footer = htmltools::tags$b(
          round(median(merged_results$AveExpr), 3)
        )
      )
    )
  )
cp &lt;- htmltools::em(
  glue(
    &quot;Overall results for changed {target} binding in the &quot;,
    glue_collapse(rev(treat_levels), last = &quot; Vs. &quot;),
    &quot; comparison.&quot;
  )
)
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Overall results for changed H3K27ac binding in the E2DHT Vs. E2 comparison.</em>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-881599e235dbbcbe00de" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-881599e235dbbcbe00de">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"status":["Up","Down","Unchanged"],"n":[335,2,40752],"%":[0.008153033658643432,4.8674827812796612e-05,0.99179829151354382],"width":[680,1180,1000],"AveExpr":[0.66132002678383506,0.77382738241441795,1.1284306127308141]},"columns":[{"id":"status","name":"Status","type":"factor","footer":{"name":"b","attribs":{},"children":["Overall"]},"maxWidth":150},{"id":"n","name":"Nbr of Windows","type":"numeric","format":{"cell":{"separators":true},"aggregated":{"separators":true}},"footer":{"name":"b","attribs":{},"children":["41,089"]},"maxWidth":150},{"id":"%","name":"% Total Windows","type":"numeric","format":{"cell":{"digits":1,"percent":true},"aggregated":{"digits":1,"percent":true}},"maxWidth":150,"style":[{"backgroundImage":"linear-gradient(90deg, transparent 99.1846966341357%, #e6e6e6 99.1846966341357%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 99.9951325172187%, #e6e6e6 99.9951325172187%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 0.820170848645617%, #e6e6e6 0.820170848645617%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null}]},{"id":"width","name":"Median Width (bp)","type":"numeric","format":{"cell":{"digits":1},"aggregated":{"digits":1}},"footer":{"name":"b","attribs":{},"children":["1000"]},"maxWidth":200},{"id":"AveExpr","name":"Median Signal (logCPM)","type":"numeric","format":{"cell":{"digits":3},"aggregated":{"digits":3}},"footer":{"name":"b","attribs":{},"children":["1.122"]},"maxWidth":200}],"dataKey":"37d99afe3f7096c90e6782de019a779b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="summary-by-region" class="section level3">
<h3>Summary By Region</h3>
<pre class="r"><code>df &lt;- merged_results %&gt;% 
  select(
    status, all_of(fdr_column), region
  ) %&gt;% 
  as_tibble() %&gt;% 
  group_by(region, status) %&gt;% 
  summarise(n = dplyr::n(), .groups = &quot;drop&quot;) %&gt;% 
  complete(region, status, fill = list(n = 0)) %&gt;% 
  group_by(region) %&gt;% 
  mutate(Total = sum(n)) %&gt;% 
  ungroup() %&gt;% 
  pivot_wider(names_from = &quot;status&quot;, values_from = &quot;n&quot;) %&gt;% 
  mutate(
    `% Of All Windows` = Total / length(merged_results),
    `% Changed` = 1 - Unchanged / Total
  ) %&gt;% 
  arrange(region) %&gt;% 
  dplyr::select(
    Region = region,
    any_of(names(direction_colours)),
    `% Changed`, Total, `% Of All Windows`
  )
cp &lt;- htmltools::em(
  glue(
    &quot;Overall results for changed {target} binding in the &quot;,
    glue_collapse(rev(treat_levels), last = &quot; Vs. &quot;),
    &quot; comparison, broken down by which genomic region contains the largest &quot;, 
    &quot;overlap with each merged window.&quot;
  )
)
tbl &lt;- df %&gt;%
  reactable(
    columns = tbl_cols[colnames(df)],
    defaultColDef = colDef(
      footer = function(values) htmltools::tags$b(comma(sum(values)))
    ),
    fullWidth = TRUE
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Overall results for changed H3K27ac binding in the E2DHT Vs. E2 comparison, broken down by which genomic region contains the largest overlap with each merged window.</em>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8310b33a59ac0237bfcb" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8310b33a59ac0237bfcb">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["Promoter (-1500/+500bp)","Upstream Promoter (<5kb)","Exon","Intron","Intergenic (<10kb)","Intergenic (>10kb)"],"Up":[28,33,10,180,35,49],"Down":[0,0,0,1,0,1],"Unchanged":[14098,4066,827,13529,2941,5291],"% Changed":[0.001982160555004997,0.0080507440839229227,0.011947431302270051,0.013202042304886974,0.011760752688172005,0.0093615427822505426],"Total":[14126,4099,837,13710,2976,5341],"% Of All Windows":[0.34379030884178247,0.099759059602326658,0.020370415439655381,0.33366594465672078,0.072428143785441365,0.12998612767407336]},"columns":[{"id":"Region","name":"Region","type":"factor","footer":{"name":"b","attribs":{},"children":["Total"]},"minWidth":200},{"id":"Up","name":"Up","type":"numeric","footer":{"name":"b","attribs":{},"children":["335"]},"cell":["28","33","10","180","35","49"],"style":[{"background":"#FAE9EC"},{"background":"#F9E6E9"},{"background":"#FDF7F8"},{"background":"#E27687"},{"background":"#F9E4E7"},{"background":"#F7D9DE"}]},{"id":"Down","name":"Down","type":"numeric","footer":{"name":"b","attribs":{},"children":["2"]},"cell":["0","0","0","1","0","1"],"style":[{"background":"#FFFFFF"},{"background":"#FFFFFF"},{"background":"#FFFFFF"},{"background":"#FEFEFE"},{"background":"#FFFFFF"},{"background":"#FEFEFE"}]},{"id":"Unchanged","name":"Unchanged","type":"numeric","footer":{"name":"b","attribs":{},"children":["40,752"]},"cell":["14,098","4,066","827","13,529","2,941","5,291"],"style":[{"background":"#D3D3D3"},{"background":"#F2F2F2"},{"background":"#FCFCFC"},{"background":"#D4D4D4"},{"background":"#F5F5F5"},{"background":"#EEEEEE"}]},{"id":"% Changed","name":"% Changed","type":"numeric","footer":{"name":"b","attribs":{},"children":["0.8%"]},"cell":["0.2%","0.8%","1.2%","1.3%","1.2%","0.9%"],"align":"right","style":[{"backgroundImage":"linear-gradient(90deg, transparent 99.8017839444995%, #B3B3B3 99.8017839444995%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 99.1949255916077%, #B3B3B3 99.1949255916077%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 98.805256869773%, #B3B3B3 98.805256869773%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 98.6797957695113%, #B3B3B3 98.6797957695113%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 98.8239247311828%, #B3B3B3 98.8239247311828%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 99.0638457217749%, #B3B3B3 99.0638457217749%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null}]},{"id":"Total","name":"Total","type":"numeric","footer":{"name":"b","attribs":{},"children":["41,089"]},"cell":["14,126","4,099","837","13,710","2,976","5,341"],"align":"right","style":[{"backgroundImage":"linear-gradient(90deg, transparent 65.6209691158218%, #B3B3B3 65.6209691158218%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 90.0240940397673%, #B3B3B3 90.0240940397673%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 97.9629584560345%, #B3B3B3 97.9629584560345%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 66.6334055343279%, #B3B3B3 66.6334055343279%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 92.7571856214559%, #B3B3B3 92.7571856214559%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 87.0013872325927%, #B3B3B3 87.0013872325927%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null}]},{"id":"% Of All Windows","name":"% Of All Windows","type":"numeric","footer":{"name":"b","attribs":{},"children":["1"]},"format":{"cell":{"digits":2,"percent":true},"aggregated":{"digits":2,"percent":true}},"style":[{"backgroundImage":"linear-gradient(90deg, transparent 65.6209691158218%, #B3B3B3 65.6209691158218%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 90.0240940397673%, #B3B3B3 90.0240940397673%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 97.9629584560345%, #B3B3B3 97.9629584560345%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 66.6334055343279%, #B3B3B3 66.6334055343279%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 92.7571856214559%, #B3B3B3 92.7571856214559%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 87.0013872325927%, #B3B3B3 87.0013872325927%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null}]}],"dataKey":"fea6132e6e3f7809e45234617c933a5f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="summary-by-feature" class="section level3">
<h3>Summary By Feature</h3>
<pre class="r"><code>df &lt;- merged_results %&gt;% 
  select(status, all_of(fdr_column), feature) %&gt;% 
  as_tibble() %&gt;% 
  group_by(feature, status) %&gt;% 
  tally() %&gt;% 
  ungroup() %&gt;% 
  complete(feature, status, fill = list(n = 0)) %&gt;% 
  group_by(feature) %&gt;% 
  mutate(Total = sum(n)) %&gt;% 
  ungroup() %&gt;% 
  pivot_wider(names_from = &quot;status&quot;, values_from = &quot;n&quot;) %&gt;% 
  mutate(
    `% Of All Windows` = Total / length(merged_results),
    `% Changed` = 1 - Unchanged / Total
  ) %&gt;% 
  arrange(feature) %&gt;% 
  dplyr::select(
    Feature = feature,
    any_of(names(direction_colours)),
    `% Changed`, Total, `% Of All Windows`
  )
cp &lt;- htmltools::em(
  glue(
    &quot;Overall results for changed {target} binding in the &quot;,
    glue_collapse(rev(treat_levels), last = &quot; Vs. &quot;),
    &quot; comparison, broken down by which external feature contains the largest &quot;, 
    &quot;overlap with each merged window.&quot;
  )
)
tbl &lt;- df %&gt;%
  reactable(
    columns = tbl_cols[colnames(df)],
    defaultColDef = colDef(
      footer = function(values) htmltools::tags$b(comma(sum(values)))
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Overall results for changed H3K27ac binding in the E2DHT Vs. E2 comparison, broken down by which external feature contains the largest overlap with each merged window.</em>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0e234e00bb150aff5fef" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0e234e00bb150aff5fef">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Feature":["Enhancer","No Feature"],"Up":[159,176],"Down":[2,0],"Unchanged":[19356,21396],"% Changed":[0.0082492186299123471,0.0081587242722047648],"Total":[19517,21572],"% Of All Windows":[0.47499330721117572,0.52500669278882428]},"columns":[{"id":"Feature","name":"Feature","type":"factor","footer":{"name":"b","attribs":{},"children":["Total"]},"minWidth":200},{"id":"Up","name":"Up","type":"numeric","footer":{"name":"b","attribs":{},"children":["335"]},"cell":["159","176"],"style":[{"background":"#E58695"},{"background":"#E3798A"}]},{"id":"Down","name":"Down","type":"numeric","footer":{"name":"b","attribs":{},"children":["2"]},"cell":["2","0"],"style":[{"background":"#FDFEFE"},{"background":"#FFFFFF"}]},{"id":"Unchanged","name":"Unchanged","type":"numeric","footer":{"name":"b","attribs":{},"children":["40,752"]},"cell":["19,356","21,396"],"style":[{"background":"#C2C2C2"},{"background":"#BCBCBC"}]},{"id":"% Changed","name":"% Changed","type":"numeric","footer":{"name":"b","attribs":{},"children":["0.8%"]},"cell":["0.8%","0.8%"],"align":"right","style":[{"backgroundImage":"linear-gradient(90deg, transparent 99.1750781370088%, #B3B3B3 99.1750781370088%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 99.1841275727795%, #B3B3B3 99.1841275727795%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null}]},{"id":"Total","name":"Total","type":"numeric","footer":{"name":"b","attribs":{},"children":["41,089"]},"cell":["19,517","21,572"],"align":"right","style":[{"backgroundImage":"linear-gradient(90deg, transparent 52.5006692788824%, #B3B3B3 52.5006692788824%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 47.4993307211176%, #B3B3B3 47.4993307211176%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null}]},{"id":"% Of All Windows","name":"% Of All Windows","type":"numeric","footer":{"name":"b","attribs":{},"children":["1"]},"format":{"cell":{"digits":2,"percent":true},"aggregated":{"digits":2,"percent":true}},"style":[{"backgroundImage":"linear-gradient(90deg, transparent 52.5006692788824%, #B3B3B3 52.5006692788824%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null},{"backgroundImage":"linear-gradient(90deg, transparent 47.4993307211176%, #B3B3B3 47.4993307211176%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null}]}],"dataKey":"27d83646665ad9b7011841d156b0a7b3"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="most-highly-ranked" class="section level3">
<h3>Most Highly Ranked</h3>
<pre class="r"><code>show_n &lt;- min(200, length(merged_results))
scaling_vals &lt;- list(
  logFC = c(-1, 1)*max(abs(merged_results$logFC)),
  AveExpr = range(merged_results$AveExpr),
  Width = max(width(merged_results))
)
cp &lt;- htmltools::em(
  glue(
    &quot;The {show_n} most highly-ranked windows by FDR, with &quot;,
    sum(merged_results$P.Value_fdr &lt; fdr_alpha), 
    &quot; showing evidence of changed {target} binding. &quot;,
    &quot;Regions were assigned based on which genomic region showed the largest &quot;,
    &quot;overlap with the final merged window. &quot;,
    ifelse(
      has_features, 
      glue(&quot;Features are as provided in the file {basename(config$external$features)}. &quot;),
      glue(&quot;&quot;)
    ),
    &quot;For windows mapped to large numbers of genes, hovering a mouse over the &quot;, 
    &quot;cell will reveal the full set of genes. &quot;,
    ifelse(
      has_rnaseq,
      &quot;Only genes considered as detected in the RNA-Seq data are shown. &quot;,
      &quot;&quot;
    ),
    &quot;The Macs2 Peak column is filterable using T/F values&quot;
  )
)
fs &lt;- 12
tbl &lt;- merged_results %&gt;%
  mutate(w = width) %&gt;% 
  arrange(!!sym(fdr_column)) %&gt;% 
  plyranges::slice(seq_len(show_n)) %&gt;% 
  select(
    w, AveExpr, logFC, FDR = !!sym(fdr_column), 
    overlaps_ref, Region = region, any_of(&quot;feature&quot;), Genes = gene_name
  ) %&gt;% 
  as_tibble() %&gt;% 
  dplyr::rename(
    Range = range, `Width (bp)` = w, `Macs2 Peak` = overlaps_ref
  ) %&gt;% 
  rename_all(str_replace_all, &quot;feature&quot;, &quot;Feature&quot;) %&gt;% 
  mutate(Genes = vapply(Genes, paste, character(1), collapse = &quot;; &quot;)) %&gt;% 
  reactable(
    filterable = TRUE,
    showPageSizeOptions = TRUE,
    pageSizeOptions = c(10, 20, 50, show_n), defaultPageSize = 10,
    borderless  = TRUE,
    columns = list(
      Range = colDef(
        minWidth = 10 * fs,
        cell = function(value) {
          str_replace_all(value, &quot;:&quot;, &quot;: &quot;)
        }
      ),
      `Width (bp)` = colDef(
        style = function(value) {
          x &lt;- value / scaling_vals$Width
          colour &lt;- expr_col(x)
          list(
            background = colour, 
            borderRight = &quot;1px solid rgba(0, 0, 0, 0.1)&quot;
          )
        },
        maxWidth = 5 * fs
      ),
      AveExpr = colDef(
        cell = function(value) round(value, 2),
        style = function(value) {
          x &lt;- (value - min(scaling_vals$AveExpr)) / diff(scaling_vals$AveExpr)
          colour = expr_col(x)
          list(background = colour)
        },
        maxWidth = 5.5 * fs
      ),
      logFC = colDef(
        cell = function(value) round(value, 2),
        style = function(value) {
          x &lt;- (value - min(scaling_vals$logFC)) / diff(scaling_vals$logFC)
          colour &lt;- lfc_col(x)
          list(background = colour)
        },
        maxWidth = 5.5 * fs
      ),
      FDR = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value),
        style = list(borderRight = &quot;1px solid rgba(0, 0, 0, 0.1)&quot;),
        maxWidth = 5.5 * fs
      ),
      `Macs2 Peak` = colDef(
        cell = function(value) ifelse(value, &quot;\u2714 Yes&quot;, &quot;\u2716 No&quot;),
        style = function(value) {
          color &lt;- ifelse(value, &quot;#008000&quot;, &quot;#e00000&quot;)
          list(color = color, borderRight = &quot;1px solid rgba(0, 0, 0, 0.1)&quot;)
        },
        maxWidth = 5 * fs
      ),
      Region = colDef(maxWidth = 150),
      Genes = colDef(
        cell = function(value) with_tooltip(value),
        minWidth = 11 * fs
      )
    ),
    theme = reactableTheme(style = list(fontSize = fs))
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>The 200 most highly-ranked windows by FDR, with 225 showing evidence of changed H3K27ac binding. Regions were assigned based on which genomic region showed the largest overlap with the final merged window. Features are as provided in the file enhancer_atlas_2.0_zr75.gtf.gz. For windows mapped to large numbers of genes, hovering a mouse over the cell will reveal the full set of genes. Only genes considered as detected in the RNA-Seq data are shown. The Macs2 Peak column is filterable using T/F values</em>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-448fc7a34e0a8146d6bb" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-448fc7a34e0a8146d6bb">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Range":["chr17:78041721-78043440","chr17:71856881-71857760","chr1:146580761-146582200","chr17:35629961-35634440","chr2:120095721-120096040","chr11:34692601-34693920","chr19:3429801-3431400","chr1:184601161-184603080","chr18:60167721-60168960","chr12:64983521-64984000","chr17:56007561-56010320","chr5:148980801-148981240","chr10:79256561-79258880","chr1:179840481-179841960","chr8:133910721-133911320","chr14:81054001-81054480","chr4:24805601-24807680","chr17:35674641-35674960","chr14:97126721-97128840","chr17:35678481-35679160","chr16:16135401-16135840","chr5:36285521-36286080","chr4:70261401-70262040","chr8:50996721-50999080","chr17:35672201-35672600","chr19:4989481-4993480","chr4:8353881-8354680","chr12:102009481-102009960","chr17:71856041-71856800","chr22:24364241-24364680","chr9:33430321-33432640","chr4:70073601-70074040","chr14:35848001-35848400","chr17:35675121-35675480","chr18:55952361-55953040","chr19:46246121-46247320","chr1:36705721-36706200","chr6:6748481-6749320","chr19:41360561-41363680","chr1:20359241-20359720","chr18:12589121-12589760","chr1:163586921-163587360","chr5:148980201-148980640","chr1:109370361-109372240","chr6:35569961-35570440","chr9:33436601-33438360","chr18:20066041-20066600","chr12:46639921-46640680","chr12:15427121-15427560","chr5:32093681-32094200","chr12:64984401-64984680","chr5:93697241-93697480","chr2:227604081-227604240","chr9:98045681-98046400","chr10:102179921-102180360","chr17:35679481-35679800","chr15:86080641-86081560","chr1:19752401-19753800","chr4:106831121-106831960","chr5:71009761-71010920","chr4:41079161-41079640","chrX:44750481-44752080","chr5:36286281-36286760","chr10:43689201-43690920","chr17:71212001-71213000","chr10:74008081-74008880","chr12:57672641-57673240","chr6:3669521-3670280","chr8:8264001-8264240","chr8:63570721-63571240","chr18:56216761-56217040","chr22:30804281-30804920","chr1:60234841-60235360","chr17:47470801-47473680","chr4:41080081-41081240","chr15:61681681-61681880","chr5:148993921-148994400","chr13:77665521-77665960","chr14:35849041-35849240","chr5:172437521-172439440","chr13:77880921-77881640","chr2:62652641-62652840","chr17:47465881-47470640","chr2:62651721-62651920","chr17:35672841-35673120","chr6:35694721-35696480","chr16:30626361-30627200","chr15:86079801-86079920","chr6:106878841-106879160","chr7:98621881-98622240","chr12:16626561-16626840","chr15:45329561-45330200","chr4:39546001-39546440","chr10:63858721-63859200","chr20:36474001-36475880","chr10:81101561-81102080","chr8:110592561-110593440","chr4:8353041-8353640","chr2:216700721-216701080","chr6:34565321-34567600","chr16:34751201-34751680","chr16:1679921-1681880","chr1:19784801-19785560","chr1:118282961-118283320","chr8:68723161-68723680","chr1:2341561-2342280","chr6:35693961-35694080","chr1:160126441-160127160","chr1:47108121-47110240","chr5:167710481-167710960","chr7:27975721-27976080","chr3:42585601-42587360","chr15:38508481-38509080","chr5:35205201-35205680","chr5:148993201-148993800","chr12:52518961-52521000","chr13:77880281-77880840","chr1:57254041-57254800","chr3:58135361-58136120","chr1:167880761-167881120","chr12:117073961-117075400","chr13:24775721-24776400","chr17:62300401-62300600","chr5:32094521-32095720","chr10:76706241-76709240","chr8:63570201-63570440","chr4:6956761-6960120","chr2:67742521-67743400","chr20:36618201-36618800","chr9:110802921-110803960","chr7:95178841-95180400","chr7:113656441-113657040","chr3:39171481-39173080","chr5:32145801-32146240","chr11:34771361-34771960","chr22:30789361-30790040","chrX:24109081-24109880","chr4:70105201-70105520","chr7:66935201-66935360","chr6:34570921-34571520","chr13:34909481-34909760","chr3:181019441-181020160","chr8:120989361-120989760","chr14:33463521-33464240","chr7:12755201-12755400","chr17:29381561-29381960","chr12:6375481-6376440","chr21:16958561-16959200","chr2:220711441-220712280","chr4:184181921-184182440","chr1:242309841-242310680","chr10:120116521-120116840","chr15:76155361-76156360","chr18:8703681-8706960","chr15:45976921-45977800","chr14:69016641-69017120","chr7:134536761-134538400","chr6:148579241-148580160","chr1:242310801-242311640","chr10:33529841-33530560","chr9:121788641-121789320","chr3:187068841-187069240","chr22:30788321-30789040","chr2:224094881-224095080","chr14:21242841-21243440","chr5:148398081-148398760","chr12:6129681-6130240","chr6:35569081-35569400","chr16:67492721-67497800","chr5:71011001-71012040","chr9:131868961-131869600","chr2:220710841-220711200","chr9:4865361-4866280","chr6:53333001-53334040","chr14:24305161-24306960","chr16:34757841-34758400","chr10:101097641-101099680","chr15:85874761-85874960","chr13:42354361-42356440","chr20:49458881-49460000","chr7:36824521-36825400","chr1:60234201-60234520","chr6:6749441-6750840","chr13:45427961-45428920","chr18:12589881-12590200","chr17:69906601-69907280","chrX:123124201-123124320","chr13:86298201-86299320","chr1:163595801-163596560","chr5:35206081-35206640","chr3:177803001-177803760","chr9:111471001-111474040","chr8:110583201-110583400","chr21:30014281-30015080","chrX:40376561-40379160","chr5:6585641-6585760","chr3:72347081-72347600","chr1:146584881-146587360","chr1:19785801-19786400","chr4:151644321-151645240"],"Width (bp)":[1720,880,1440,4480,320,1320,1600,1920,1240,480,2760,440,2320,1480,600,480,2080,320,2120,680,440,560,640,2360,400,4000,800,480,760,440,2320,440,400,360,680,1200,480,840,3120,480,640,440,440,1880,480,1760,560,760,440,520,280,240,160,720,440,320,920,1400,840,1160,480,1600,480,1720,1000,800,600,760,240,520,280,640,520,2880,1160,200,480,440,200,1920,720,200,4760,200,280,1760,840,120,320,360,280,640,440,480,1880,520,880,600,360,2280,480,1960,760,360,520,720,120,720,2120,480,360,1760,600,480,600,2040,560,760,760,360,1440,680,200,1200,3000,240,3360,880,600,1040,1560,600,1600,440,600,680,800,320,160,600,280,720,400,720,200,400,960,640,840,520,840,320,1000,3280,880,480,1640,920,840,720,680,400,720,200,600,680,560,320,5080,1040,640,360,920,1040,1800,560,2040,200,2080,1120,880,320,1400,960,320,680,120,1120,760,560,760,3040,200,800,2600,120,520,2480,600,920],"AveExpr":[0.79974972787495968,1.4383303748886349,1.1612398463226625,1.8203776927333515,-0.39172661531310476,1.1413892589117698,1.6165884627280318,2.5143412679465564,0.79035408409957253,0.54041440627842763,1.9042239413743791,0.46491757327187139,1.310132494241337,0.82685379623466626,0.76695530786986787,-0.020818963273438334,2.3089711187406197,-0.23529704220078113,1.9247284642145617,0.39941666268321679,0.016985983920505043,0.58593457053092313,0.55342581801609625,1.2870408492443906,0.15751120249232711,1.9053065138417029,1.1166946531121114,0.63780133173333697,0.57735937755888811,0.12595235834471039,1.4513887518949842,0.11699480855242582,-0.087820187555010532,0.025247209411389249,0.89744244013644747,1.8331466794620512,0.33774098420084098,0.95172929138555795,1.874665679623007,0.084067794873780466,0.69136990045124513,0.99165561005718827,0.34319280827156706,0.96615299330144155,0.12662515261410665,0.69336585756429436,0.6432677612997626,0.64282305016998764,0.40597778157303965,0.64790530765793219,-0.024677858873768648,-0.034642753244520708,-0.29431477440738979,0.57633993713807474,0.20489825739945264,-0.24963676375710833,0.66573277176037404,1.7115765041997453,0.42063695714011606,2.1441182928455129,0.43895633288527336,1.0212107853605101,0.43094159075469018,0.85014561152902379,0.77706195006446999,0.75665202681868271,-0.26702265369116795,0.73328824613802079,-0.12729732956398421,-0.07055141899628975,0.26585663840186896,0.45248237737860653,0.48777559978545137,2.9985107912463631,0.41717469104198701,-0.16773182338840717,0.14955471362323344,0.27738648158792184,-0.29326233666019608,1.5286241480961007,0.64927994960878599,-0.17872250263811321,3.9022802193623232,0.24959483910275243,-0.019723029743599695,1.4256828448331011,1.0043440301590385,-0.091967412332285073,-0.010137045303582051,0.26259667111850543,-0.026485199850286911,0.4647893994832078,0.18985165413107127,0.19498736251083046,2.0491412944605916,0.53370699341072514,1.6689793156293196,0.59120749629285296,0.11040247460962592,1.6114250727827275,0.52618116158015893,1.3622676608964108,0.97266422313160517,0.56961971621435592,0.61959256820326047,0.58595206357587803,-0.33525398737899614,1.5484012114651242,2.0138008294634866,0.34659195802806675,0.022760097179889149,1.4386309821849828,0.5344464270479018,0.11876605900399059,0.61758380569280213,1.3257267351798376,0.71378457937736672,1.0428770596284214,0.83489346546806775,0.46021811452310413,0.92076635290758846,0.39707005311881705,0.22821638585669102,1.0433139089031656,1.5509840027930515,-0.21123290088345145,1.588318524459388,1.5440635638523301,0.65014356513704075,0.36365238525307331,1.342426623303357,0.39668875619366162,1.2324301748286062,-0.028914052228142011,0.62921997740341085,0.4380695846854028,1.2336999378122915,0.090476562670683339,-0.13042103465573329,0.49887188900287788,-0.0096033320303624634,0.69789972632517983,0.33011144294788647,0.51113163209847801,-0.042090589761453225,0.34048121935224207,0.93686439256161069,0.6733749849618329,0.89647234348022919,0.50811282541738212,1.1970045802664795,0.21027723906020943,0.86557627133419857,3.2485661149687308,0.78238901498870272,0.3154776544055094,1.1511194104831126,1.6328912965950253,1.6663276655002432,0.72119827125321301,0.31562812602419976,0.3218894411627683,0.82062756684956173,-0.20405336253671341,0.71173106649121509,0.52835744298272624,0.89523160659053613,0.14119288059530963,2.9091673907666475,1.8050274771524994,1.0450935106398633,0.096067764453619767,0.4558858943129252,0.88810642878234702,2.0886744147498817,1.1343815547831704,1.6111277126759334,-0.059285646503105298,1.240101772719429,1.580001414152594,1.327444371695691,-0.086422387843561987,1.2570412656240455,1.072610114819962,-0.13428706661654879,0.72040822948980032,-0.1161345565594261,1.2457419755611578,1.2938356254482895,0.67027253028342859,0.82317704300403305,2.4775870296567604,-0.062042787996550462,1.449690173254488,2.1154653934513816,-0.15919484586332128,0.37190552954724676,2.2100196203493221,0.91388247970025571,0.93751261822343079],"logFC":[2.80413713490629,2.1455929266621334,2.1649163218197667,1.6486698678079577,3.1245427444815554,1.9615158692703409,1.6949950484483725,1.2686538388083484,2.1035159744702492,2.1538374341285271,1.4499686161213545,2.1174830277799699,1.6130808628859254,1.9016880153710147,1.8976594935283631,2.3700269877542346,1.1866606001090743,2.4691245615025847,1.323826603108198,2.0034710045228046,2.2306833129660695,1.8640593875680262,1.8461692875012903,1.552123145518401,2.0791710063090627,1.2580223282227676,1.5291111318037454,1.7699254208698663,1.7366982863565055,2.2529381276256712,1.3984600235274756,2.0360201670756499,2.1180771406175594,2.0349829015311154,1.5432408395633046,1.2288261085824028,1.8219015661534605,1.5110618316702946,1.2103178754549617,1.9322841910719697,1.6084303561170545,1.5301725327613862,1.759394238114806,1.4647093979825361,1.8776824748182173,1.6172472146368941,1.5932997873215087,1.6018188623216703,1.7080516309644402,1.5963152537704592,1.944063291202319,1.9317479044472088,2.1010186168311384,1.5852405687218956,1.8422966513382204,2.0816264526154331,1.5428260495160955,1.2018103886400275,1.6296634307050117,1.0978950504566221,1.6201193366499145,1.3627291965452877,1.6047900652189862,1.4230326442458576,1.4976505328012526,1.460894173692139,2.3151090409249568,1.4793745867131005,1.8575260872632176,1.8343803698460841,1.6151449937793301,1.5733449337711876,1.523966050404661,0.80206956310594468,1.5638345776148508,1.855208803834882,1.6550404782502088,1.6115251896213272,2.2626296749869002,1.134896996346153,1.5134605605840128,2.19192950152416,0.59728187331143434,1.8859093720582967,1.7228006375154163,1.1451286392100741,1.282542702795622,2.0653817096280287,1.6897256955359927,1.5516664552220565,1.712159964764753,1.4545788504818282,1.5972439888885495,1.5571385790680874,0.96298533544848219,1.4454596044979828,1.0768066741877536,1.4041910825692832,1.5750637027429633,1.0868873063840032,1.4304079408368502,1.1608340853020769,1.2362545391963895,1.3748641624582536,1.3411930979844551,1.3402140954479422,2.1636939837886264,1.0688081854659901,0.95357962871668189,1.4288584379879188,1.6115106790263352,1.1222342228743794,1.3590647567518133,1.5352539222921933,1.3137074754793678,1.1254100105536684,1.2809305037592238,1.205206741719403,1.2539076308650623,1.3803359524732282,1.2097691391574197,1.3823089638772719,1.776564800374804,1.1871438020860778,1.0270591813260832,1.7060721134294097,1.0306216493225986,1.0117534869266771,1.2507235745135266,1.4065108465289036,1.106739000064761,1.3623926222632845,1.0957709060371872,1.5081787993038165,1.2754698383086134,1.5869999864462052,1.0902996196818093,1.4432136118362171,1.5495453438967071,1.2801480153220908,1.4865237680879486,1.2250855206294951,1.3278864288621468,1.2531700231239911,1.491305711287201,1.3371293287637818,1.1273566938984847,1.2382121560940433,1.1661541078109801,1.243924982578374,1.0394176030708497,1.4094254983227446,1.1167746897165585,0.61316250815724305,1.2157243931548678,1.2828920367777301,1.0503431110617936,0.93669442113524237,0.91391830871140434,1.142714344362636,1.2749580410051422,1.2737184158387502,1.1439616822018064,1.4722798503168131,1.1516935791698724,1.2258391652670055,1.0741237493205764,1.3045352955599547,0.67659803097724702,0.90088108780331033,1.0346512945346329,1.3887886850131399,1.2287413878882167,1.126023199377336,0.80374714074860854,1.0289454869023589,0.89487499067339582,1.3876778044132811,1.0081241151300244,0.91782662726434039,0.95332409752491309,1.3812279728809256,0.96389385265134964,1.0290797982230555,1.7943801088339659,1.0898298533054935,1.7616685611018226,1.007153920388977,0.98564925911086021,1.1406295163294831,1.053468060555254,0.71547880560182886,1.3359473823287373,0.92688075316257712,0.80855238430192533,1.3916100944165135,1.171372951849706,0.75602183986195548,1.0214267595675928,1.0087500503274296],"FDR":[1.8401664895898737e-16,3.3163114559630752e-14,2.2920119916353057e-12,8.8189767852168559e-11,2.1578959934005221e-10,2.4172161154951888e-10,2.4172161154951888e-10,6.2149087237299924e-10,6.5918504739995746e-10,1.4878969250846837e-09,2.22629541103767e-09,8.8985430655940932e-09,2.1871653221505635e-08,2.3872090781199001e-08,2.3872090781199001e-08,5.5508940581596074e-08,7.2727742535253928e-08,1.2470370564259047e-07,1.4359669931936375e-07,1.4359669931936375e-07,1.8342817665587547e-07,2.4632202622975069e-07,3.1983493503599904e-07,3.2440615196329107e-07,3.5123405845344941e-07,8.5146651834556065e-07,8.8542602999741624e-07,1.347633007256738e-06,1.4430433665802692e-06,1.8931034560402364e-06,2.3324036210483527e-06,2.6199264590734963e-06,2.6199264590734963e-06,2.6199264590734963e-06,4.0149016481298463e-06,4.0149016481298463e-06,4.0373883862076007e-06,4.0373883862076007e-06,4.0373883862076007e-06,4.4957759720128146e-06,4.6175211210954396e-06,4.8250026976437564e-06,5.9430737097006438e-06,7.4942081889662094e-06,7.8225608549365211e-06,7.8225608549365211e-06,7.8225608549365211e-06,1.0760307340999972e-05,1.0845074023587006e-05,1.0896371275954974e-05,1.0896371275954974e-05,1.1020512154166995e-05,1.1340555909883008e-05,1.2152699361414881e-05,1.2369168035895324e-05,1.5937808962285516e-05,1.6274361003497607e-05,2.01483921897978e-05,2.9011287130151853e-05,2.9011287130151853e-05,3.0922862898364077e-05,3.2696796041825407e-05,3.4559559210046053e-05,3.4757489505537083e-05,3.8823504352771126e-05,4.0848079311990507e-05,4.0848079311990507e-05,4.3468155716681911e-05,5.6964775736226156e-05,5.7190212311763324e-05,7.9216379588775297e-05,7.9216379588775297e-05,8.4866785582049658e-05,8.5858421020512402e-05,8.737760879543663e-05,9.2988022510709766e-05,0.00010234684855023142,0.0001043128510726643,0.00010999760865489126,0.00011113596654674286,0.00011447464657422222,0.00011710930964844704,0.00014808585511015757,0.00014815065921729609,0.00017027437565869368,0.00018001468063712659,0.00018610138704490422,0.0001895841910483058,0.00020837938556357439,0.00023002670179098956,0.00023002670179098956,0.00023002670179098956,0.0002312452933419626,0.00023234549006442167,0.0002381732386434468,0.00027296827927033343,0.00029603134296767118,0.0003383815073329298,0.00035065731262420212,0.00035065731262420212,0.00035065731262420212,0.0003823636424631011,0.00041679756700908243,0.00041679756700908243,0.00042832373700621001,0.00046286902762224897,0.00046641816374131664,0.00048328256074835224,0.00049951293618727725,0.00049951293618727725,0.00053310825892405507,0.00054261741754434883,0.00055436532045714337,0.00055620266358516002,0.00058412524151660197,0.00058412524151660197,0.00059456210273390057,0.00060936558502205104,0.00061138175926181014,0.00063502505592372691,0.00065846693545200928,0.0006730726352549729,0.00072743903153571271,0.00074747375545800802,0.00079345509763170479,0.00097145227802222507,0.0010587657481715186,0.0011327484710139729,0.0011871270895851716,0.0013934295817324205,0.0014571331246103511,0.0014923938552481755,0.0015437780409232309,0.0015677618194089799,0.0015837821232540425,0.0015837821232540425,0.0016144028736793418,0.0017211498814403768,0.0017499835564796064,0.0017592138096072004,0.0019303190678182742,0.0019739847344560739,0.0019793028092200647,0.0020616380037947308,0.0021212978952656267,0.0021212978952656267,0.0021711601843957531,0.0022540012477050646,0.0024391384188085113,0.0024607097978955115,0.0026888602863825522,0.0026888602863825522,0.003255612259351308,0.003490567258378019,0.0035062372582061276,0.0035903164891177355,0.0037872071003186487,0.0038664047808076602,0.0041205917478760812,0.0041205917478760812,0.0046217264675575418,0.0047306967310417891,0.0047306967310417891,0.0047487958996008228,0.0047487958996008228,0.0050620160792141742,0.0050620160792141742,0.0054807858737205284,0.0055855855883287951,0.005792909029871781,0.005792909029871781,0.0058018348028296479,0.0059704192337489094,0.0060433741743553355,0.0062470930708658171,0.0062470930708658171,0.0062773012792214037,0.0063472877624661242,0.0065232019748652139,0.0065232019748652139,0.006669971495708216,0.0069062047931765713,0.0071626823115882457,0.0071956904931028704,0.0075211710319190864,0.0077020097772427061,0.0077421987343571997,0.0082539800214041607,0.0083007682963229801,0.0084462426710213458,0.0085025347511700437,0.008519714840517183,0.0085354806303902849,0.0085354806303902849,0.0086663136797052037,0.0086963108002145687,0.0088151535843488532,0.0088375800101217969,0.0090020586402355541,0.0091131988548378458],"Macs2 Peak":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"Region":["Intron","Intergenic (>10kb)","Intron","Intron","Intron","Intergenic (>10kb)","Upstream Promoter (<5kb)","Intron","Intergenic (>10kb)","Intron","Intron","Intron","Intron","Intron","Intron","Intron","Intergenic (<10kb)","Intron","Upstream Promoter (<5kb)","Intron","Intron","Intron","Intron","Intron","Intron","Intron","Intergenic (<10kb)","Promoter (-1500/+500bp)","Intergenic (>10kb)","Upstream Promoter (<5kb)","Intergenic (<10kb)","Upstream Promoter (<5kb)","Intergenic (<10kb)","Intron","Intron","Intron","Intron","Intergenic (<10kb)","Intron","Intron","Intron","Intergenic (>10kb)","Intron","Intron","Intron","Intergenic (<10kb)","Intergenic (>10kb)","Intron","Intron","Upstream Promoter (<5kb)","Intron","Intron","Intron","Intron","Intron","Intron","Intron","Intron","Promoter (-1500/+500bp)","Upstream Promoter (<5kb)","Intron","Intron","Intron","Exon","Intron","Intergenic (>10kb)","Intron","Intron","Intergenic (<10kb)","Exon","Intron","Promoter (-1500/+500bp)","Intron","Intron","Intron","Intron","Intron","Upstream Promoter (<5kb)","Intergenic (<10kb)","Intron","Intron","Intergenic (>10kb)","Intron","Intergenic (>10kb)","Intron","Intron","Promoter (-1500/+500bp)","Exon","Intron","Intron","Intron","Intron","Exon","Intergenic (<10kb)","Promoter (-1500/+500bp)","Intergenic (<10kb)","Promoter (-1500/+500bp)","Intergenic (<10kb)","Upstream Promoter (<5kb)","Intron","Intron","Promoter (-1500/+500bp)","Intron","Intergenic (>10kb)","Intergenic (>10kb)","Promoter (-1500/+500bp)","Intron","Intron","Intron","Intergenic (<10kb)","Intron","Intergenic (<10kb)","Intron","Intron","Intron","Intergenic (>10kb)","Intron","Intron","Promoter (-1500/+500bp)","Intron","Intergenic (>10kb)","Intron","Intron","Upstream Promoter (<5kb)","Intron","Intron","Intron","Intergenic (>10kb)","Intron","Intergenic (<10kb)","Intron","Intron","Promoter (-1500/+500bp)","Intron","Intergenic (<10kb)","Upstream Promoter (<5kb)","Intergenic (>10kb)","Upstream Promoter (<5kb)","Intergenic (>10kb)","Intron","Intergenic (>10kb)","Intron","Intron","Intron","Intergenic (>10kb)","Upstream Promoter (<5kb)","Intergenic (<10kb)","Intron","Intergenic (>10kb)","Upstream Promoter (<5kb)","Promoter (-1500/+500bp)","Promoter (-1500/+500bp)","Intron","Promoter (-1500/+500bp)","Intron","Intron","Intron","Intron","Promoter (-1500/+500bp)","Intron","Intergenic (>10kb)","Intergenic (>10kb)","Upstream Promoter (<5kb)","Intergenic (>10kb)","Intergenic (<10kb)","Intron","Intron","Intron","Upstream Promoter (<5kb)","Upstream Promoter (<5kb)","Promoter (-1500/+500bp)","Intergenic (>10kb)","Intron","Intergenic (>10kb)","Intergenic (<10kb)","Intergenic (<10kb)","Intron","Promoter (-1500/+500bp)","Intron","Upstream Promoter (<5kb)","Intergenic (<10kb)","Intron","Intergenic (<10kb)","Intergenic (>10kb)","Intron","Intergenic (>10kb)","Intron","Intron","Intergenic (>10kb)","Intron","Intron","Intergenic (<10kb)","Intergenic (<10kb)","Intron","Intergenic (<10kb)","Promoter (-1500/+500bp)","Intergenic (<10kb)","Intron","Intron","Intron"],"Feature":["No Feature","No Feature","Enhancer","Enhancer","No Feature","No Feature","No Feature","Enhancer","No Feature","No Feature","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","No Feature","Enhancer","No Feature","No Feature","No Feature","No Feature","No Feature","Enhancer","No Feature","No Feature","Enhancer","Enhancer","Enhancer","No Feature","No Feature","Enhancer","Enhancer","No Feature","No Feature","No Feature","Enhancer","No Feature","Enhancer","No Feature","No Feature","No Feature","Enhancer","Enhancer","No Feature","Enhancer","No Feature","No Feature","No Feature","Enhancer","No Feature","No Feature","Enhancer","Enhancer","No Feature","Enhancer","No Feature","No Feature","Enhancer","No Feature","No Feature","Enhancer","No Feature","No Feature","No Feature","No Feature","No Feature","No Feature","Enhancer","No Feature","No Feature","Enhancer","No Feature","No Feature","No Feature","Enhancer","No Feature","No Feature","No Feature","No Feature","No Feature","No Feature","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","No Feature","No Feature","No Feature","No Feature","No Feature","No Feature","Enhancer","No Feature","No Feature","No Feature","No Feature","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","No Feature","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","No Feature","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","No Feature","No Feature","Enhancer","No Feature","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","Enhancer","No Feature","Enhancer","No Feature","Enhancer","No Feature","No Feature","Enhancer","No Feature","Enhancer","No Feature","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","Enhancer","Enhancer","No Feature","No Feature","No Feature","No Feature","Enhancer","No Feature","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","No Feature","Enhancer","No Feature","Enhancer","No Feature","Enhancer","Enhancer","No Feature","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","Enhancer","No Feature","No Feature","No Feature","No Feature","Enhancer","Enhancer","No Feature","Enhancer","No Feature","Enhancer","Enhancer","Enhancer","No Feature","Enhancer","Enhancer","Enhancer"],"Genes":["CCDC40","","PRKAB2; PDIA3P1; FMO5","ACACA","C2orf76","EHF","NFIC","C1orf21; EDEM3","ZCCHC2","RASSF3","MRPS23; CUEDC1; VEZF1; AC015813.1; SRSF1; AC015813.5","CSNK1A1; AC021078.1; ARHGEF37","KCNMA1","TOR1AIP2; TOR1AIP1; CEP350","PHF20L1","CEP128","CCDC149","ACACA","","ACACA","ABCC1","RANBP3L","","","ACACA","UHRF1; KDM4B","AC104825.1; ACOX3; TRMT44","CHPT1","","DDT","NFX1; AQP3; NOL6; ANKRD18B","","NFKBIA","ACACA","NEDD4L","GIPR; QPCTL; EML2; SNRPD2; FBXO46; AC007191.1; SIX5; DMPK; DMWD; SYMPK","THRAP3","","EGLN2","","SPIRE1","","CSNK1A1; AC021078.1; ARHGEF37","STXBP3","FKBP5","AQP3","","SLC38A1","RERG","PDZD2","RASSF3","KIAA0825","IRS1; AC010735.2; RHBDD1","FANCC","SCD; OLMALINC","ACACA","AKAP13","SLC66A1; CAPZB; MICOS10","NPNT","MCCC2","APBB2","KDM6A","RANBP3L","RASGEF1A","FAM104A","ANAPC16","R3HDM2","AL033523.1; PXDC1","PRAG1","","","RNF215; SEC14L2","FGGY","PHB","APBB2","","ARHGEF37","MYCBP2","NFKBIA","ATP6V0E1","MYCBP2","TMEM17","ZNF652; PHB; EIF4EP2","TMEM17","ACACA","FKBP5","ZNF689","AKAP13","CRYBG1","TRRAP","LMO3","SORD","RPL9; LIAS; UGDH; AC021148.3; SMIM14","ARID5B","CTNNBL1","PPIF","SYBU","AC104825.1; ACOX3; TRMT44","","PACSIN1; SPDEF; ILRUN; AL451165.2","","CRAMP1; IFT140; JPT2; AL031009.1; MAPK8IP3","CAPZB; MICOS10","","","PEX10","FKBP5","IGSF8; PEA15; DCAF8","MKNK1; MOB3C; ATPAF1; EFCAB14","WWC1","TAX1BP1; JAZF1","VIPR1; VIPR1-AS1; SEC22C; SS18L2; NKTR; AC006059.1","SPRED1","PRLR","ARHGEF37","NR4A1; ATG101; KRT80","MYCBP2","PRKAA2","FLNB; FLNB-AS1; ABHD6","MPC2; DCAF6","C12orf49","SPATA13","TEX2","PDZD2","KAT6B","","KIAA0232; TBC1D14; CCDC96; TADA2B","","VSTM2L; TTI1; RPRD1B","","","FOXP2","TTC21A; WDR48; GORASP1; CSRNP1; AC092053.4","PDZD2; GOLPH3; MTMR12","EHF","RNF215","KLHL15; EIF2S3; ZFX","","","PACSIN1; SPDEF; ILRUN; AL451165.2","","","DEPTOR","","SCIN; ARL4A","NF1","CD9; PLEKHG6; TNFRSF1A; SCNN1A","","","WWC2","","","UBE2Q2; FBXO22","MTCL1; RAB12","BLOC1S6; SQOR","RAD51B","","SASH1","","NRP1","","","RNF215","KCNE4","ANG","","ANO2","FKBP5","ATP6V0D1; ZDHHC1; HSD11B2; AC009061.2; RIPOR1; CTCF","MCCC2","CRAT","","RCL1","GCLC","","","CNNM1; GOT1; AL391684.1","","VWA8","PARD6B; BCAS4; ADNP; ADNP-AS1; DPM1","ELMO1","FGGY","","NUFIP1","SPIRE1","","STAG2","SLITRK6","","PRLR","","","SYBU","","ATP6AP2","NSUN2; SRD5A1","RYBP","PRKAB2; PDIA3P1; FMO5","CAPZB; MICOS10","LRBA"]},"columns":[{"id":"Range","name":"Range","type":"character","cell":["chr17: 78041721-78043440","chr17: 71856881-71857760","chr1: 146580761-146582200","chr17: 35629961-35634440","chr2: 120095721-120096040","chr11: 34692601-34693920","chr19: 3429801-3431400","chr1: 184601161-184603080","chr18: 60167721-60168960","chr12: 64983521-64984000","chr17: 56007561-56010320","chr5: 148980801-148981240","chr10: 79256561-79258880","chr1: 179840481-179841960","chr8: 133910721-133911320","chr14: 81054001-81054480","chr4: 24805601-24807680","chr17: 35674641-35674960","chr14: 97126721-97128840","chr17: 35678481-35679160","chr16: 16135401-16135840","chr5: 36285521-36286080","chr4: 70261401-70262040","chr8: 50996721-50999080","chr17: 35672201-35672600","chr19: 4989481-4993480","chr4: 8353881-8354680","chr12: 102009481-102009960","chr17: 71856041-71856800","chr22: 24364241-24364680","chr9: 33430321-33432640","chr4: 70073601-70074040","chr14: 35848001-35848400","chr17: 35675121-35675480","chr18: 55952361-55953040","chr19: 46246121-46247320","chr1: 36705721-36706200","chr6: 6748481-6749320","chr19: 41360561-41363680","chr1: 20359241-20359720","chr18: 12589121-12589760","chr1: 163586921-163587360","chr5: 148980201-148980640","chr1: 109370361-109372240","chr6: 35569961-35570440","chr9: 33436601-33438360","chr18: 20066041-20066600","chr12: 46639921-46640680","chr12: 15427121-15427560","chr5: 32093681-32094200","chr12: 64984401-64984680","chr5: 93697241-93697480","chr2: 227604081-227604240","chr9: 98045681-98046400","chr10: 102179921-102180360","chr17: 35679481-35679800","chr15: 86080641-86081560","chr1: 19752401-19753800","chr4: 106831121-106831960","chr5: 71009761-71010920","chr4: 41079161-41079640","chrX: 44750481-44752080","chr5: 36286281-36286760","chr10: 43689201-43690920","chr17: 71212001-71213000","chr10: 74008081-74008880","chr12: 57672641-57673240","chr6: 3669521-3670280","chr8: 8264001-8264240","chr8: 63570721-63571240","chr18: 56216761-56217040","chr22: 30804281-30804920","chr1: 60234841-60235360","chr17: 47470801-47473680","chr4: 41080081-41081240","chr15: 61681681-61681880","chr5: 148993921-148994400","chr13: 77665521-77665960","chr14: 35849041-35849240","chr5: 172437521-172439440","chr13: 77880921-77881640","chr2: 62652641-62652840","chr17: 47465881-47470640","chr2: 62651721-62651920","chr17: 35672841-35673120","chr6: 35694721-35696480","chr16: 30626361-30627200","chr15: 86079801-86079920","chr6: 106878841-106879160","chr7: 98621881-98622240","chr12: 16626561-16626840","chr15: 45329561-45330200","chr4: 39546001-39546440","chr10: 63858721-63859200","chr20: 36474001-36475880","chr10: 81101561-81102080","chr8: 110592561-110593440","chr4: 8353041-8353640","chr2: 216700721-216701080","chr6: 34565321-34567600","chr16: 34751201-34751680","chr16: 1679921-1681880","chr1: 19784801-19785560","chr1: 118282961-118283320","chr8: 68723161-68723680","chr1: 2341561-2342280","chr6: 35693961-35694080","chr1: 160126441-160127160","chr1: 47108121-47110240","chr5: 167710481-167710960","chr7: 27975721-27976080","chr3: 42585601-42587360","chr15: 38508481-38509080","chr5: 35205201-35205680","chr5: 148993201-148993800","chr12: 52518961-52521000","chr13: 77880281-77880840","chr1: 57254041-57254800","chr3: 58135361-58136120","chr1: 167880761-167881120","chr12: 117073961-117075400","chr13: 24775721-24776400","chr17: 62300401-62300600","chr5: 32094521-32095720","chr10: 76706241-76709240","chr8: 63570201-63570440","chr4: 6956761-6960120","chr2: 67742521-67743400","chr20: 36618201-36618800","chr9: 110802921-110803960","chr7: 95178841-95180400","chr7: 113656441-113657040","chr3: 39171481-39173080","chr5: 32145801-32146240","chr11: 34771361-34771960","chr22: 30789361-30790040","chrX: 24109081-24109880","chr4: 70105201-70105520","chr7: 66935201-66935360","chr6: 34570921-34571520","chr13: 34909481-34909760","chr3: 181019441-181020160","chr8: 120989361-120989760","chr14: 33463521-33464240","chr7: 12755201-12755400","chr17: 29381561-29381960","chr12: 6375481-6376440","chr21: 16958561-16959200","chr2: 220711441-220712280","chr4: 184181921-184182440","chr1: 242309841-242310680","chr10: 120116521-120116840","chr15: 76155361-76156360","chr18: 8703681-8706960","chr15: 45976921-45977800","chr14: 69016641-69017120","chr7: 134536761-134538400","chr6: 148579241-148580160","chr1: 242310801-242311640","chr10: 33529841-33530560","chr9: 121788641-121789320","chr3: 187068841-187069240","chr22: 30788321-30789040","chr2: 224094881-224095080","chr14: 21242841-21243440","chr5: 148398081-148398760","chr12: 6129681-6130240","chr6: 35569081-35569400","chr16: 67492721-67497800","chr5: 71011001-71012040","chr9: 131868961-131869600","chr2: 220710841-220711200","chr9: 4865361-4866280","chr6: 53333001-53334040","chr14: 24305161-24306960","chr16: 34757841-34758400","chr10: 101097641-101099680","chr15: 85874761-85874960","chr13: 42354361-42356440","chr20: 49458881-49460000","chr7: 36824521-36825400","chr1: 60234201-60234520","chr6: 6749441-6750840","chr13: 45427961-45428920","chr18: 12589881-12590200","chr17: 69906601-69907280","chrX: 123124201-123124320","chr13: 86298201-86299320","chr1: 163595801-163596560","chr5: 35206081-35206640","chr3: 177803001-177803760","chr9: 111471001-111474040","chr8: 110583201-110583400","chr21: 30014281-30015080","chrX: 40376561-40379160","chr5: 6585641-6585760","chr3: 72347081-72347600","chr1: 146584881-146587360","chr1: 19785801-19786400","chr4: 151644321-151645240"],"minWidth":120},{"id":"Width (bp)","name":"Width (bp)","type":"numeric","maxWidth":60,"style":[{"background":"#269C93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#139893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#209B93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#63A993","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#079693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#1D9A93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#239C93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#2A9D93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#1B9A93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#3DA193","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#099693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#339F93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#209B93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0D9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#2E9E93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#079693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#2F9E93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0F9893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#099693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0C9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0E9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#349F93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#089693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#59A693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#119893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#099693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#339F93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#099693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#089693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#089693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0F9893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#1A9A93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#129893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#45A393","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0E9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#099693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#099693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#299D93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#279C93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0C9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#099693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0B9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#069693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#059693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#039593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#099693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#079693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#149993","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#1F9B93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#129893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#199A93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#239C93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#269C93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#169993","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#119893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0D9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#059693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0B9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#069693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0E9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0B9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#40A193","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#199A93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#049593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#099693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#049593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#2A9D93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#049593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#67AA94","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#049593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#069693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#279C93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#129893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#029593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#079693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#089693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#069693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0E9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#099693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#299D93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0B9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#139893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0D9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#089693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#329F93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#2B9D93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#089693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0B9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#029593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#2F9E93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#089693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#279C93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0D9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0D9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#2D9E93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0C9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#089693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#209B93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0F9893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#049593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#1A9A93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#42A293","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#059693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#4AA493","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#139893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0D9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#179993","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#229C93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0D9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#239C93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#099693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0D9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0F9893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#119893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#079693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#039593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0D9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#069693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#089693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#049593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#089693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#159993","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0E9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#129893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0B9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#129893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#079693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#169993","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#49A393","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#139893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0A9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#249C93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#149993","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#129893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0F9893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#089693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#049593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0D9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0F9893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0C9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#079693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#6BAB95","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#179993","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0E9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#089693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#149993","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#179993","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#289D93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0C9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#2D9E93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#049593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#2E9E93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#189A93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#139893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#079693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#1F9B93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#159993","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#079693","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0F9893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#029593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#189A93","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0C9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#109893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#43A293","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#049593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#119893","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#39A093","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#029593","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0B9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#37A093","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#0D9793","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"background":"#149993","borderRight":"1px solid rgba(0, 0, 0, 0.1)"}]},{"id":"AveExpr","name":"AveExpr","type":"numeric","cell":["0.8","1.44","1.16","1.82","-0.39","1.14","1.62","2.51","0.79","0.54","1.9","0.46","1.31","0.83","0.77","-0.02","2.31","-0.24","1.92","0.4","0.02","0.59","0.55","1.29","0.16","1.91","1.12","0.64","0.58","0.13","1.45","0.12","-0.09","0.03","0.9","1.83","0.34","0.95","1.87","0.08","0.69","0.99","0.34","0.97","0.13","0.69","0.64","0.64","0.41","0.65","-0.02","-0.03","-0.29","0.58","0.2","-0.25","0.67","1.71","0.42","2.14","0.44","1.02","0.43","0.85","0.78","0.76","-0.27","0.73","-0.13","-0.07","0.27","0.45","0.49","3","0.42","-0.17","0.15","0.28","-0.29","1.53","0.65","-0.18","3.9","0.25","-0.02","1.43","1","-0.09","-0.01","0.26","-0.03","0.46","0.19","0.19","2.05","0.53","1.67","0.59","0.11","1.61","0.53","1.36","0.97","0.57","0.62","0.59","-0.34","1.55","2.01","0.35","0.02","1.44","0.53","0.12","0.62","1.33","0.71","1.04","0.83","0.46","0.92","0.4","0.23","1.04","1.55","-0.21","1.59","1.54","0.65","0.36","1.34","0.4","1.23","-0.03","0.63","0.44","1.23","0.09","-0.13","0.5","-0.01","0.7","0.33","0.51","-0.04","0.34","0.94","0.67","0.9","0.51","1.2","0.21","0.87","3.25","0.78","0.32","1.15","1.63","1.67","0.72","0.32","0.32","0.82","-0.2","0.71","0.53","0.9","0.14","2.91","1.81","1.05","0.1","0.46","0.89","2.09","1.13","1.61","-0.06","1.24","1.58","1.33","-0.09","1.26","1.07","-0.13","0.72","-0.12","1.25","1.29","0.67","0.82","2.48","-0.06","1.45","2.12","-0.16","0.37","2.21","0.91","0.94"],"maxWidth":66,"style":[{"background":"#91B7A0"},{"background":"#BCCCB2"},{"background":"#ABC3AA"},{"background":"#D3D9BD"},{"background":"#009593"},{"background":"#AAC2A9"},{"background":"#C7D2B8"},{"background":"#EADEBF"},{"background":"#91B7A0"},{"background":"#7AB099"},{"background":"#D8DBBF"},{"background":"#73AE97"},{"background":"#B4C7AE"},{"background":"#94B8A0"},{"background":"#8EB69F"},{"background":"#36A093"},{"background":"#EEE7C7"},{"background":"#179993"},{"background":"#D9DCBF"},{"background":"#6DAC96"},{"background":"#3CA193"},{"background":"#7EB19A"},{"background":"#7BB09A"},{"background":"#B3C7AE"},{"background":"#51A593"},{"background":"#D8DBBF"},{"background":"#A9C1A9"},{"background":"#83B39C"},{"background":"#7DB19A"},{"background":"#4CA493"},{"background":"#BDCCB3"},{"background":"#4BA493"},{"background":"#2C9E93"},{"background":"#3DA193"},{"background":"#9ABAA2"},{"background":"#D4D9BD"},{"background":"#68AA94"},{"background":"#9FBCA4"},{"background":"#D6DABE"},{"background":"#46A393"},{"background":"#88B49D"},{"background":"#A1BDA5"},{"background":"#68AA94"},{"background":"#A0BCA4"},{"background":"#4CA493"},{"background":"#88B49D"},{"background":"#83B39C"},{"background":"#83B39C"},{"background":"#6EAC96"},{"background":"#84B39C"},{"background":"#369F93"},{"background":"#349F93"},{"background":"#0E9793"},{"background":"#7DB19A"},{"background":"#58A693"},{"background":"#159993"},{"background":"#85B49C"},{"background":"#CCD5BA"},{"background":"#6FAD96"},{"background":"#E6E4C5"},{"background":"#71AD97"},{"background":"#A3BEA6"},{"background":"#70AD96"},{"background":"#96B9A1"},{"background":"#8FB79F"},{"background":"#8DB69F"},{"background":"#129893"},{"background":"#8BB59E"},{"background":"#279C93"},{"background":"#2F9E93"},{"background":"#61A893"},{"background":"#72AD97"},{"background":"#75AE98"},{"background":"#E0C8AB"},{"background":"#6FAC96"},{"background":"#219B93"},{"background":"#50A593"},{"background":"#63A993"},{"background":"#0E9793"},{"background":"#C1CFB5"},{"background":"#84B39C"},{"background":"#1F9B93"},{"background":"#D79B87"},{"background":"#5EA893"},{"background":"#37A093"},{"background":"#BBCBB2"},{"background":"#A2BDA5"},{"background":"#2C9D93"},{"background":"#38A093"},{"background":"#60A893"},{"background":"#369F93"},{"background":"#73AE97"},{"background":"#56A693"},{"background":"#56A693"},{"background":"#E0E0C3"},{"background":"#79B099"},{"background":"#CAD3B9"},{"background":"#7FB19A"},{"background":"#4AA493"},{"background":"#C6D1B7"},{"background":"#79B099"},{"background":"#B7C9B0"},{"background":"#A0BCA4"},{"background":"#7DB19A"},{"background":"#81B29B"},{"background":"#7EB19A"},{"background":"#089693"},{"background":"#C2CFB5"},{"background":"#DEDFC2"},{"background":"#69AA94"},{"background":"#3DA193"},{"background":"#BCCCB2"},{"background":"#7AB099"},{"background":"#4BA493"},{"background":"#81B29B"},{"background":"#B5C8AF"},{"background":"#8AB59E"},{"background":"#A4BFA6"},{"background":"#94B8A1"},{"background":"#73AE97"},{"background":"#9CBBA3"},{"background":"#6DAC96"},{"background":"#5BA793"},{"background":"#A4BFA6"},{"background":"#C3CFB6"},{"background":"#1A9A93"},{"background":"#C5D1B7"},{"background":"#C2CFB5"},{"background":"#84B39C"},{"background":"#6AAB95"},{"background":"#B6C9AF"},{"background":"#6DAC96"},{"background":"#B0C5AC"},{"background":"#359F93"},{"background":"#82B29B"},{"background":"#71AD97"},{"background":"#B0C5AC"},{"background":"#47A393"},{"background":"#269C93"},{"background":"#76AF98"},{"background":"#38A093"},{"background":"#88B49D"},{"background":"#67AA94"},{"background":"#77AF98"},{"background":"#339F93"},{"background":"#68AA94"},{"background":"#9EBBA3"},{"background":"#86B49D"},{"background":"#9ABAA2"},{"background":"#77AF98"},{"background":"#ADC4AB"},{"background":"#59A693"},{"background":"#97B9A1"},{"background":"#DDBCA0"},{"background":"#90B79F"},{"background":"#66AA93"},{"background":"#ABC2AA"},{"background":"#C8D2B8"},{"background":"#CAD3B9"},{"background":"#8AB59E"},{"background":"#66AA93"},{"background":"#66AA94"},{"background":"#93B8A0"},{"background":"#1B9A93"},{"background":"#89B59E"},{"background":"#79B099"},{"background":"#9ABAA2"},{"background":"#4EA493"},{"background":"#E1CCAE"},{"background":"#D2D8BC"},{"background":"#A4BFA6"},{"background":"#48A393"},{"background":"#73AE97"},{"background":"#99BAA2"},{"background":"#E3E2C4"},{"background":"#AAC2A9"},{"background":"#C6D1B7"},{"background":"#319E93"},{"background":"#B0C5AC"},{"background":"#C4D0B6"},{"background":"#B5C8AF"},{"background":"#2D9E93"},{"background":"#B1C6AD"},{"background":"#A6C0A7"},{"background":"#269C93"},{"background":"#8AB59E"},{"background":"#289D93"},{"background":"#B0C5AC"},{"background":"#B3C7AE"},{"background":"#86B49C"},{"background":"#93B8A0"},{"background":"#EAE0C0"},{"background":"#309E93"},{"background":"#BDCCB3"},{"background":"#E4E3C4"},{"background":"#229B93"},{"background":"#6BAB95"},{"background":"#EAE6C7"},{"background":"#9CBBA3"},{"background":"#9EBBA3"}]},{"id":"logFC","name":"logFC","type":"numeric","cell":["2.8","2.15","2.16","1.65","3.12","1.96","1.69","1.27","2.1","2.15","1.45","2.12","1.61","1.9","1.9","2.37","1.19","2.47","1.32","2","2.23","1.86","1.85","1.55","2.08","1.26","1.53","1.77","1.74","2.25","1.4","2.04","2.12","2.03","1.54","1.23","1.82","1.51","1.21","1.93","1.61","1.53","1.76","1.46","1.88","1.62","1.59","1.6","1.71","1.6","1.94","1.93","2.1","1.59","1.84","2.08","1.54","1.2","1.63","1.1","1.62","1.36","1.6","1.42","1.5","1.46","2.32","1.48","1.86","1.83","1.62","1.57","1.52","0.8","1.56","1.86","1.66","1.61","2.26","1.13","1.51","2.19","0.6","1.89","1.72","1.15","1.28","2.07","1.69","1.55","1.71","1.45","1.6","1.56","0.96","1.45","1.08","1.4","1.58","1.09","1.43","1.16","1.24","1.37","1.34","1.34","2.16","1.07","0.95","1.43","1.61","1.12","1.36","1.54","1.31","1.13","1.28","1.21","1.25","1.38","1.21","1.38","1.78","1.19","1.03","1.71","1.03","1.01","1.25","1.41","1.11","1.36","1.1","1.51","1.28","1.59","1.09","1.44","1.55","1.28","1.49","1.23","1.33","1.25","1.49","1.34","1.13","1.24","1.17","1.24","1.04","1.41","1.12","0.61","1.22","1.28","1.05","0.94","0.91","1.14","1.27","1.27","1.14","1.47","1.15","1.23","1.07","1.3","0.68","0.9","1.03","1.39","1.23","1.13","0.8","1.03","0.89","1.39","1.01","0.92","0.95","1.38","0.96","1.03","1.79","1.09","1.76","1.01","0.99","1.14","1.05","0.72","1.34","0.93","0.81","1.39","1.17","0.76","1.02","1.01"],"maxWidth":66,"style":[{"background":"#CF1A36"},{"background":"#DA4F65"},{"background":"#DA4E64"},{"background":"#E37889"},{"background":"#CA0020"},{"background":"#DD5E73"},{"background":"#E27486"},{"background":"#E997A4"},{"background":"#DB5368"},{"background":"#DA4F65"},{"background":"#E68897"},{"background":"#DB5267"},{"background":"#E37B8B"},{"background":"#DE6377"},{"background":"#DE6477"},{"background":"#D63D55"},{"background":"#EA9EAA"},{"background":"#D5354E"},{"background":"#E892A0"},{"background":"#DD5B70"},{"background":"#D9485F"},{"background":"#DF6679"},{"background":"#DF687B"},{"background":"#E48090"},{"background":"#DB556A"},{"background":"#E998A5"},{"background":"#E58291"},{"background":"#E06E80"},{"background":"#E17183"},{"background":"#D8475E"},{"background":"#E78C9B"},{"background":"#DC586D"},{"background":"#DB5267"},{"background":"#DC586D"},{"background":"#E48190"},{"background":"#EA9AA7"},{"background":"#E06A7C"},{"background":"#E58393"},{"background":"#EA9CA8"},{"background":"#DE6175"},{"background":"#E37B8C"},{"background":"#E58291"},{"background":"#E16F81"},{"background":"#E68796"},{"background":"#DF6578"},{"background":"#E37B8B"},{"background":"#E37C8D"},{"background":"#E37C8C"},{"background":"#E27385"},{"background":"#E37C8D"},{"background":"#DE6074"},{"background":"#DE6175"},{"background":"#DB5369"},{"background":"#E47D8D"},{"background":"#DF687B"},{"background":"#DB556A"},{"background":"#E48190"},{"background":"#EA9CA9"},{"background":"#E37A8A"},{"background":"#ECA5B0"},{"background":"#E37A8B"},{"background":"#E78F9D"},{"background":"#E37C8C"},{"background":"#E68A99"},{"background":"#E58494"},{"background":"#E68796"},{"background":"#D74259"},{"background":"#E58695"},{"background":"#DF677A"},{"background":"#DF697C"},{"background":"#E37B8B"},{"background":"#E47E8E"},{"background":"#E58292"},{"background":"#F1BDC5"},{"background":"#E47F8F"},{"background":"#DF677A"},{"background":"#E27788"},{"background":"#E37B8B"},{"background":"#D8465D"},{"background":"#EBA2AE"},{"background":"#E58392"},{"background":"#D94C62"},{"background":"#F4CED4"},{"background":"#DF6578"},{"background":"#E17284"},{"background":"#EBA1AD"},{"background":"#E996A3"},{"background":"#DB566B"},{"background":"#E27586"},{"background":"#E48090"},{"background":"#E17384"},{"background":"#E68897"},{"background":"#E37C8D"},{"background":"#E47F8F"},{"background":"#EEB0BA"},{"background":"#E68997"},{"background":"#ECA7B2"},{"background":"#E78C9A"},{"background":"#E47E8E"},{"background":"#ECA6B1"},{"background":"#E68A98"},{"background":"#EBA0AC"},{"background":"#EA9AA6"},{"background":"#E78E9C"},{"background":"#E8919F"},{"background":"#E8919F"},{"background":"#DA4E64"},{"background":"#ECA7B2"},{"background":"#EEB1BA"},{"background":"#E68A99"},{"background":"#E37B8B"},{"background":"#EBA3AE"},{"background":"#E7909E"},{"background":"#E48191"},{"background":"#E893A1"},{"background":"#EBA3AE"},{"background":"#E996A3"},{"background":"#EA9CA8"},{"background":"#E998A5"},{"background":"#E78E9C"},{"background":"#EA9CA8"},{"background":"#E78E9C"},{"background":"#E06E80"},{"background":"#EA9EAA"},{"background":"#EDABB5"},{"background":"#E27385"},{"background":"#EDAAB5"},{"background":"#EDACB6"},{"background":"#E998A5"},{"background":"#E78C9A"},{"background":"#ECA4B0"},{"background":"#E78F9D"},{"background":"#ECA5B0"},{"background":"#E58393"},{"background":"#E996A3"},{"background":"#E47D8D"},{"background":"#ECA6B1"},{"background":"#E68997"},{"background":"#E48090"},{"background":"#E996A3"},{"background":"#E58594"},{"background":"#EA9BA7"},{"background":"#E892A0"},{"background":"#E998A5"},{"background":"#E58594"},{"background":"#E8919F"},{"background":"#EBA2AE"},{"background":"#E999A6"},{"background":"#EB9FAB"},{"background":"#E999A6"},{"background":"#EDAAB4"},{"background":"#E78B9A"},{"background":"#ECA3AF"},{"background":"#F4CCD3"},{"background":"#EA9BA8"},{"background":"#E996A3"},{"background":"#EDA9B4"},{"background":"#EFB2BC"},{"background":"#EFB4BD"},{"background":"#EBA1AD"},{"background":"#E996A4"},{"background":"#E997A4"},{"background":"#EBA1AD"},{"background":"#E68695"},{"background":"#EBA1AC"},{"background":"#EA9AA7"},{"background":"#ECA7B2"},{"background":"#E894A1"},{"background":"#F3C7CE"},{"background":"#EFB5BE"},{"background":"#EDAAB5"},{"background":"#E78D9B"},{"background":"#EA9AA7"},{"background":"#EBA3AE"},{"background":"#F1BDC5"},{"background":"#EDABB5"},{"background":"#EFB5BF"},{"background":"#E78D9B"},{"background":"#EDACB7"},{"background":"#EFB4BD"},{"background":"#EEB1BA"},{"background":"#E78E9C"},{"background":"#EEB0BA"},{"background":"#EDABB5"},{"background":"#E06C7E"},{"background":"#ECA6B1"},{"background":"#E16F81"},{"background":"#EDACB7"},{"background":"#EEAEB8"},{"background":"#EBA1AD"},{"background":"#EDA9B3"},{"background":"#F2C4CB"},{"background":"#E8919F"},{"background":"#EFB3BC"},{"background":"#F1BDC5"},{"background":"#E78D9B"},{"background":"#EB9FAB"},{"background":"#F2C1C9"},{"background":"#EDABB6"},{"background":"#EDACB7"}]},{"id":"FDR","name":"FDR","type":"numeric","cell":["1.84e-16","3.32e-14","2.29e-12","8.82e-11","2.16e-10","2.42e-10","2.42e-10","6.21e-10","6.59e-10","1.49e-09","2.23e-09","8.90e-09","2.19e-08","2.39e-08","2.39e-08","5.55e-08","7.27e-08","1.25e-07","1.44e-07","1.44e-07","1.83e-07","2.46e-07","3.20e-07","3.24e-07","3.51e-07","8.51e-07","8.85e-07","1.35e-06","1.44e-06","1.89e-06","2.33e-06","2.62e-06","2.62e-06","2.62e-06","4.01e-06","4.01e-06","4.04e-06","4.04e-06","4.04e-06","4.50e-06","4.62e-06","4.83e-06","5.94e-06","7.49e-06","7.82e-06","7.82e-06","7.82e-06","1.08e-05","1.08e-05","1.09e-05","1.09e-05","1.10e-05","1.13e-05","1.22e-05","1.24e-05","1.59e-05","1.63e-05","2.01e-05","2.90e-05","2.90e-05","3.09e-05","3.27e-05","3.46e-05","3.48e-05","3.88e-05","4.08e-05","4.08e-05","4.35e-05","5.70e-05","5.72e-05","7.92e-05","7.92e-05","8.49e-05","8.59e-05","8.74e-05","9.30e-05","1.02e-04","1.04e-04","1.10e-04","1.11e-04","1.14e-04","1.17e-04","1.48e-04","1.48e-04","1.70e-04","1.80e-04","1.86e-04","1.90e-04","2.08e-04","2.30e-04","2.30e-04","2.30e-04","2.31e-04","2.32e-04","2.38e-04","2.73e-04","2.96e-04","3.38e-04","3.51e-04","3.51e-04","3.51e-04","3.82e-04","4.17e-04","4.17e-04","4.28e-04","4.63e-04","4.66e-04","4.83e-04","5.00e-04","5.00e-04","5.33e-04","5.43e-04","5.54e-04","5.56e-04","5.84e-04","5.84e-04","5.95e-04","6.09e-04","6.11e-04","6.35e-04","6.58e-04","6.73e-04","7.27e-04","7.47e-04","7.93e-04","9.71e-04","1.06e-03","1.13e-03","1.19e-03","1.39e-03","1.46e-03","1.49e-03","1.54e-03","1.57e-03","1.58e-03","1.58e-03","1.61e-03","1.72e-03","1.75e-03","1.76e-03","1.93e-03","1.97e-03","1.98e-03","2.06e-03","2.12e-03","2.12e-03","2.17e-03","2.25e-03","2.44e-03","2.46e-03","2.69e-03","2.69e-03","3.26e-03","3.49e-03","3.51e-03","3.59e-03","3.79e-03","3.87e-03","4.12e-03","4.12e-03","4.62e-03","4.73e-03","4.73e-03","4.75e-03","4.75e-03","5.06e-03","5.06e-03","5.48e-03","5.59e-03","5.79e-03","5.79e-03","5.80e-03","5.97e-03","6.04e-03","6.25e-03","6.25e-03","6.28e-03","6.35e-03","6.52e-03","6.52e-03","6.67e-03","6.91e-03","7.16e-03","7.20e-03","7.52e-03","7.70e-03","7.74e-03","8.25e-03","8.30e-03","8.45e-03","8.50e-03","8.52e-03","8.54e-03","8.54e-03","8.67e-03","8.70e-03","8.82e-03","8.84e-03","9.00e-03","9.11e-03"],"maxWidth":66,"style":{"borderRight":"1px solid rgba(0, 0, 0, 0.1)"}},{"id":"Macs2 Peak","name":"Macs2 Peak","type":"logical","cell":["✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes"],"maxWidth":60,"style":[{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"},{"color":"#008000","borderRight":"1px solid rgba(0, 0, 0, 0.1)"}]},{"id":"Region","name":"Region","type":"factor","maxWidth":150},{"id":"Feature","name":"Feature","type":"factor"},{"id":"Genes","name":"Genes","type":"character","cell":[{"name":"span","attribs":{"title":"CCDC40"},"children":["CCDC40"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"PRKAB2; PDIA3P1; FMO5"},"children":["PRKAB2; PDIA3P1; FMO5"]},{"name":"span","attribs":{"title":"ACACA"},"children":["ACACA"]},{"name":"span","attribs":{"title":"C2orf76"},"children":["C2orf76"]},{"name":"span","attribs":{"title":"EHF"},"children":["EHF"]},{"name":"span","attribs":{"title":"NFIC"},"children":["NFIC"]},{"name":"span","attribs":{"title":"C1orf21; EDEM3"},"children":["C1orf21; EDEM3"]},{"name":"span","attribs":{"title":"ZCCHC2"},"children":["ZCCHC2"]},{"name":"span","attribs":{"title":"RASSF3"},"children":["RASSF3"]},{"name":"span","attribs":{"title":"MRPS23; CUEDC1; VEZF1; AC015813.1; SRSF1; AC015813.5"},"children":["MRPS23; CUEDC1; VEZF1; AC01..."]},{"name":"span","attribs":{"title":"CSNK1A1; AC021078.1; ARHGEF37"},"children":["CSNK1A1; AC021078.1; ARHGEF37"]},{"name":"span","attribs":{"title":"KCNMA1"},"children":["KCNMA1"]},{"name":"span","attribs":{"title":"TOR1AIP2; TOR1AIP1; CEP350"},"children":["TOR1AIP2; TOR1AIP1; CEP350"]},{"name":"span","attribs":{"title":"PHF20L1"},"children":["PHF20L1"]},{"name":"span","attribs":{"title":"CEP128"},"children":["CEP128"]},{"name":"span","attribs":{"title":"CCDC149"},"children":["CCDC149"]},{"name":"span","attribs":{"title":"ACACA"},"children":["ACACA"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"ACACA"},"children":["ACACA"]},{"name":"span","attribs":{"title":"ABCC1"},"children":["ABCC1"]},{"name":"span","attribs":{"title":"RANBP3L"},"children":["RANBP3L"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"ACACA"},"children":["ACACA"]},{"name":"span","attribs":{"title":"UHRF1; KDM4B"},"children":["UHRF1; KDM4B"]},{"name":"span","attribs":{"title":"AC104825.1; ACOX3; TRMT44"},"children":["AC104825.1; ACOX3; TRMT44"]},{"name":"span","attribs":{"title":"CHPT1"},"children":["CHPT1"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"DDT"},"children":["DDT"]},{"name":"span","attribs":{"title":"NFX1; AQP3; NOL6; ANKRD18B"},"children":["NFX1; AQP3; NOL6; ANKRD18B"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"NFKBIA"},"children":["NFKBIA"]},{"name":"span","attribs":{"title":"ACACA"},"children":["ACACA"]},{"name":"span","attribs":{"title":"NEDD4L"},"children":["NEDD4L"]},{"name":"span","attribs":{"title":"GIPR; QPCTL; EML2; SNRPD2; FBXO46; AC007191.1; SIX5; DMPK; DMWD; SYMPK"},"children":["GIPR; QPCTL; EML2; SNRPD2; ..."]},{"name":"span","attribs":{"title":"THRAP3"},"children":["THRAP3"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"EGLN2"},"children":["EGLN2"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"SPIRE1"},"children":["SPIRE1"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"CSNK1A1; AC021078.1; ARHGEF37"},"children":["CSNK1A1; AC021078.1; ARHGEF37"]},{"name":"span","attribs":{"title":"STXBP3"},"children":["STXBP3"]},{"name":"span","attribs":{"title":"FKBP5"},"children":["FKBP5"]},{"name":"span","attribs":{"title":"AQP3"},"children":["AQP3"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"SLC38A1"},"children":["SLC38A1"]},{"name":"span","attribs":{"title":"RERG"},"children":["RERG"]},{"name":"span","attribs":{"title":"PDZD2"},"children":["PDZD2"]},{"name":"span","attribs":{"title":"RASSF3"},"children":["RASSF3"]},{"name":"span","attribs":{"title":"KIAA0825"},"children":["KIAA0825"]},{"name":"span","attribs":{"title":"IRS1; AC010735.2; RHBDD1"},"children":["IRS1; AC010735.2; RHBDD1"]},{"name":"span","attribs":{"title":"FANCC"},"children":["FANCC"]},{"name":"span","attribs":{"title":"SCD; OLMALINC"},"children":["SCD; OLMALINC"]},{"name":"span","attribs":{"title":"ACACA"},"children":["ACACA"]},{"name":"span","attribs":{"title":"AKAP13"},"children":["AKAP13"]},{"name":"span","attribs":{"title":"SLC66A1; CAPZB; MICOS10"},"children":["SLC66A1; CAPZB; MICOS10"]},{"name":"span","attribs":{"title":"NPNT"},"children":["NPNT"]},{"name":"span","attribs":{"title":"MCCC2"},"children":["MCCC2"]},{"name":"span","attribs":{"title":"APBB2"},"children":["APBB2"]},{"name":"span","attribs":{"title":"KDM6A"},"children":["KDM6A"]},{"name":"span","attribs":{"title":"RANBP3L"},"children":["RANBP3L"]},{"name":"span","attribs":{"title":"RASGEF1A"},"children":["RASGEF1A"]},{"name":"span","attribs":{"title":"FAM104A"},"children":["FAM104A"]},{"name":"span","attribs":{"title":"ANAPC16"},"children":["ANAPC16"]},{"name":"span","attribs":{"title":"R3HDM2"},"children":["R3HDM2"]},{"name":"span","attribs":{"title":"AL033523.1; PXDC1"},"children":["AL033523.1; PXDC1"]},{"name":"span","attribs":{"title":"PRAG1"},"children":["PRAG1"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"RNF215; SEC14L2"},"children":["RNF215; SEC14L2"]},{"name":"span","attribs":{"title":"FGGY"},"children":["FGGY"]},{"name":"span","attribs":{"title":"PHB"},"children":["PHB"]},{"name":"span","attribs":{"title":"APBB2"},"children":["APBB2"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"ARHGEF37"},"children":["ARHGEF37"]},{"name":"span","attribs":{"title":"MYCBP2"},"children":["MYCBP2"]},{"name":"span","attribs":{"title":"NFKBIA"},"children":["NFKBIA"]},{"name":"span","attribs":{"title":"ATP6V0E1"},"children":["ATP6V0E1"]},{"name":"span","attribs":{"title":"MYCBP2"},"children":["MYCBP2"]},{"name":"span","attribs":{"title":"TMEM17"},"children":["TMEM17"]},{"name":"span","attribs":{"title":"ZNF652; PHB; EIF4EP2"},"children":["ZNF652; PHB; EIF4EP2"]},{"name":"span","attribs":{"title":"TMEM17"},"children":["TMEM17"]},{"name":"span","attribs":{"title":"ACACA"},"children":["ACACA"]},{"name":"span","attribs":{"title":"FKBP5"},"children":["FKBP5"]},{"name":"span","attribs":{"title":"ZNF689"},"children":["ZNF689"]},{"name":"span","attribs":{"title":"AKAP13"},"children":["AKAP13"]},{"name":"span","attribs":{"title":"CRYBG1"},"children":["CRYBG1"]},{"name":"span","attribs":{"title":"TRRAP"},"children":["TRRAP"]},{"name":"span","attribs":{"title":"LMO3"},"children":["LMO3"]},{"name":"span","attribs":{"title":"SORD"},"children":["SORD"]},{"name":"span","attribs":{"title":"RPL9; LIAS; UGDH; AC021148.3; SMIM14"},"children":["RPL9; LIAS; UGDH; AC021148...."]},{"name":"span","attribs":{"title":"ARID5B"},"children":["ARID5B"]},{"name":"span","attribs":{"title":"CTNNBL1"},"children":["CTNNBL1"]},{"name":"span","attribs":{"title":"PPIF"},"children":["PPIF"]},{"name":"span","attribs":{"title":"SYBU"},"children":["SYBU"]},{"name":"span","attribs":{"title":"AC104825.1; ACOX3; TRMT44"},"children":["AC104825.1; ACOX3; TRMT44"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"PACSIN1; SPDEF; ILRUN; AL451165.2"},"children":["PACSIN1; SPDEF; ILRUN; AL45..."]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"CRAMP1; IFT140; JPT2; AL031009.1; MAPK8IP3"},"children":["CRAMP1; IFT140; JPT2; AL031..."]},{"name":"span","attribs":{"title":"CAPZB; MICOS10"},"children":["CAPZB; MICOS10"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"PEX10"},"children":["PEX10"]},{"name":"span","attribs":{"title":"FKBP5"},"children":["FKBP5"]},{"name":"span","attribs":{"title":"IGSF8; PEA15; DCAF8"},"children":["IGSF8; PEA15; DCAF8"]},{"name":"span","attribs":{"title":"MKNK1; MOB3C; ATPAF1; EFCAB14"},"children":["MKNK1; MOB3C; ATPAF1; EFCAB14"]},{"name":"span","attribs":{"title":"WWC1"},"children":["WWC1"]},{"name":"span","attribs":{"title":"TAX1BP1; JAZF1"},"children":["TAX1BP1; JAZF1"]},{"name":"span","attribs":{"title":"VIPR1; VIPR1-AS1; SEC22C; SS18L2; NKTR; AC006059.1"},"children":["VIPR1; VIPR1-AS1; SEC22C; S..."]},{"name":"span","attribs":{"title":"SPRED1"},"children":["SPRED1"]},{"name":"span","attribs":{"title":"PRLR"},"children":["PRLR"]},{"name":"span","attribs":{"title":"ARHGEF37"},"children":["ARHGEF37"]},{"name":"span","attribs":{"title":"NR4A1; ATG101; KRT80"},"children":["NR4A1; ATG101; KRT80"]},{"name":"span","attribs":{"title":"MYCBP2"},"children":["MYCBP2"]},{"name":"span","attribs":{"title":"PRKAA2"},"children":["PRKAA2"]},{"name":"span","attribs":{"title":"FLNB; FLNB-AS1; ABHD6"},"children":["FLNB; FLNB-AS1; ABHD6"]},{"name":"span","attribs":{"title":"MPC2; DCAF6"},"children":["MPC2; DCAF6"]},{"name":"span","attribs":{"title":"C12orf49"},"children":["C12orf49"]},{"name":"span","attribs":{"title":"SPATA13"},"children":["SPATA13"]},{"name":"span","attribs":{"title":"TEX2"},"children":["TEX2"]},{"name":"span","attribs":{"title":"PDZD2"},"children":["PDZD2"]},{"name":"span","attribs":{"title":"KAT6B"},"children":["KAT6B"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"KIAA0232; TBC1D14; CCDC96; TADA2B"},"children":["KIAA0232; TBC1D14; CCDC96; ..."]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"VSTM2L; TTI1; RPRD1B"},"children":["VSTM2L; TTI1; RPRD1B"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"FOXP2"},"children":["FOXP2"]},{"name":"span","attribs":{"title":"TTC21A; WDR48; GORASP1; CSRNP1; AC092053.4"},"children":["TTC21A; WDR48; GORASP1; CSR..."]},{"name":"span","attribs":{"title":"PDZD2; GOLPH3; MTMR12"},"children":["PDZD2; GOLPH3; MTMR12"]},{"name":"span","attribs":{"title":"EHF"},"children":["EHF"]},{"name":"span","attribs":{"title":"RNF215"},"children":["RNF215"]},{"name":"span","attribs":{"title":"KLHL15; EIF2S3; ZFX"},"children":["KLHL15; EIF2S3; ZFX"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"PACSIN1; SPDEF; ILRUN; AL451165.2"},"children":["PACSIN1; SPDEF; ILRUN; AL45..."]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"DEPTOR"},"children":["DEPTOR"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"SCIN; ARL4A"},"children":["SCIN; ARL4A"]},{"name":"span","attribs":{"title":"NF1"},"children":["NF1"]},{"name":"span","attribs":{"title":"CD9; PLEKHG6; TNFRSF1A; SCNN1A"},"children":["CD9; PLEKHG6; TNFRSF1A; SCNN1A"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"WWC2"},"children":["WWC2"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"UBE2Q2; FBXO22"},"children":["UBE2Q2; FBXO22"]},{"name":"span","attribs":{"title":"MTCL1; RAB12"},"children":["MTCL1; RAB12"]},{"name":"span","attribs":{"title":"BLOC1S6; SQOR"},"children":["BLOC1S6; SQOR"]},{"name":"span","attribs":{"title":"RAD51B"},"children":["RAD51B"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"SASH1"},"children":["SASH1"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"NRP1"},"children":["NRP1"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"RNF215"},"children":["RNF215"]},{"name":"span","attribs":{"title":"KCNE4"},"children":["KCNE4"]},{"name":"span","attribs":{"title":"ANG"},"children":["ANG"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"ANO2"},"children":["ANO2"]},{"name":"span","attribs":{"title":"FKBP5"},"children":["FKBP5"]},{"name":"span","attribs":{"title":"ATP6V0D1; ZDHHC1; HSD11B2; AC009061.2; RIPOR1; CTCF"},"children":["ATP6V0D1; ZDHHC1; HSD11B2; ..."]},{"name":"span","attribs":{"title":"MCCC2"},"children":["MCCC2"]},{"name":"span","attribs":{"title":"CRAT"},"children":["CRAT"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"RCL1"},"children":["RCL1"]},{"name":"span","attribs":{"title":"GCLC"},"children":["GCLC"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"CNNM1; GOT1; AL391684.1"},"children":["CNNM1; GOT1; AL391684.1"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"VWA8"},"children":["VWA8"]},{"name":"span","attribs":{"title":"PARD6B; BCAS4; ADNP; ADNP-AS1; DPM1"},"children":["PARD6B; BCAS4; ADNP; ADNP-A..."]},{"name":"span","attribs":{"title":"ELMO1"},"children":["ELMO1"]},{"name":"span","attribs":{"title":"FGGY"},"children":["FGGY"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"NUFIP1"},"children":["NUFIP1"]},{"name":"span","attribs":{"title":"SPIRE1"},"children":["SPIRE1"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"STAG2"},"children":["STAG2"]},{"name":"span","attribs":{"title":"SLITRK6"},"children":["SLITRK6"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"PRLR"},"children":["PRLR"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"SYBU"},"children":["SYBU"]},{"name":"span","attribs":{"title":""},"children":[""]},{"name":"span","attribs":{"title":"ATP6AP2"},"children":["ATP6AP2"]},{"name":"span","attribs":{"title":"NSUN2; SRD5A1"},"children":["NSUN2; SRD5A1"]},{"name":"span","attribs":{"title":"RYBP"},"children":["RYBP"]},{"name":"span","attribs":{"title":"PRKAB2; PDIA3P1; FMO5"},"children":["PRKAB2; PDIA3P1; FMO5"]},{"name":"span","attribs":{"title":"CAPZB; MICOS10"},"children":["CAPZB; MICOS10"]},{"name":"span","attribs":{"title":"LRBA"},"children":["LRBA"]}],"minWidth":132}],"filterable":true,"defaultPageSize":10,"showPageSizeOptions":true,"pageSizeOptions":[10,20,50,200],"borderless":true,"theme":{"style":{"fontSize":12}},"dataKey":"5fca6ce621a24974456388fc840620b4"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
<div id="summary-plots" class="section level2 tabset">
<h2 class="tabset">Summary Plots</h2>
<pre class="r"><code>profile_width &lt;- 5e3
n_bins &lt;- 100
bwfl &lt;- file.path(macs2_path, glue(&quot;{treat_levels}_merged_treat_pileup.bw&quot;)) %&gt;% 
  BigWigFileList() %&gt;% 
  setNames(treat_levels) 
sig_ranges &lt;- merged_results %&gt;% 
  filter(!!sym(fdr_column) &lt; fdr_alpha) %&gt;% 
  colToRanges(&quot;keyval_range&quot;) %&gt;% 
  splitAsList(f = .$direction) %&gt;% 
  .[vapply(., length, integer(1)) &gt; 0] 
fc_heat &lt;- names(sig_ranges) %&gt;% 
  lapply(
    function(x) {
      glue(
        &quot;
        *Heatmap and histogram for all regions considered to show evidence of 
        {ifelse(x == &#39;Up&#39;, &#39;increased&#39;, &#39;decreased&#39;)} {target} binding in 
        response to {treat_levels[[2]]} treatment. A total of 
        {comma(length(sig_ranges[[x]]))} regions were in this group.
        &quot;,
        ifelse(
          length(sig_ranges[[x]]) &gt; 2e4, 
          &quot; Due to the large number of regions, these were randomly down-sampled to 20,000 for viable plotting.&quot;,
          &quot;&quot;
        ),
        &quot;*&quot;
      )
    }
  ) %&gt;% 
  setNames(names(sig_ranges))
sig_profiles &lt;- lapply(sig_ranges, function(x) NULL)
for (i in names(sig_profiles)) {
  ## Restrict to 20,000. Plots work poorly above this number.
  ## Randomly sample
  set.seed(threads)
  temp_gr &lt;- granges(sig_ranges[[i]])
  n &lt;- length(temp_gr)
  if (n &gt; 2e4) temp_gr &lt;- temp_gr[sort(sample.int(n, 2e4))]
  sig_profiles[[i]] &lt;- getProfileData(
    bwfl, temp_gr, upstream = profile_width / 2, bins = n_bins,
    BPPARAM = bpparam()
  )
  rm(temp_gr)
}
profile_heatmaps &lt;- sig_profiles %&gt;% 
  parallel::mclapply(
    plotProfileHeatmap,
    profileCol = &quot;profile_data&quot;, 
    colour = &quot;name&quot;,
    xLab = &quot;Distance from Centre (bp)&quot;,
    fillLab = &quot;logCPM&quot;,
    mc.cores = length(sig_profiles)
  ) 
fill_range &lt;- profile_heatmaps %&gt;% 
  lapply(function(x) x$data[,&quot;score&quot;]) %&gt;% 
  unlist() %&gt;%
  range()
sidey_range &lt;- profile_heatmaps %&gt;% 
  lapply(function(x) x$layers[[3]]$data$y) %&gt;% 
  unlist() %&gt;% 
  range()
profile_heatmaps &lt;- profile_heatmaps %&gt;% 
  lapply(
    function(x) {
      suppressWarnings(
        x + 
          scale_fill_gradientn(colours = colours$heatmaps, limits = fill_range) +
          scale_xsidey_continuous(limits = sidey_range) +
          scale_colour_manual(values = treat_colours) +
          labs(
            x = &quot;Distance from Centre (bp)&quot;,
            fill = &quot;logCPM&quot;, 
            colour = &quot;Treat&quot;
          ) +
          theme(
            strip.text.y = element_text(angle = 0)
          )
      )
    }
  )</code></pre>
<div id="ma-plot" class="section level3">
<h3>MA Plot</h3>
<pre class="r"><code>if (!&quot;Ambiguous&quot; %in% levels(merged_results$status)) 
  direction_colours &lt;- direction_colours[names(direction_colours) != &quot;Ambiguous&quot;]
merged_results %&gt;% 
  as_tibble() %&gt;%
  ggplot(aes(AveExpr, logFC)) +
  geom_point(aes(colour = status), alpha = 0.5) +
  geom_smooth(se = FALSE, method = &quot;gam&quot;, formula = y ~ s(x, bs = &quot;cs&quot;)) +
  geom_hline(yintercept = 0) +
  geom_label_repel(
    aes(y = 1.1*logFC, label = annot, colour = status),
    data= . %&gt;%
      dplyr::filter(logFC == max(logFC) | logFC == min(logFC)) %&gt;%
      mutate(
        detected = gene_name %&gt;%
          lapply(paste, collapse = &quot;, &quot;) %&gt;%
          unlist() %&gt;%
          str_replace(&quot;^NA$&quot;, &quot;&quot;) %&gt;%
          str_wrap(width = 40),
        range = ifelse(detected == &quot;&quot;, range, paste0(range, &quot;\n&quot;)),
        annot = glue(&quot;{range}{detected}&quot;)
      ),
    fill = rgb(1, 1, 1, 0.2),
    size = 3,
    show.legend = FALSE
  ) +
  scale_colour_manual(values = direction_colours) +
  labs(
    x = &quot;Ave Signal (logCPM)&quot;,
    colour = &quot;Status&quot;
  ) </code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-ma-1.png" alt="*MA plot showing the status of each window under consideration. The two most extreme regions are labelled by region and any associated genes, whilst the overall pattern of association between signal level (logCPM) and changed signal (logFC) is shown as the blue curve.*" width="960" />
<p class="caption">
<em>MA plot showing the status of each window under consideration. The
two most extreme regions are labelled by region and any associated
genes, whilst the overall pattern of association between signal level
(logCPM) and changed signal (logFC) is shown as the blue curve.</em>
</p>
</div>
</div>
<div id="volcano-plot" class="section level3">
<h3>Volcano Plot</h3>
<pre class="r"><code>merged_results %&gt;% 
  as_tibble() %&gt;% 
  ggplot(aes(logFC, -log10(P.Value))) +
  geom_point(aes(colour = status), alpha = 0.6) +
  geom_label_repel(
    aes(label = annot, colour = status),
    data= . %&gt;%
      arrange(sign(logFC)*log10(P.Value)) %&gt;% 
      dplyr::slice(1:2) %&gt;% 
      dplyr::filter(logFC &gt; 1) %&gt;%
      mutate(
        detected = gene_name %&gt;%
          lapply(paste, collapse = &quot;, &quot;) %&gt;%
          unlist() %&gt;%
          str_replace(&quot;^NA$&quot;, &quot;&quot;) %&gt;%
          str_wrap(width = 40),
        range = ifelse(detected == &quot;&quot;, range, paste0(range, &quot;\n&quot;)),
        annot = glue(&quot;{range}{detected}&quot;)
      ),
    fill = rgb(1, 1, 1, 0.2),
    size = 3,
    show.legend = FALSE
  ) +
  geom_label_repel(
    aes(label = annot, colour = status),
    data= . %&gt;%
      arrange(-sign(logFC)*log10(P.Value)) %&gt;% 
      dplyr::slice(1:2) %&gt;% 
      dplyr::filter(logFC &lt; -1) %&gt;% 
      mutate(
        detected = gene_name %&gt;%
          lapply(paste, collapse = &quot;, &quot;) %&gt;%
          unlist() %&gt;%
          str_replace(&quot;^NA$&quot;, &quot;&quot;) %&gt;%
          str_wrap(width = 40),
        range = ifelse(detected == &quot;&quot;, range, paste0(range, &quot;\n&quot;)),
        annot = glue(&quot;{range}{detected}&quot;)
      ),
    fill = rgb(1, 1, 1, 0.2),
    size = 3,
    show.legend = FALSE
  ) +
  scale_colour_manual(values = direction_colours) +
  labs(
    x = &quot;logFC&quot;,
    y = expression(paste(-log[10], &quot;p&quot;)),
    colour = &quot;Status&quot;
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-volcano-1.png" alt="*Volcano plot showing regions with evidence of differential H3K27ac binding. The most significant regions are labelled along with any genes these regions are mapped to.*" width="960" />
<p class="caption">
<em>Volcano plot showing regions with evidence of differential H3K27ac
binding. The most significant regions are labelled along with any genes
these regions are mapped to.</em>
</p>
</div>
</div>
<div id="heatmap-increased-binding" class="section level3">
<h3>Heatmap: Increased Binding</h3>
<pre class="r"><code>profile_heatmaps$Up + guides(colour = &quot;none&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-up-heatmap-1.png" alt="*Heatmap and histogram for all regions considered to show evidence of 
increased H3K27ac binding in 
response to E2DHT treatment. A total of 
335 regions were in this group.
*" width="960" />
<p class="caption">
<em>Heatmap and histogram for all regions considered to show evidence of
increased H3K27ac binding in response to E2DHT treatment. A total of 335
regions were in this group. </em>
</p>
</div>
</div>
<div id="heatmap-decreased-binding" class="section level3">
<h3>Heatmap: Decreased Binding</h3>
<pre class="r"><code>profile_heatmaps$Down + guides(colour = &quot;none&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-down-heatmap-1.png" alt="*Heatmap and histogram for all regions considered to show evidence of 
decreased H3K27ac binding in 
response to E2DHT treatment. A total of 
2 regions were in this group.
*" width="960" />
<p class="caption">
<em>Heatmap and histogram for all regions considered to show evidence of
decreased H3K27ac binding in response to E2DHT treatment. A total of 2
regions were in this group. </em>
</p>
</div>
</div>
<div id="results-by-chromosome" class="section level3">
<h3>Results By Chromosome</h3>
<pre class="r"><code>merged_results %&gt;% 
  select(status) %&gt;% 
  as.data.frame() %&gt;% 
  mutate(
    merge_status = fct_collapse(
      status,
      Up = &quot;Up&quot;,
      Down = &quot;Down&quot;,
      `Ambiguous/Unchanged` = intersect(c(&quot;Ambiguous&quot;, &quot;Unchanged&quot;), levels(status))
    )
  ) %&gt;% 
  ggplot(aes(seqnames, fill = status)) +
  geom_bar() +
  facet_grid(merge_status~., scales = &quot;free_y&quot;) +
  scale_y_continuous(expand = expansion(c(0, 0.05)), labels = comma) +
  scale_fill_manual(values =  direction_colours) +
  labs(
    x = &quot;Chromosome&quot;, y = &quot;Number of Windows&quot;, 
    fill = &quot;Status&quot;, alpha = &quot;Macs2 Peak&quot;
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-res-by-chromosome-1.png" alt="*Results for differential binding separated by chromosome*" width="960" />
<p class="caption">
<em>Results for differential binding separated by chromosome</em>
</p>
</div>
</div>
<div id="signal-by-region" class="section level3">
<h3>Signal By Region</h3>
<pre class="r"><code>merged_results %&gt;% 
  select(AveExpr, logFC, region) %&gt;% 
  as_tibble() %&gt;% 
  mutate(
    x = fct_relabel(
      region, str_replace_all, pattern = &quot; \\(&quot;, replacement = &quot;\n(&quot;
    ),
  ) %&gt;% 
  pivot_longer(cols = c(&quot;AveExpr&quot;, &quot;logFC&quot;)) %&gt;% 
  ggplot(aes(x, value, fill = region)) +
  geom_boxplot() +
  facet_grid(
    name~., scales = &quot;free&quot;, labeller = facet_labeller, switch = &quot;y&quot;
  ) +
  scale_fill_manual(values = region_colours) +
  labs(x = &quot;Region&quot;, y = c(), fill = &quot;Overlaps&quot;) </code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/boxplot-regions-1.png" alt="*Distributions of overall signal (logCPM) and changed signal (logFC) for each genomic region.*" width="960" />
<p class="caption">
<em>Distributions of overall signal (logCPM) and changed signal (logFC)
for each genomic region.</em>
</p>
</div>
</div>
<div id="differential-binding-by-region" class="section level3">
<h3>Differential Binding By Region</h3>
<pre class="r"><code>merged_results %&gt;% 
  subset(status %in% c(&quot;Up&quot;, &quot;Down&quot;)) %&gt;% 
  select(status, region) %&gt;% 
  as_tibble() %&gt;% 
  mutate(
    x = fct_relabel(
      region, str_replace_all, pattern = &quot; \\(&quot;, replacement = &quot;\n(&quot;
    )
  ) %&gt;% 
  group_by(x, region, status) %&gt;% 
  tally() %&gt;% 
  arrange(region, desc(status)) %&gt;% 
  mutate(y = cumsum(n)) %&gt;% 
  ggplot(
    aes(x, n, fill = status)
  ) +
  geom_col() +
  geom_label(
    aes(y = y - 0.5*n, label = comma(n, 1), colour = status),
    data = . %&gt;% ungroup() %&gt;% dplyr::filter(n &gt; 0.05*max(y)),
    fill = &quot;white&quot;, alpha = 0.8,
    show.legend = FALSE
  ) +
  geom_text(
    aes(y = y1, label = comma(y, 1)),
    data = . %&gt;% 
      dplyr::filter(y == max(y)) %&gt;% 
      ungroup() %&gt;% 
      mutate(y1 = y + 0.03*max(y))
  ) +
  scale_y_continuous(expand = expansion(c(0, 0.05)), labels = comma) +
  scale_fill_manual(values = direction_colours) +
  scale_colour_manual(values = direction_colours) +
  labs(x = &quot;Region&quot;, y = &quot;Merged Windows&quot;, fill = &quot;Status&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-db-regions-1.png" alt="*Merged windows considered as showing differential H3K27ac binding across all genomic regions.*" width="960" />
<p class="caption">
<em>Merged windows considered as showing differential H3K27ac binding
across all genomic regions.</em>
</p>
</div>
</div>
<div id="signal-by-feature" class="section level3">
<h3>Signal By Feature</h3>
<pre class="r"><code>merged_results %&gt;% 
  select(AveExpr, logFC, feature) %&gt;% 
  as_tibble() %&gt;% 
  pivot_longer(cols = c(&quot;AveExpr&quot;, &quot;logFC&quot;)) %&gt;% 
  ggplot(aes(feature, value, fill = feature)) +
  geom_boxplot() +
  facet_grid(
    name~., scales = &quot;free&quot;, labeller = facet_labeller, switch = &quot;y&quot;
  ) +
  scale_fill_manual(values = feature_colours) +
  labs(x = &quot;Region&quot;, y = c(), fill = &quot;Overlaps&quot;) </code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/boxplot-features-1.png" alt="*Distributions of overall signal (logCPM) and changed signal (logFC) for each external features.*" width="960" />
<p class="caption">
<em>Distributions of overall signal (logCPM) and changed signal (logFC)
for each external features.</em>
</p>
</div>
</div>
<div id="differential-binding-by-feature" class="section level3">
<h3>Differential Binding By Feature</h3>
<pre class="r"><code>merged_results %&gt;% 
  subset(status %in% c(&quot;Up&quot;, &quot;Down&quot;)) %&gt;% 
  select(status, feature) %&gt;% 
  as_tibble() %&gt;% 
  group_by(feature, status) %&gt;% 
  tally() %&gt;% 
  arrange(feature, desc(status)) %&gt;% 
  mutate(y = cumsum(n)) %&gt;% 
  ungroup() %&gt;% 
  ggplot(
    aes(feature, n, fill = status)
  ) +
  geom_col() +
  geom_label(
    aes(y = y - 0.5*n, label = comma(n, 1), colour = status),
    data = . %&gt;%  dplyr::filter(n &gt; 0.05*max(y)),
    fill = &quot;white&quot;, alpha = 0.8,
    show.legend = FALSE
  ) +
  geom_text(
    aes(y = y1, label = comma(y, 1)),
    data = . %&gt;% 
      group_by(feature) %&gt;% 
      dplyr::filter(y == max(y)) %&gt;% 
      ungroup() %&gt;% 
      mutate(y1 = y + 0.03*max(y))
  ) +
  scale_y_continuous(expand = expansion(c(0, 0.05)), labels = comma) +
  scale_fill_manual(values = direction_colours) +
  scale_colour_manual(values = direction_colours) +
  labs(x = &quot;Feature&quot;, y = &quot;Merged Windows&quot;, fill = &quot;Status&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-db-features-1.png" alt="*Merged windows considered as showing differential H3K27ac binding across all external features.*" width="960" />
<p class="caption">
<em>Merged windows considered as showing differential H3K27ac binding
across all external features.</em>
</p>
</div>
</div>
<div id="differential-binding-by-region-and-feature"
class="section level3">
<h3>Differential Binding By Region And Feature</h3>
<pre class="r"><code>df &lt;- merged_results %&gt;% 
  as_tibble() %&gt;% 
  dplyr::filter(status %in% c(&quot;Up&quot;, &quot;Down&quot;)) %&gt;% 
  droplevels() %&gt;% 
  group_by(region, feature, status) %&gt;% 
  summarise(n = dplyr::n(), .groups = &quot;drop_last&quot;) %&gt;% 
  mutate(total = sum(n)) %&gt;% 
  ungroup() %&gt;% 
  mutate(
    region = fct_relabel(region, str_wrap, width = 20),
    x0 = as.integer(region),
    y0 = as.integer(feature),
    r = sqrt(total / sum(total)),
    r = 0.5* r / max(r)
  ) 
df %&gt;% 
  ggplot() +
  ggforce::stat_pie(
    aes(x0 = x0, y0 = y0, r0 = 0, r = r, fill = status, amount = n)
  ) +
  coord_equal() +
  geom_label(
    aes(x0, y0, label = comma(total)),
    data = . %&gt;% 
      distinct(x0, y0, total) %&gt;% 
      dplyr::filter(total &gt; 0.01 * sum(total)),
    alpha = 0.6,
    inherit.aes = FALSE,
    show.legend = FALSE
  ) +
  geom_xsidecol(aes(x = x0, y = n, fill = status)) +
  geom_ysidecol(aes(x = n, y = y0, fill = status)) +
  scale_x_continuous(
    breaks = seq_along(levels(df$region)), labels = levels(df$region)
  ) +
  scale_y_continuous(
    breaks = seq_along(levels(df$feature)), labels = levels(df$feature)
  ) +
  scale_fill_manual(values = direction_colours) +
  scale_xsidey_continuous(name = c(), expand = expansion(c(0, 0.1))) +
  scale_ysidex_continuous(name = c(), expand = expansion(c(0, 0.1))) +
  labs(
    x = &quot;Region&quot;, y = &quot;Feature&quot;, fill = &quot;Status&quot;
  ) +
  theme(
    legend.position = &quot;right&quot;,
    ggside.panel.scale = 0.2
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/scatterpie-region-feature-1.png" alt="*Comparison of changes in H3K27ac binding separated by gene-centric region and external features provided in enhancer_atlas_2.0_zr75.gtf.gz*" width="960" />
<p class="caption">
<em>Comparison of changes in H3K27ac binding separated by gene-centric
region and external features provided in
enhancer_atlas_2.0_zr75.gtf.gz</em>
</p>
</div>
</div>
</div>
<div id="inspection-of-top-ranked-regions"
class="section level2 tabset">
<h2 class="tabset">Inspection of Top-Ranked Regions</h2>
<pre class="r"><code>## Define a GRL with the key ranges.
## Then we can step through it &amp; make all of the requisite plots
grl_to_plot &lt;- GRangesList(
  top_up_by_fdr = merged_results %&gt;% 
    filter(logFC &gt; 0) %&gt;% 
    filter(P.Value == min(P.Value)) %&gt;% 
    filter(!!sym(fdr_column) &lt; fdr_alpha),
  top_up_by_lfc = merged_results %&gt;% 
    filter(logFC == max(logFC), logFC &gt; 0, !!sym(fdr_column) &lt; fdr_alpha),
  top_up_by_expr = merged_results %&gt;% 
    filter(logFC &gt; 0, !!sym(fdr_column) &lt; fdr_alpha) %&gt;% 
    filter(AveExpr == max(AveExpr)),
  top_up_no_macs2 = merged_results %&gt;% 
    filter(logFC &gt; 0, !!sym(fdr_column) &lt; fdr_alpha, !overlaps_ref) %&gt;% 
    arrange(!!sym(fdr_column)) %&gt;% 
    arrange(P.Value),
  top_down_by_fdr = merged_results %&gt;% 
    filter(logFC &lt; 0) %&gt;% 
    filter(P.Value == min(P.Value)) %&gt;% 
    filter(!!sym(fdr_column) &lt; fdr_alpha),
  top_down_by_lfc = merged_results %&gt;% 
    filter(logFC == min(logFC), logFC &lt; 0, !!sym(fdr_column) &lt; fdr_alpha),
  top_down_by_expr = merged_results %&gt;% 
    filter(logFC &lt; 0, !!sym(fdr_column) &lt; fdr_alpha) %&gt;% 
    filter(AveExpr == max(AveExpr)),
  top_up_no_macs2 = merged_results %&gt;% 
    filter(logFC &lt; 0, !!sym(fdr_column) &lt; fdr_alpha, !overlaps_ref) %&gt;% 
    arrange(P.Value)
) %&gt;% 
  unlist() %&gt;% 
  .[!duplicated(.)] %&gt;%
  splitAsList(names(.)) %&gt;% 
  lapply(setNames, c()) %&gt;% 
  lapply(function(x) x[1]) %&gt;%
  GRangesList()
fh &lt;- max(4, 1 + 3 * ceiling(length(grl_to_plot) / 3)) %&gt;% 
  min(knitr::opts_chunk$get(&quot;fig.height&quot;))</code></pre>
<pre class="r"><code>## The coverage
bwfl &lt;- list2(
  &quot;{target}&quot; := file.path(
    macs2_path, glue(&quot;{treat_levels}_merged_treat_pileup.bw&quot;)
  ) %&gt;% 
    BigWigFileList() %&gt;% 
    setNames(treat_levels)
)
line_col &lt;- list2(&quot;{target}&quot; := treat_colours)
## Coverage annotations
annot &lt;- merged_results %&gt;% 
  splitAsList(.$status) %&gt;% 
  .[vapply(., length, integer(1)) &gt; 0] %&gt;% 
  endoapply(granges) %&gt;% 
  list() %&gt;% 
  setNames(target)
## Coverage y-limits
ind &lt;- filtered_counts %&gt;% 
  assay(&quot;counts&quot;) %&gt;% 
  apply(MARGIN = 2, which.max) %&gt;%
  unique()
max_ranges &lt;- rowRanges(filtered_counts[ind])
y_lim &lt;- bwfl[[target]] %&gt;%
  lapply(import.bw, which = max_ranges) %&gt;%
  lapply(function(x) c(0, max(x$score))) %&gt;% 
  unlist() %&gt;% 
  range() %&gt;% 
  list() %&gt;% 
  setNames(target)

## The features track
feat_gr &lt;- gene_regions %&gt;% 
  lapply(granges) %&gt;% 
  GRangesList()
feature_colours &lt;- colours$regions
if (has_features) {
  feat_gr &lt;- list(Regions = feat_gr)
  feat_gr$Features &lt;- splitAsList(external_features, external_features$feature)
  feature_colours &lt;- list(
    Regions = unlist(colours$regions),
    Features = unlist(colours$features)
  )
}

## The genes track
hfgc_genes &lt;- trans_models
gene_col &lt;- &quot;grey&quot;
if (has_rnaseq){
  if (!is.na(rna_lfc_col) &amp; !is.na(rna_fdr_col)) {
    hfgc_genes &lt;- trans_models %&gt;% 
      mutate(
        status = case_when(
          !gene %in% rnaseq$gene_id ~ &quot;Undetected&quot;,
          gene %in% dplyr::filter(
            rnaseq, !!sym(rna_lfc_col) &gt; 0, !!sym(rna_fdr_col) &lt; fdr_alpha
          )$gene_id ~ &quot;Up&quot;,
          gene %in% dplyr::filter(
            rnaseq, !!sym(rna_lfc_col) &lt; 0, !!sym(rna_fdr_col) &lt; fdr_alpha
          )$gene_id ~ &quot;Down&quot;,
          gene %in% dplyr::filter(
            rnaseq, !!sym(rna_fdr_col) &gt;= fdr_alpha
          )$gene_id ~ &quot;Unchanged&quot;,
        )
      ) %&gt;% 
      splitAsList(.$status) %&gt;% 
      lapply(select, -status) %&gt;% 
      GRangesList()
    gene_col &lt;- colours$direction %&gt;% 
      setNames(str_to_title(names(.)))
  }
}

## External Coverage (Optional)
if (!is.null(config$external$coverage)) {
  ext_cov_path &lt;- config$external$coverage %&gt;% 
    lapply(unlist) %&gt;% 
    lapply(function(x) setNames(here::here(x), names(x)))
  bwfl &lt;- c(
    bwfl[target],
    lapply(ext_cov_path, function(x) BigWigFileList(x) %&gt;% setNames(names(x)))
  )
  line_col &lt;- c(
    line_col[target],
    ext_cov_path %&gt;% 
      lapply(
        function(x) {
          missing &lt;- setdiff(names(x), names(colours$treat))
          cmn &lt;- intersect(names(x), names(colours$treat))
          col &lt;- setNames(character(length(names(x))), names(x))
          if (length(cmn) &gt; 0) col[cmn] &lt;- colours$treat[cmn]
          if (length(missing) &gt; 0) 
            col[missing] &lt;- hcl.colors(
              max(5, length(missing)), &quot;Zissou 1&quot;)[seq_along(missing)]
          col
        }
      )
  )
  
  y_ranges &lt;- grl_to_plot %&gt;% 
    unlist() %&gt;% 
    granges() %&gt;% 
    resize(w = 10 * width(.), fix = &#39;center&#39;)
  
  y_lim &lt;- c(
    y_lim[target],
    bwfl[names(bwfl) != target] %&gt;% 
      lapply(
        function(x) {
          GRangesList(lapply(x, import.bw, which = y_ranges)) %&gt;% 
            unlist() %&gt;% 
            filter(score == max(score)) %&gt;% 
            mcols() %&gt;% 
            .[[&quot;score&quot;]] %&gt;% 
            c(0) %&gt;% 
            range()
        }
      )
  )
  
}</code></pre>
<pre class="r"><code>makeCaption &lt;- function(.gr) {
  if (is.null(.gr)) return(NULL)
  dir &lt;- ifelse(.gr$direction == &quot;Down&quot;, &#39;decreased&#39;, &#39;increased&#39;)
  reg &lt;- case_when(
    str_detect(.gr$region, &quot;Inter&quot;) ~ paste(&quot;an&quot;, .gr$region, &quot;region&quot;),
    str_detect(.gr$region, &quot;Upstream&quot;) ~ paste(&quot;an&quot;, .gr$region),
    str_detect(.gr$region, &quot;(Ex|Intr)on&quot;) ~ paste(&quot;an&quot;, .gr$region),
    str_detect(.gr$region, &quot;^Prom&quot;) ~ paste(&quot;a&quot;, .gr$region)
  )
  feat &lt;- c()
  if (has_features) feat &lt;- case_when(
    str_detect(.gr$feature, &quot;^[AEIOU]&quot;) ~ paste(&quot;an&quot;, .gr$feature),
    !str_detect(.gr$feature, &quot;^[AEIOU]&quot;) ~ paste(&quot;a&quot;, .gr$feature)
  )
  gn &lt;- unlist(.gr$gene_name)
  fdr &lt;- mcols(.gr)[[fdr_column]]
  fdr &lt;- ifelse(
    fdr &lt; 0.001, sprintf(&#39;%.2e&#39;, fdr), sprintf(&#39;%.3f&#39;, fdr)
  )
  cp &lt;- c(
    glue(
      &quot;*The {width(.gr)}bp region showing {dir} {target} binding in response to &quot;, 
      &quot;{treat_levels[[2]]} treatment (FDR = {fdr}). &quot;,
      &quot;The range mostly overlapped with {reg}, with all &quot;,
      &quot;defined regions shown as a contiguous bar. &quot;,
      ifelse(
        has_features,
        glue(
          &quot;Using the features supplied in {basename(config$external$features)}, &quot;,
          &quot;this mostly overlapped {feat}, shown as a separate block &quot;,
          &quot;with the gene-centric regions. &quot;
        ),
        glue(&quot;&quot;)
      ),
    ),
    ifelse(
      .gr$overlaps_ref,
      paste(
        &quot;A consensus peak overlapping this region was identified by&quot;,
        &quot;`macs2 callpeak` when using merged samples.&quot;
      ),
      &quot;No consensus peak was identified using `macs2 callpeak`.&quot;
    ),
    ifelse(
      length(gn) &gt; 0,
      paste0(
        &quot;Using the above mapping strategy, this range is likely to regulate &quot;,
        collapseGenes(gn, format = &quot;&quot;)
      ),
      &quot;No genes were able to be assigned to this region.&quot;
    ),
    paste(
      &quot;For each sample, the y-axis limits represent the values from the window&quot;, 
      &quot;with the highest signal.*&quot;
    )
  )
  paste(cp, collapse = &quot; &quot;)
}</code></pre>
<div id="normalised-sliding-windows" class="section level3">
<h3>Normalised Sliding Windows</h3>
<pre class="r"><code>grl_to_plot %&gt;% 
  lapply(
    function(x){
      filtered_counts %&gt;% 
        subsetByOverlaps(x) %&gt;% 
        assay(&quot;qsmooth&quot;) %&gt;% 
        as_tibble(rownames = &quot;window&quot;) %&gt;% 
        pivot_longer(
          cols = all_of(colnames(filtered_counts)),
          names_to = &quot;sample&quot;,
          values_to = &quot;logCPM&quot;
        ) %&gt;% 
        mutate(range = as.character(x)) %&gt;% 
        list()
    }
  ) %&gt;% 
  as_tibble() %&gt;% 
  pivot_longer(everything()) %&gt;% 
  unnest(everything()) %&gt;% 
  mutate(
    direction = str_extract(name, &quot;down|up&quot;),
    by = str_extract(name, &quot;by_.+&quot;),
    across(
      all_of(c(&quot;name&quot;, &quot;direction&quot;, &quot;by&quot;)), str_sep_to_title
    ),
    name = str_remove_all(name, &quot;Top &quot;) %&gt;% 
      str_replace_all(&quot;Lfc&quot;, &quot;logFC&quot;) %&gt;% 
      str_replace_all(&quot;Fdr&quot;, &quot;FDR&quot;) %&gt;% 
      str_replace_all(&quot;Expr&quot;, &quot;Highest Signal&quot;) %&gt;% 
      str_replace_all(&quot;By (.+)&quot;, &quot;(\\1)&quot;) %&gt;% 
      str_replace_all(&quot;No Macs2&quot;, &quot;(No Macs2 Peak)&quot;),
    window = as.integer(window)
  ) %&gt;% 
  left_join(samples, by = &quot;sample&quot;) %&gt;% 
  ggplot(
    aes(window, logCPM, colour = treat, linetype = !!sym(rep_col))
  ) +
  geom_line(
    data = . %&gt;% 
      group_by(name) %&gt;% 
      dplyr::filter(max(window) &gt; 1)
  ) + 
  geom_point(
    data = . %&gt;% 
      group_by(name) %&gt;% 
      dplyr::filter(max(window) == 1),
    show.legend = FALSE
  ) + 
  facet_wrap(~name + range, scales = &quot;free_x&quot;) +
  scale_colour_manual(values = treat_colours) + 
  labs(
    x = &quot;Sliding Window\n(Unmerged)&quot;, y = &quot;SQ-Normalised logCPM&quot;, colour = &quot;Treat&quot;,
    linetype = str_sep_to_title(rep_col)
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-qsmooth-top-ranges-1.png" alt="*Most highly ranked ranges for both gained and decreased H3K27ac binding in repsonse to E2DHT treatment. The smooth-quantile normalised values are shown across the initial set of sliding windows before merging. Ranges were chosen as the most extreme for FDR, Binding Strength (Signal) and logFC. Windows are shown free of the genomic context.*" width="960" />
<p class="caption">
<em>Most highly ranked ranges for both gained and decreased H3K27ac
binding in repsonse to E2DHT treatment. The smooth-quantile normalised
values are shown across the initial set of sliding windows before
merging. Ranges were chosen as the most extreme for FDR, Binding
Strength (Signal) and logFC. Windows are shown free of the genomic
context.</em>
</p>
</div>
</div>
<div id="decreased-binding-strongest-signal" class="section level3">
<h3>Decreased Binding (Strongest Signal)</h3>
<pre class="r"><code>plotHFGC(
  grl_to_plot$top_down_by_expr,
  hic = hic,
  features = feat_gr,featcol = feature_colours, featsize = 1 + has_features,
  genes = hfgc_genes, genecol = gene_col,
  coverage = bwfl, linecol = line_col,
  annotation = annot, 
  annotcol = direction_colours,
  cytobands = bands_df,
  collapseTranscripts = FALSE,
  zoom = 10,
  max = 10 * width(grl_to_plot$top_down_by_expr),
  ylim = y_lim,
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-top-down-by-expr-1.png" alt="*The 1880bp region showing decreased H3K27ac binding in response to E2DHT treatment (FDR = 0.026). The range mostly overlapped with an Intron, with all defined regions shown as a contiguous bar. Using the features supplied in enhancer_atlas_2.0_zr75.gtf.gz, this mostly overlapped an Enhancer, shown as a separate block with the gene-centric regions.  A consensus peak overlapping this region was identified by `macs2 callpeak` when using merged samples. Using the above mapping strategy, this range is likely to regulate WWOX For each sample, the y-axis limits represent the values from the window with the highest signal.*" width="960" />
<p class="caption">
<em>The 1880bp region showing decreased H3K27ac binding in response to
E2DHT treatment (FDR = 0.026). The range mostly overlapped with an
Intron, with all defined regions shown as a contiguous bar. Using the
features supplied in enhancer_atlas_2.0_zr75.gtf.gz, this mostly
overlapped an Enhancer, shown as a separate block with the gene-centric
regions. A consensus peak overlapping this region was identified by
<code>macs2 callpeak</code> when using merged samples. Using the above
mapping strategy, this range is likely to regulate WWOX For each sample,
the y-axis limits represent the values from the window with the highest
signal.</em>
</p>
</div>
</div>
<div id="decreased-binding-lowest-fdr" class="section level3">
<h3>Decreased Binding (Lowest FDR)</h3>
<pre class="r"><code>plotHFGC(
  grl_to_plot$top_down_by_fdr,
  hic = hic,
  features = feat_gr,featcol = feature_colours, featsize = 1 + has_features,
  genes = hfgc_genes, genecol = gene_col,
  coverage = bwfl, linecol = line_col,
  annotation = annot, 
  annotcol = direction_colours,
  cytobands = bands_df,
  collapseTranscripts = FALSE,
  zoom = 10,
  max = 10 * width(grl_to_plot$top_down_by_fdr),
  ylim = y_lim,
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-top_down_by_fdr-1.png" alt="*The 480bp region showing decreased H3K27ac binding in response to E2DHT treatment (FDR = 0.028). The range mostly overlapped with an Intergenic (&gt;10kb) region, with all defined regions shown as a contiguous bar. Using the features supplied in enhancer_atlas_2.0_zr75.gtf.gz, this mostly overlapped an Enhancer, shown as a separate block with the gene-centric regions.  A consensus peak overlapping this region was identified by `macs2 callpeak` when using merged samples. No genes were able to be assigned to this region. For each sample, the y-axis limits represent the values from the window with the highest signal.*" width="960" />
<p class="caption">
<em>The 480bp region showing decreased H3K27ac binding in response to
E2DHT treatment (FDR = 0.028). The range mostly overlapped with an
Intergenic (&gt;10kb) region, with all defined regions shown as a
contiguous bar. Using the features supplied in
enhancer_atlas_2.0_zr75.gtf.gz, this mostly overlapped an Enhancer,
shown as a separate block with the gene-centric regions. A consensus
peak overlapping this region was identified by
<code>macs2 callpeak</code> when using merged samples. No genes were
able to be assigned to this region. For each sample, the y-axis limits
represent the values from the window with the highest signal.</em>
</p>
</div>
</div>
<div id="increased-binding-strongest-signal" class="section level3">
<h3>Increased Binding (Strongest Signal)</h3>
<pre class="r"><code>plotHFGC(
  grl_to_plot$top_up_by_expr,
  hic = hic,
  features = feat_gr,featcol = feature_colours, featsize = 1 + has_features,
  genes = hfgc_genes, genecol = gene_col,
  coverage = bwfl, linecol = line_col,
  annotation = annot, 
  annotcol = direction_colours,
  cytobands = bands_df,
  collapseTranscripts = FALSE,
  zoom = 10,
  max = 10 * width(grl_to_plot$top_up_by_expr),
  ylim = y_lim,
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-top-up-by-expr-1.png" alt="*The 4760bp region showing increased H3K27ac binding in response to E2DHT treatment (FDR = 1.48e-04). The range mostly overlapped with an Intron, with all defined regions shown as a contiguous bar. Using the features supplied in enhancer_atlas_2.0_zr75.gtf.gz, this mostly overlapped an Enhancer, shown as a separate block with the gene-centric regions.  A consensus peak overlapping this region was identified by `macs2 callpeak` when using merged samples. Using the above mapping strategy, this range is likely to regulate EIF4EP2, PHB and ZNF652 For each sample, the y-axis limits represent the values from the window with the highest signal.*" width="960" />
<p class="caption">
<em>The 4760bp region showing increased H3K27ac binding in response to
E2DHT treatment (FDR = 1.48e-04). The range mostly overlapped with an
Intron, with all defined regions shown as a contiguous bar. Using the
features supplied in enhancer_atlas_2.0_zr75.gtf.gz, this mostly
overlapped an Enhancer, shown as a separate block with the gene-centric
regions. A consensus peak overlapping this region was identified by
<code>macs2 callpeak</code> when using merged samples. Using the above
mapping strategy, this range is likely to regulate EIF4EP2, PHB and
ZNF652 For each sample, the y-axis limits represent the values from the
window with the highest signal.</em>
</p>
</div>
</div>
<div id="increased-binding-lowest-fdr" class="section level3">
<h3>Increased Binding (Lowest FDR)</h3>
<pre class="r"><code>plotHFGC(
  grl_to_plot$top_up_by_fdr,
  hic = hic,
  features = feat_gr,featcol = feature_colours, featsize = 1 + has_features,
  genes = hfgc_genes, genecol = gene_col,
  coverage = bwfl, linecol = line_col,
  annotation = annot, 
  annotcol = direction_colours,
  cytobands = bands_df,
  collapseTranscripts = FALSE,
  zoom = 10,
  max = 10 * width(grl_to_plot$top_up_by_fdr),
  ylim = y_lim,
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-top_up_by_fdr-1.png" alt="*The 1720bp region showing increased H3K27ac binding in response to E2DHT treatment (FDR = 1.84e-16). The range mostly overlapped with an Intron, with all defined regions shown as a contiguous bar. Using the features supplied in enhancer_atlas_2.0_zr75.gtf.gz, this mostly overlapped a No Feature, shown as a separate block with the gene-centric regions.  A consensus peak overlapping this region was identified by `macs2 callpeak` when using merged samples. Using the above mapping strategy, this range is likely to regulate CCDC40 For each sample, the y-axis limits represent the values from the window with the highest signal.*" width="960" />
<p class="caption">
<em>The 1720bp region showing increased H3K27ac binding in response to
E2DHT treatment (FDR = 1.84e-16). The range mostly overlapped with an
Intron, with all defined regions shown as a contiguous bar. Using the
features supplied in enhancer_atlas_2.0_zr75.gtf.gz, this mostly
overlapped a No Feature, shown as a separate block with the gene-centric
regions. A consensus peak overlapping this region was identified by
<code>macs2 callpeak</code> when using merged samples. Using the above
mapping strategy, this range is likely to regulate CCDC40 For each
sample, the y-axis limits represent the values from the window with the
highest signal.</em>
</p>
</div>
</div>
<div id="increased-binding-most-extreme" class="section level3">
<h3>Increased Binding (Most Extreme)</h3>
<pre class="r"><code>plotHFGC(
  grl_to_plot$top_up_by_lfc,
  hic = hic,
  features = feat_gr,featcol = feature_colours, featsize = 1 + has_features,
  genes = hfgc_genes, genecol = gene_col,
  coverage = bwfl, linecol = line_col,
  annotation = annot, 
  annotcol = direction_colours,
  cytobands = bands_df,
  collapseTranscripts = FALSE,
  zoom = 10,
  max = 10 * width(grl_to_plot$top_up_by_lfc),
  ylim = y_lim,
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-top_up_by_lfc-1.png" alt="*The 320bp region showing increased H3K27ac binding in response to E2DHT treatment (FDR = 2.16e-10). The range mostly overlapped with an Intron, with all defined regions shown as a contiguous bar. Using the features supplied in enhancer_atlas_2.0_zr75.gtf.gz, this mostly overlapped a No Feature, shown as a separate block with the gene-centric regions.  A consensus peak overlapping this region was identified by `macs2 callpeak` when using merged samples. Using the above mapping strategy, this range is likely to regulate C2orf76 For each sample, the y-axis limits represent the values from the window with the highest signal.*" width="960" />
<p class="caption">
<em>The 320bp region showing increased H3K27ac binding in response to
E2DHT treatment (FDR = 2.16e-10). The range mostly overlapped with an
Intron, with all defined regions shown as a contiguous bar. Using the
features supplied in enhancer_atlas_2.0_zr75.gtf.gz, this mostly
overlapped a No Feature, shown as a separate block with the gene-centric
regions. A consensus peak overlapping this region was identified by
<code>macs2 callpeak</code> when using merged samples. Using the above
mapping strategy, this range is likely to regulate C2orf76 For each
sample, the y-axis limits represent the values from the window with the
highest signal.</em>
</p>
</div>
</div>
</div>
</div>
<div id="enrichment-testing" class="section level1">
<h1>Enrichment Testing</h1>
<pre class="r"><code>min_gs_size &lt;- params$enrichment$min_size
if (is.null(min_gs_size) | is.na(min_gs_size)) min_gs_size &lt;- 0
max_gs_size &lt;- params$enrichment$max_size
if (is.null(max_gs_size) | is.na(max_gs_size)) max_gs_size &lt;- Inf
min_sig &lt;- params$enrichment$min_sig
if (is.null(min_sig) | is.na(min_sig)) min_sig &lt;- 1
msigdb &lt;- msigdbr(species = &quot;Homo sapiens&quot;) %&gt;% 
  dplyr::filter(
    gs_cat %in% unlist(params$enrichment$msigdb$gs_cat) |
      gs_subcat %in% unlist(params$enrichment$msigdb$gs_subcat),
    str_detect(ensembl_gene, &quot;^E&quot;)
  ) %&gt;% 
  dplyr::rename(gene_id = ensembl_gene, gene_name = gene_symbol) %&gt;% # For easier integration 
  dplyr::select(-starts_with(&quot;human&quot;), -contains(&quot;entrez&quot;)) %&gt;% 
  dplyr::filter(gene_id %in% genes_gr$gene_id) %&gt;% 
  mutate(gs_url = str_extract(gs_url, &quot;^[^|]+&quot;)) %&gt;% 
  group_by(gs_name) %&gt;% 
  mutate(n = dplyr::n()) %&gt;% 
  ungroup() %&gt;% 
  dplyr::filter(n &gt;= min_gs_size, n &lt; max_gs_size) 
gs_by_gsid &lt;- msigdb %&gt;% 
  split(.$gs_name) %&gt;% 
  lapply(pull, &quot;gene_id&quot;) %&gt;% 
  lapply(unique)
gs_by_geneid &lt;- msigdb %&gt;% 
  split(.$gene_id) %&gt;% 
  lapply(pull, &quot;gs_name&quot;) %&gt;% 
  lapply(unique)
gs_url &lt;- msigdb %&gt;% 
  distinct(gs_name, gs_url) %&gt;%
  mutate(
    gs_url = ifelse(
      gs_url == &quot;&quot;, &quot;
      http://www.gsea-msigdb.org/gsea/msigdb/collections.jsp&quot;,
      gs_url
    )
  ) %&gt;% 
  with(setNames(gs_url, gs_name))

min_network_size &lt;- params$networks$min_size
if (is.null(min_network_size) | is.na(min_network_size))
  min_network_size &lt;- 2

max_network_size &lt;- params$networks$max_size
if (is.null(max_network_size) | is.na(max_network_size))
  max_network_size &lt;- Inf

max_network_dist &lt;- params$networks$max_distance
if (is.null(max_network_dist) | is.na(max_network_dist))
  max_network_dist &lt;- 1

net_layout &lt;- params$networks$layout
enrich_alpha &lt;- params$enrichment$alpha
adj_method &lt;- match.arg(params$enrichment$adj, p.adjust.methods)
adj_desc &lt;- case_when(
  p.adjust.methods %in% c(&quot;fdr&quot;, &quot;BH&quot;) ~ &quot;the Benjamini-Hochberg FDR&quot;,
  p.adjust.methods %in% c(&quot;BY&quot;) ~ &quot;the Benjamini-Yekutieli FDR&quot;,
  p.adjust.methods %in% c(&quot;bonferroni&quot;) ~ &quot;the Bonferroni&quot;,
  p.adjust.methods %in% c(&quot;holm&quot;) ~ &quot;Holm&#39;s&quot;,
  p.adjust.methods %in% c(&quot;hommel&quot;) ~ &quot;Hommel&#39;s&quot;,
  p.adjust.methods %in% c(&quot;hochberg&quot;) ~ &quot;Hochberg&#39;s&quot;,
  p.adjust.methods %in% c(&quot;none&quot;) ~ &quot;no&quot;
) %&gt;% 
  setNames(p.adjust.methods)
mapped_ids &lt;- merged_results %&gt;%
  as_tibble() %&gt;% 
  dplyr::select(status, gene_id) %&gt;%
  unnest(gene_id) %&gt;%
  group_by(gene_id) %&gt;%
  summarise(
    up = any(status == &quot;Up&quot;), 
    down = any(status == &quot;Down&quot;), 
    n_peaks = dplyr::n(),
    .groups = &quot;drop&quot;
  )</code></pre>
<p>As an initial exploration, the retained windows were compared to
pre-defined gene-sets. These were taken from the <code>MSigDB</code>
database and the gene-sets used for enrichment testing were restricted
to only include those with between 5 and 1000 genes.</p>
<pre class="r"><code>msigdb %&gt;% 
  distinct(gs_cat, gs_subcat, gs_name) %&gt;%
  group_by(gs_cat, gs_subcat) %&gt;% 
  summarise(`Gene Sets` = dplyr::n(),.groups = &quot;drop&quot;) %&gt;% 
  dplyr::rename(Category = gs_cat, `Sub-Category` = gs_subcat) %&gt;% 
  mutate(
    Description = case_when(
      Category == &quot;H&quot; ~ &quot;Hallmark Gene-Sets&quot;,
      Category == &quot;C1&quot; ~ &quot;Positional Gene Sets&quot;,
      Category == &quot;C2&quot; ~ str_replace_all(`Sub-Category`, &quot;CP:(.+)&quot;, &quot;Curated Gene-Sets: \\1&quot;),
      str_detect(`Sub-Category`, &quot;TFT&quot;) ~ str_replace_all(`Sub-Category`, &quot;TFT:(.+)&quot;, &quot;Transcription Factor Target Prediction Gene-Sets: \\1&quot;),
      str_detect(`Sub-Category`, &quot;MIR&quot;) ~ str_replace_all(`Sub-Category`, &quot;MIR:(.+)&quot;, &quot;microRNA Target Gene-Sets: \\1&quot;),
      str_detect(`Sub-Category`, &quot;CGN&quot;) ~ &quot;Cancer Gene Neighbourhoods&quot;,
      str_detect(`Sub-Category`, &quot;CM&quot;) ~ &quot;Cancer Modules&quot;,
      str_detect(`Sub-Category`, &quot;GO:BP&quot;) ~ &quot;Gene Ontology: Bological Process&quot;,
      str_detect(`Sub-Category`, &quot;GO:MF&quot;) ~ &quot;Gene Ontology: Molecular Function&quot;,
      str_detect(`Sub-Category`, &quot;GO:CC&quot;) ~ &quot;Gene Ontology: Cellular Component&quot;,
      str_detect(`Sub-Category`, &quot;HPO&quot;) ~ &quot;Human Phenotype Ontology&quot;,
      Category == &quot;C6&quot; ~ &quot;Oncogenic Signature Gene Sets&quot;,
      `Sub-Category` == &quot;IMMUNESIGDB&quot; ~ &quot;ImmuneSigDB Gene Sets&quot;,
      `Sub-Category` == &quot;VAX&quot; ~ &quot;Vaccine Response Gene Sets&quot;,
      Category == &quot;C8&quot; ~ &quot;Cell Type Signature Gene Sets&quot;
    ),
    Category = factor(Category, levels = c(&quot;H&quot;, paste0(&quot;C&quot;, 1:8)))
  ) %&gt;% 
  droplevels() %&gt;% 
  arrange(Category) %&gt;% 
  pander(
    justify = &quot;llrl&quot;, 
    caption = &quot;*Summary of Gene-Sets used for Enrichment Testing*&quot;
  )</code></pre>
<table style="width:99%;">
<caption><em>Summary of Gene-Sets used for Enrichment
Testing</em></caption>
<colgroup>
<col width="15%" />
<col width="25%" />
<col width="16%" />
<col width="41%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Category</th>
<th align="left">Sub-Category</th>
<th align="right">Gene Sets</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">H</td>
<td align="left"></td>
<td align="right">50</td>
<td align="left">Hallmark Gene-Sets</td>
</tr>
<tr class="even">
<td align="left">C2</td>
<td align="left">CP:KEGG</td>
<td align="right">183</td>
<td align="left">Curated Gene-Sets: KEGG</td>
</tr>
<tr class="odd">
<td align="left">C2</td>
<td align="left">CP:REACTOME</td>
<td align="right">1,388</td>
<td align="left">Curated Gene-Sets: REACTOME</td>
</tr>
<tr class="even">
<td align="left">C2</td>
<td align="left">CP:WIKIPATHWAYS</td>
<td align="right">605</td>
<td align="left">Curated Gene-Sets: WIKIPATHWAYS</td>
</tr>
<tr class="odd">
<td align="left">C3</td>
<td align="left">TFT:GTRD</td>
<td align="right">425</td>
<td align="left">Transcription Factor Target Prediction Gene-Sets:
GTRD</td>
</tr>
</tbody>
</table>
<p>Retained windows were tested for enrichment of these gene-sets
using:</p>
<ol style="list-style-type: decimal">
<li>Any window mapped to a gene from these gene-sets</li>
<li>Any window with evidence of differential binding mapped to a gene
from these gene-sets</li>
</ol>
<p>In the first case, mapped genes were tested for enrichment against
all annotated genes, or all detected genes if RNA-Seq data was provided.
In the second case, i.e. Differentially Bound Windows, the control set
of genes were those mapped to a window (i.e. those test set from step
1). All adjusted p-values below are calculated using the
Benjamini-Hochberg FDR adjustment. After adjustment, any enriched
gene-sets with fewer than 3 mapped genes were excluded as being
uninformative.</p>
<p>If 4 or more gene-sets were considered to be enriched, a network plot
will be produced for that specific analysis, with network sizes capped
at 80. The distances between gene-sets were calculated using the overlap
coefficient (OC). Gene-sets with a large overlap will thus be given
small distances and in the case of a complete overlap (<span
class="math inline">\(OC = 1\)</span>) the only most highly ranked
gene-set was retained. Gene-set (i.e. node) pairs with a distance &gt;
0.9 will not have edges drawn between them and edge width also
corresponds to the distance between nodes with closely related nodes
having thicker edges. All network plots were generated using the fr
layout algorithm.</p>
<div id="windows-with-detected-h3k27ac" class="section level2 tabset">
<h2 class="tabset">Windows With Detected H3K27ac</h2>
<pre class="r"><code>pwf_mapped &lt;- genes_gr %&gt;% 
  mutate(w = width(.)) %&gt;% 
  as_tibble() %&gt;% 
  dplyr::select(gene_id, w) %&gt;% 
  arrange(desc(w)) %&gt;% 
  distinct(gene_id, .keep_all = TRUE) %&gt;% 
  mutate(mapped = gene_id %in% unlist(merged_results$gene_id)) %&gt;% 
  with(
    nullp(
      structure(mapped, names = gene_id),
      genome = config$genome$build,
      bias.data = log10(w),
      plot.fit = TRUE
    )
  )</code></pre>
<pre class="r"><code>goseq_mapped &lt;- tibble(gs_name = character(), adj_p = numeric())
if (sum(pwf_mapped$DEgenes) &gt; 0) {
  goseq_mapped &lt;- goseq(
    pwf_mapped, config$genome$build, gene2cat = gs_by_geneid
  ) %&gt;% 
    dplyr::rename(gs_name = category, pval = over_represented_pvalue) %&gt;% 
    dplyr::select(-starts_with(&quot;under&quot;)) %&gt;% 
    as_tibble() %&gt;% 
    arrange(pval) %&gt;% 
    dplyr::filter(numDEInCat &gt; 0) %&gt;% 
    mutate(adj_p = p.adjust(pval, adj_method)) %&gt;% 
    dplyr::filter(numDEInCat &gt;= min_sig)
}
any_goseq_mapped &lt;- sum(goseq_mapped$adj_p &lt; enrich_alpha) &gt; 0
tg_mapped &lt;- make_tbl_graph(
  goseq_mapped, 
  gs = gs_by_gsid %&gt;% 
    lapply(intersect, rownames(subset(pwf_mapped, DEgenes))) %&gt;% 
    .[vapply(., length, integer(1)) &gt; 0]
)
plot_network_mapped &lt;- length(tg_mapped) &gt;= min_network_size</code></pre>
<p>No enrichment was found amongst genes mapped to any window</p>
</div>
<div id="windows-with-differentially-bound-h3k27ac"
class="section level2 tabset">
<h2 class="tabset">Windows With Differentially Bound H3K27ac</h2>
<pre class="r"><code>pwf_diff &lt;- tibble(gene_id  = unique(genes_gr$gene_id)) %&gt;% 
  left_join(mapped_ids, by = &quot;gene_id&quot;) %&gt;% 
  dplyr::filter(!is.na(n_peaks)) %&gt;% 
  mutate(diff = up|down) %&gt;% 
  with(
    nullp(
      structure(diff, names = gene_id),
      genome = config$genome$build,
      bias.data = log1p(n_peaks),
      plot.fit = FALSE
    )
  )
goseq_diff &lt;- tibble(gs_name = character(), pval = numeric(), adj_p = numeric())
if (sum(pwf_diff$DEgenes) &gt; 0) {
  goseq_diff &lt;- goseq(
    pwf_diff, gene2cat = gs_by_geneid, method = &quot;Hypergeometric&quot;
  ) %&gt;% 
    dplyr::rename(gs_name = category, pval = over_represented_pvalue) %&gt;% 
    dplyr::select(-starts_with(&quot;under&quot;)) %&gt;% 
    as_tibble() %&gt;% 
    arrange(pval) %&gt;% 
    dplyr::filter(numDEInCat &gt; 0) %&gt;% 
    mutate(adj_p = p.adjust(pval, adj_method)) %&gt;% 
    dplyr::filter(numDEInCat &gt;= min_sig)
}
any_goseq_diff &lt;- sum(goseq_diff$adj_p &lt; enrich_alpha) &gt; 0
tg_diff &lt;- make_tbl_graph(
  goseq_diff, 
  gs = gs_by_gsid %&gt;% 
    lapply(intersect, rownames(subset(pwf_diff, DEgenes))) %&gt;%
    .[vapply(., length, integer(1)) &gt; 0]
)
plot_network_diff &lt;- length(tg_diff) &gt;= min_network_size</code></pre>
<div id="results-table" class="section level3">
<h3>Results Table</h3>
<pre class="r"><code>cp &lt;- htmltools::tags$caption(
  htmltools::em(
    glue(
      &quot;
    All {sum(goseq_diff$adj_p &lt; enrich_alpha)} gene sets considered as 
    significantly enriched (p
    &quot;
    ),
    htmltools::tags$sub(&quot;adj&quot;),
    htmltools::em(
      glue(
        &quot;
         &lt; {enrich_alpha}) amongst the windows showing evidence of changed 
        {target} binding. Genes mapped to a differentially-bound window were 
        compared to those mapped to any merged window. A standard (unbiased)
        hypergeomtric test was used to test for enrichment.
        &quot;
      )
    )
  )
)
tbl &lt;- goseq_diff %&gt;% 
  dplyr::filter(adj_p &lt; enrich_alpha) %&gt;%
  left_join(
    dplyr::select(msigdb, gs_name, gene_name, gene_id, gs_url, gs_description),
    by = &quot;gs_name&quot;
  ) %&gt;% 
  dplyr::filter(
    gene_id %in% unlist(subset(merged_results, status != &quot;Unchanged&quot;)$gene_id)
  ) %&gt;% 
  dplyr::select(-gene_id) %&gt;% 
  chop(gene_name) %&gt;% 
  mutate(
    gene_name = vapply(gene_name, paste, character(1), collapse = &quot;: &quot;),
    `%` = numDEInCat / numInCat
  ) %&gt;% 
  dplyr::select(
    `Gene Set` = gs_name, Description = gs_description,
    `%`, numDEInCat, numInCat, p = pval, adj_p, 
    `Genes Mapped to DB Windows` = gene_name
  ) %&gt;% 
  reactable(
    filterable = TRUE,
    showPageSizeOptions = TRUE,
    columns = list(
      &quot;Gene Set&quot; = colDef(
        minWidth = 150,
        cell = function(value) htmltools::tags$a(
          href = gs_url[[value]], 
          target = &quot;_blank&quot;, 
          str_replace_all(value, &quot;_&quot;, &quot; &quot;)
        ),
        html = TRUE
      ),
      Description = colDef(
        minWidth = 150,
        cell = function(value) with_tooltip(value, width = 100)
      ),
      &quot;%&quot; = colDef(
        name = &quot;% DB&quot;,
        maxWidth = 80,
        cell = function(value) percent(value, 0.1)
      ),
      numDEInCat = colDef(name = &quot;Total Mapped To DB&quot;, maxWidth = 80),
      numInCat = colDef(
        name = &quot;Total Mapped&quot;,
        maxWidth = 80,
        cell = function(value) comma(value, 1)
      ),
      p = colDef(
        cell = function(value) {
          ifelse(
            value &lt; 0.001, sprintf(&quot;%.2e&quot;, value), sprintf(&quot;%.3f&quot;, value)
          )
        },
        maxWidth = 70
      ),
      adj_p = colDef(
        name = &quot;p&lt;sub&gt;adj&lt;/sub&gt;&quot;, html = TRUE,
        cell = function(value) {
          ifelse(
            value &lt; 0.001, sprintf(&quot;%.2e&quot;, value), sprintf(&quot;%.3f&quot;, value)
          )
        },
        maxWidth = 70
      ),
      &quot;Genes Mapped to DB Windows&quot; = colDef(
        cell = function(value) with_tooltip(value, width = 100),
        minWidth = 200
      )
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<caption>
<em>
All 3 gene sets considered as 
significantly enriched (p
<sub>adj</sub>
<em> &lt; 0.05) amongst the windows showing evidence of changed 
H3K27ac binding. Genes mapped to a differentially-bound window were 
compared to those mapped to any merged window. A standard (unbiased)
hypergeomtric test was used to test for enrichment.</em>
</em>
</caption>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b131c3612b4dd81aeea8" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b131c3612b4dd81aeea8">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Gene Set":["HALLMARK_ESTROGEN_RESPONSE_EARLY","HES2_TARGET_GENES","HALLMARK_ESTROGEN_RESPONSE_LATE"],"Description":["Genes defining early response to estrogen.","Genes containing one or more binding sites for UniProt:Q9Y543 (HES2) in their promoter regions (TSS -1000,+100 bp) as identified by GTRD version 20.06 ChIP-seq harmonization.","Genes defining late response to estrogen."],"%":[0.10795454545454546,0.05568181818181818,0.085365853658536592],"numDEInCat":[19,49,14],"numInCat":[176,880,164],"p":[1.5049622789553467e-07,2.6374966990839972e-07,9.4403936944729644e-05],"adj_p":[0.00017816290202312402,0.00017816290202312402,0.042513239604109916],"Genes Mapped to DB Windows":["AQP3: CHPT1: DEPTOR: FKBP5: FLNB: GFRA1: INPP5F: KDM4B: MYBL1: PPIF: RAB31: SCNN1A: SEC14L2: SLC1A4: SLC7A2: SULT2B1: SYBU: TMEM164: WWC1","ABHD12: AQP3: ARID5B: ATF6: BDP1: C1orf21: C2orf76: CDK5RAP2: CECR2: CRYBG1: CUEDC1: CYB5A: DIO2: DLEU2: EHF: EIF2S3: EML2: FLNB: GCLC: HBP1: HDAC5: IQGAP2: KIAA0232: LRBA: MCCC2: MRPS23: MTMR12: MTMR9: NEDD4L: NFIC: NFKBIA: NFX1: NR4A1: NRP1: P4HA2: PTPRM: RAB31: RCL1: SCNN1A: SGK3: SH3BP4: SLC38A1: SMIM14: SQOR: SYBU: TEX2: TMSB4X: TNFRSF1A: VWA8","CD9: CHPT1: EMP2: FKBP5: FLNB: HOMER2: PPIF: PRLR: RAB31: SCNN1A: SLC1A4: SORD: SULT2B1: UGDH"]},"columns":[{"id":"Gene Set","name":"Gene Set","type":"character","cell":[{"name":"a","attribs":{"href":null,"target":"_blank"},"children":["HALLMARK ESTROGEN RESPONSE EARLY"]},{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["HES2 TARGET GENES"]},{"name":"a","attribs":{"href":null,"target":"_blank"},"children":["HALLMARK ESTROGEN RESPONSE LATE"]}],"html":true,"minWidth":150},{"id":"Description","name":"Description","type":"character","cell":[{"name":"span","attribs":{"title":"Genes defining early response to estrogen."},"children":["Genes defining early response to estrogen."]},{"name":"span","attribs":{"title":"Genes containing one or more binding sites for UniProt:Q9Y543 (HES2) in their promoter regions (TSS -1000,+100 bp) as identified by GTRD version 20.06 ChIP-seq harmonization."},"children":["Genes containing one or more binding sites for UniProt:Q9Y543 (HES2) in their promoter regions (T..."]},{"name":"span","attribs":{"title":"Genes defining late response to estrogen."},"children":["Genes defining late response to estrogen."]}],"minWidth":150},{"id":"%","name":"% DB","type":"numeric","cell":["10.8%","5.6%","8.5%"],"maxWidth":80},{"id":"numDEInCat","name":"Total Mapped To DB","type":"numeric","maxWidth":80},{"id":"numInCat","name":"Total Mapped","type":"numeric","cell":["176","880","164"],"maxWidth":80},{"id":"p","name":"p","type":"numeric","cell":["1.50e-07","2.64e-07","9.44e-05"],"maxWidth":70},{"id":"adj_p","name":"p<sub>adj<\/sub>","type":"numeric","cell":["1.78e-04","1.78e-04","0.043"],"html":true,"maxWidth":70},{"id":"Genes Mapped to DB Windows","name":"Genes Mapped to DB Windows","type":"character","cell":[{"name":"span","attribs":{"title":"AQP3: CHPT1: DEPTOR: FKBP5: FLNB: GFRA1: INPP5F: KDM4B: MYBL1: PPIF: RAB31: SCNN1A: SEC14L2: SLC1A4: SLC7A2: SULT2B1: SYBU: TMEM164: WWC1"},"children":["AQP3: CHPT1: DEPTOR: FKBP5: FLNB: GFRA1: INPP5F: KDM4B: MYBL1: PPIF: RAB31: SCNN1A: SEC14L2: SLC1..."]},{"name":"span","attribs":{"title":"ABHD12: AQP3: ARID5B: ATF6: BDP1: C1orf21: C2orf76: CDK5RAP2: CECR2: CRYBG1: CUEDC1: CYB5A: DIO2: DLEU2: EHF: EIF2S3: EML2: FLNB: GCLC: HBP1: HDAC5: IQGAP2: KIAA0232: LRBA: MCCC2: MRPS23: MTMR12: MTMR9: NEDD4L: NFIC: NFKBIA: NFX1: NR4A1: NRP1: P4HA2: PTPRM: RAB31: RCL1: SCNN1A: SGK3: SH3BP4: SLC38A1: SMIM14: SQOR: SYBU: TEX2: TMSB4X: TNFRSF1A: VWA8"},"children":["ABHD12: AQP3: ARID5B: ATF6: BDP1: C1orf21: C2orf76: CDK5RAP2: CECR2: CRYBG1: CUEDC1: CYB5A: DIO2:..."]},{"name":"span","attribs":{"title":"CD9: CHPT1: EMP2: FKBP5: FLNB: HOMER2: PPIF: PRLR: RAB31: SCNN1A: SLC1A4: SORD: SULT2B1: UGDH"},"children":["CD9: CHPT1: EMP2: FKBP5: FLNB: HOMER2: PPIF: PRLR: RAB31: SCNN1A: SLC1A4: SORD: SULT2B1: UGDH"]}],"minWidth":200}],"filterable":true,"showPageSizeOptions":true,"dataKey":"a44b19667bd755ffece5ccbc6490dce5"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
<div id="windows-with-increased-h3k27ac-binding"
class="section level2 tabset">
<h2 class="tabset">Windows With Increased H3K27ac Binding</h2>
<pre class="r"><code>pwf_up &lt;- tibble(gene_id  = unique(genes_gr$gene_id)) %&gt;% 
  left_join(mapped_ids, by = &quot;gene_id&quot;) %&gt;% 
  dplyr::filter(!is.na(n_peaks)) %&gt;% 
  mutate(diff = up) %&gt;% 
  with(
    nullp(
      structure(diff, names = gene_id),
      genome = config$genome$build,
      bias.data = log1p(n_peaks),
      plot.fit = FALSE
    )
  )
goseq_up &lt;- tibble(gs_name = character(), pval = numeric(), adj_p = numeric())
if (sum(pwf_up$DEgenes) &gt; 0) {
  goseq_up &lt;- goseq(
    pwf_up, gene2cat = gs_by_geneid, method = &quot;Hypergeometric&quot;
  ) %&gt;% 
    dplyr::rename(gs_name = category, pval = over_represented_pvalue) %&gt;% 
    dplyr::select(-starts_with(&quot;under&quot;)) %&gt;% 
    as_tibble() %&gt;% 
    arrange(pval) %&gt;% 
    dplyr::filter(numDEInCat &gt; 0) %&gt;% 
    mutate(adj_p = p.adjust(pval, adj_method)) %&gt;% 
    dplyr::filter(numDEInCat &gt;= min_sig)
}
any_goseq_up &lt;- sum(goseq_up$adj_p &lt; enrich_alpha) &gt; 0
tg_up &lt;- make_tbl_graph(
  goseq_up, 
  gs = gs_by_gsid %&gt;% 
    lapply(intersect, rownames(subset(pwf_up, DEgenes))) %&gt;%
    .[vapply(., length, integer(1)) &gt; 0]
)
plot_network_up &lt;- length(tg_up) &gt;= min_network_size</code></pre>
<div id="results-table-1" class="section level3">
<h3>Results Table</h3>
<pre class="r"><code>cp &lt;- htmltools::tags$caption(
  htmltools::em(
    glue(
      &quot;
    All {sum(goseq_up$adj_p &lt; enrich_alpha)} gene sets considered as 
    significantly enriched (p
    &quot;
    ),
    htmltools::tags$sub(&quot;adj&quot;),
    htmltools::em(
      glue(
        &quot;
         &lt; {enrich_alpha}) amongst the windows showing evidence of increased 
        {target} binding. Genes mapped to an increasing window were 
        compared to those mapped to any merged window. A standard (unbiased)
        hypergeomtric test was used to test for enrichment.
        &quot;
      )
    )
  )
)
tbl &lt;- goseq_up %&gt;% 
  dplyr::filter(adj_p &lt; enrich_alpha) %&gt;%
  left_join(
    dplyr::select(msigdb, gs_name, gene_name, gene_id, gs_url, gs_description),
    by = &quot;gs_name&quot;
  ) %&gt;% 
  dplyr::filter(
    gene_id %in% unlist(subset(merged_results, status == &quot;Up&quot;)$gene_id)
  ) %&gt;% 
  dplyr::select(-gene_id) %&gt;% 
  chop(gene_name) %&gt;% 
  mutate(
    gene_name = vapply(gene_name, paste, character(1), collapse = &quot;: &quot;),
    `%` = numDEInCat / numInCat
  ) %&gt;% 
  dplyr::select(
    `Gene Set` = gs_name, Description = gs_description,
    `%`, numDEInCat, numInCat, p = pval, adj_p, 
    `Genes Mapped to Gained Windows` = gene_name
  ) %&gt;% 
  reactable(
    filterable = TRUE,
    showPageSizeOptions = TRUE,
    columns = list(
      &quot;Gene Set&quot; = colDef(
        minWidth = 150,
        cell = function(value) htmltools::tags$a(
          href = gs_url[[value]], 
          target = &quot;_blank&quot;, 
          str_replace_all(value, &quot;_&quot;, &quot; &quot;)
        ),
        html = TRUE
      ),
      Description = colDef(
        minWidth = 150,
        cell = function(value) with_tooltip(value, width = 100)
      ),
      &quot;%&quot; = colDef(
        name = &quot;% Gained&quot;,
        cell = function(value) percent(value, 0.1),
        maxWidth = 80
      ),
      numDEInCat = colDef(name = &quot;Mapped to Gained Windows&quot;, maxWidth = 80),
      numInCat = colDef(
        name = &quot;Total Mapped&quot;,
        maxWidth = 80,
        cell = function(value) comma(value, 1)
      ),
      p = colDef(
        cell = function(value) {
          ifelse(
            value &lt; 0.001, sprintf(&quot;%.2e&quot;, value), sprintf(&quot;%.3f&quot;, value)
          )
        },
        maxWidth = 70
      ),
      adj_p = colDef(
        name = &quot;p&lt;sub&gt;adj&lt;/sub&gt;&quot;, html = TRUE,
        cell = function(value) {
          ifelse(
            value &lt; 0.001, sprintf(&quot;%.2e&quot;, value), sprintf(&quot;%.3f&quot;, value)
          )
        },
        maxWidth = 70
      ),
      &quot;Genes Mapped to Gained Windows&quot; = colDef(
        cell = function(value) with_tooltip(value, width = 100),
        minWidth = 200
      )
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<caption>
<em>
All 3 gene sets considered as 
significantly enriched (p
<sub>adj</sub>
<em> &lt; 0.05) amongst the windows showing evidence of increased 
H3K27ac binding. Genes mapped to an increasing window were 
compared to those mapped to any merged window. A standard (unbiased)
hypergeomtric test was used to test for enrichment.</em>
</em>
</caption>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-071ab3135fee4e75bb84" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-071ab3135fee4e75bb84">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Gene Set":["HALLMARK_ESTROGEN_RESPONSE_EARLY","HES2_TARGET_GENES","HALLMARK_ESTROGEN_RESPONSE_LATE"],"Description":["Genes defining early response to estrogen.","Genes containing one or more binding sites for UniProt:Q9Y543 (HES2) in their promoter regions (TSS -1000,+100 bp) as identified by GTRD version 20.06 ChIP-seq harmonization.","Genes defining late response to estrogen."],"%":[0.10795454545454546,0.05568181818181818,0.085365853658536592],"numDEInCat":[19,49,14],"numInCat":[176,880,164],"p":[1.4296225109096961e-07,2.3811667536190385e-07,9.1162570930365287e-05],"adj_p":[0.00016025252251856129,0.00016025252251856129,0.04090160682409056],"Genes Mapped to Gained Windows":["AQP3: CHPT1: DEPTOR: FKBP5: FLNB: GFRA1: INPP5F: KDM4B: MYBL1: PPIF: RAB31: SCNN1A: SEC14L2: SLC1A4: SLC7A2: SULT2B1: SYBU: TMEM164: WWC1","ABHD12: AQP3: ARID5B: ATF6: BDP1: C1orf21: C2orf76: CDK5RAP2: CECR2: CRYBG1: CUEDC1: CYB5A: DIO2: DLEU2: EHF: EIF2S3: EML2: FLNB: GCLC: HBP1: HDAC5: IQGAP2: KIAA0232: LRBA: MCCC2: MRPS23: MTMR12: MTMR9: NEDD4L: NFIC: NFKBIA: NFX1: NR4A1: NRP1: P4HA2: PTPRM: RAB31: RCL1: SCNN1A: SGK3: SH3BP4: SLC38A1: SMIM14: SQOR: SYBU: TEX2: TMSB4X: TNFRSF1A: VWA8","CD9: CHPT1: EMP2: FKBP5: FLNB: HOMER2: PPIF: PRLR: RAB31: SCNN1A: SLC1A4: SORD: SULT2B1: UGDH"]},"columns":[{"id":"Gene Set","name":"Gene Set","type":"character","cell":[{"name":"a","attribs":{"href":null,"target":"_blank"},"children":["HALLMARK ESTROGEN RESPONSE EARLY"]},{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["HES2 TARGET GENES"]},{"name":"a","attribs":{"href":null,"target":"_blank"},"children":["HALLMARK ESTROGEN RESPONSE LATE"]}],"html":true,"minWidth":150},{"id":"Description","name":"Description","type":"character","cell":[{"name":"span","attribs":{"title":"Genes defining early response to estrogen."},"children":["Genes defining early response to estrogen."]},{"name":"span","attribs":{"title":"Genes containing one or more binding sites for UniProt:Q9Y543 (HES2) in their promoter regions (TSS -1000,+100 bp) as identified by GTRD version 20.06 ChIP-seq harmonization."},"children":["Genes containing one or more binding sites for UniProt:Q9Y543 (HES2) in their promoter regions (T..."]},{"name":"span","attribs":{"title":"Genes defining late response to estrogen."},"children":["Genes defining late response to estrogen."]}],"minWidth":150},{"id":"%","name":"% Gained","type":"numeric","cell":["10.8%","5.6%","8.5%"],"maxWidth":80},{"id":"numDEInCat","name":"Mapped to Gained Windows","type":"numeric","maxWidth":80},{"id":"numInCat","name":"Total Mapped","type":"numeric","cell":["176","880","164"],"maxWidth":80},{"id":"p","name":"p","type":"numeric","cell":["1.43e-07","2.38e-07","9.12e-05"],"maxWidth":70},{"id":"adj_p","name":"p<sub>adj<\/sub>","type":"numeric","cell":["1.60e-04","1.60e-04","0.041"],"html":true,"maxWidth":70},{"id":"Genes Mapped to Gained Windows","name":"Genes Mapped to Gained Windows","type":"character","cell":[{"name":"span","attribs":{"title":"AQP3: CHPT1: DEPTOR: FKBP5: FLNB: GFRA1: INPP5F: KDM4B: MYBL1: PPIF: RAB31: SCNN1A: SEC14L2: SLC1A4: SLC7A2: SULT2B1: SYBU: TMEM164: WWC1"},"children":["AQP3: CHPT1: DEPTOR: FKBP5: FLNB: GFRA1: INPP5F: KDM4B: MYBL1: PPIF: RAB31: SCNN1A: SEC14L2: SLC1..."]},{"name":"span","attribs":{"title":"ABHD12: AQP3: ARID5B: ATF6: BDP1: C1orf21: C2orf76: CDK5RAP2: CECR2: CRYBG1: CUEDC1: CYB5A: DIO2: DLEU2: EHF: EIF2S3: EML2: FLNB: GCLC: HBP1: HDAC5: IQGAP2: KIAA0232: LRBA: MCCC2: MRPS23: MTMR12: MTMR9: NEDD4L: NFIC: NFKBIA: NFX1: NR4A1: NRP1: P4HA2: PTPRM: RAB31: RCL1: SCNN1A: SGK3: SH3BP4: SLC38A1: SMIM14: SQOR: SYBU: TEX2: TMSB4X: TNFRSF1A: VWA8"},"children":["ABHD12: AQP3: ARID5B: ATF6: BDP1: C1orf21: C2orf76: CDK5RAP2: CECR2: CRYBG1: CUEDC1: CYB5A: DIO2:..."]},{"name":"span","attribs":{"title":"CD9: CHPT1: EMP2: FKBP5: FLNB: HOMER2: PPIF: PRLR: RAB31: SCNN1A: SLC1A4: SORD: SULT2B1: UGDH"},"children":["CD9: CHPT1: EMP2: FKBP5: FLNB: HOMER2: PPIF: PRLR: RAB31: SCNN1A: SLC1A4: SORD: SULT2B1: UGDH"]}],"minWidth":200}],"filterable":true,"showPageSizeOptions":true,"dataKey":"bb2baba6769cfebaecec4045d6bcdeca"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
<div id="windows-with-decreased-h3k27ac-binding"
class="section level2 tabset">
<h2 class="tabset">Windows With Decreased H3K27ac Binding</h2>
<pre class="r"><code>pwf_down &lt;- tibble(gene_id  = unique(genes_gr$gene_id)) %&gt;% 
  left_join(mapped_ids, by = &quot;gene_id&quot;) %&gt;% 
  dplyr::filter(!is.na(n_peaks)) %&gt;% 
  mutate(diff = down) %&gt;% 
  with(
    nullp(
      structure(diff, names = gene_id),
      genome = config$genome$build,
      bias.data = log1p(n_peaks),
      plot.fit = FALSE
    )
  )
goseq_down &lt;- tibble(gs_name = character(), pval = numeric(), adj_p = numeric())
if (sum(pwf_down$DEgenes) &gt; 0) {
  goseq_down &lt;- goseq(
    pwf_down, config$genome$build, gene2cat = gs_by_geneid, method = &quot;Hypergeometric&quot;
  ) %&gt;% 
    dplyr::rename(gs_name = category, pval = over_represented_pvalue) %&gt;% 
    dplyr::select(-starts_with(&quot;under&quot;)) %&gt;% 
    as_tibble() %&gt;% 
    arrange(pval) %&gt;% 
    dplyr::filter(numDEInCat &gt; 0) %&gt;% 
    mutate(adj_p = p.adjust(pval, adj_method)) %&gt;% 
    dplyr::filter(numDEInCat &gt;= min_sig)
}
any_goseq_down &lt;- sum(goseq_down$adj_p &lt; enrich_alpha) &gt; 0
tg_down &lt;- make_tbl_graph(
  goseq_down, 
  gs = gs_by_gsid %&gt;% 
    lapply(intersect, rownames(subset(pwf_down, DEgenes))) %&gt;%
    .[vapply(., length, integer(1)) &gt; 0]
)
plot_network_down &lt;- length(tg_down) &gt;= min_network_size</code></pre>
<p>No enrichment was found amongst genes mapped to sites showing
decreased H3K27ac binding</p>
</div>
</div>
<div id="comparison-with-rna-seq" class="section level1">
<h1>Comparison With RNA Seq</h1>
<pre class="r"><code>library(fgsea)
library(metap)
rna_status &lt;- rnaseq %&gt;% 
  mutate(
    de_status = case_when(
      !!sym(rna_fdr_col) &lt; fdr_alpha &amp; !!sym(rna_lfc_col) &lt; 0 ~ &quot;Down&quot;,
      !!sym(rna_fdr_col) &lt; fdr_alpha &amp; !!sym(rna_lfc_col) &gt; 0 ~ &quot;Up&quot;,
      !!sym(rna_fdr_col) &gt;= fdr_alpha ~ &quot;Unchanged&quot;
    )
  ) %&gt;% 
  dplyr::select(gene_id, gene_name, de_status) %&gt;% 
  bind_rows(
    genes_gr %&gt;% 
      subset(!gene_id %in% rnaseq$gene_id) %&gt;% 
      select(gene_id, gene_name) %&gt;% 
      mcols() %&gt;% 
      as_tibble() %&gt;% 
      mutate(de_status = &quot;Undetected&quot;)
  ) %&gt;% 
  mutate(
    de_status = factor(
      de_status, levels = str_to_title(names(colours$direction))
    )
  ) %&gt;% 
  arrange(gene_id)
rna_p_col &lt;- colnames(rnaseq)[
  str_detect(str_to_lower(colnames(rnaseq)), &quot;pval|p\\.val&quot;)
][1]
stopifnot(length(rna_p_col) == 1)
diff_windows &lt;- merged_results %&gt;% 
  splitAsList(.$status) %&gt;% 
  lapply(select, gene_id) %&gt;% 
  lapply(mcols) %&gt;% 
  lapply(as_tibble) %&gt;% 
  lapply(pull, &quot;gene_id&quot;) %&gt;% 
  lapply(unlist) %&gt;% 
  lapply(unique)</code></pre>
<div id="distribution-of-detected-genes" class="section level2 tabset">
<h2 class="tabset">Distribution Of Detected Genes</h2>
<div id="detected-genes-by-h3k27ac-binding-region"
class="section level3">
<h3>Detected Genes By H3K27ac Binding Region</h3>
<p>The distribution of merged windows, where H3K27ac was considered as
present, was firstly compared to genes within the RNA-Seq dataset. Genes
were simply considered as detected if present in the RNA-Seq data, or
undetected if not present. Gene-centric regions were as defined
previously.</p>
<pre class="r"><code>w &lt;- 0.8
min_p &lt;- 0.025
merged_results %&gt;%
  mutate(
    any_detected = ifelse(
      vapply(gene_name, length, integer(1)) &gt; 1,
      &quot;Mapped to Detected Genes&quot;,
      &quot;Mapped to Undetected Genes&quot;
    )
  ) %&gt;% 
  plotPie(fill = &quot;region&quot;, x = &quot;any_detected&quot;, label_size = 4, width = w) +
  geom_text(
    aes(xlab, ylab, label =lab),
    data = . %&gt;% 
      mutate(
        xlab = x + w*(r + 0.1)*sin(label_radians),
        ylab = 1 + w*(r + 0.1)*cos(label_radians),
        lab = glue(&quot;{region}\n{percent(p, 0.1)}&quot;) %&gt;% 
          str_wrap(10)
      ) %&gt;% 
      dplyr::filter(p * N &gt; min_p * max(N)),
    size = 3
  ) +
  geom_segment(
    aes(x_inner, y_inner, xend = x_outer, yend = y_outer),
     data = . %&gt;% 
      mutate(
        x_inner = x + w*r*sin(label_radians),
        y_inner = 1 + w*r*cos(label_radians),
        x_outer = x + w*(r + 0.01)*sin(label_radians),
        y_outer = 1 + w*(r + 0.01)*cos(label_radians),
      ) %&gt;% 
      dplyr::filter(p * N &gt; min_p * max(N))
  ) +
  scale_fill_manual(
    values = colours$regions %&gt;% 
      setNames(regions[names(.)]) 
  ) +
  labs(x = &quot;&quot;, fill = &quot;Region&quot;) +
  theme(panel.grid = element_blank())</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-region-detected-1.png" alt="*Distribution of H3K27ac-bound windows by region, according to whether the window is mapped to a detected gene in the RNA-Seq dataset.*" width="960" />
<p class="caption">
<em>Distribution of H3K27ac-bound windows by region, according to
whether the window is mapped to a detected gene in the RNA-Seq
dataset.</em>
</p>
</div>
</div>
<div id="detected-genes-by-feature" class="section level3">
<h3>Detected Genes By Feature</h3>
<pre class="r"><code>merged_results %&gt;% 
  mutate(
    any_detected = ifelse(
      vapply(gene_name, length, integer(1)) &gt; 1,
      &quot;Mapped to Detected Genes&quot;,
      &quot;Mapped to Undetected Genes&quot;
    )
  ) %&gt;% 
  plotPie(fill = &quot;feature&quot;, x = &quot;any_detected&quot;, label_size = 4, width = w) +
  geom_text(
    aes(xlab, ylab, label =lab),
    data = . %&gt;% 
      mutate(
        xlab = x + w*(r + 0.1)*sin(label_radians),
        ylab = 1 + w*(r + 0.1)*cos(label_radians),
        lab = glue(&quot;{feature}\n{percent(p, 0.1)}&quot;) %&gt;% 
          str_wrap(10)
      ) %&gt;% 
      dplyr::filter(p * N &gt; min_p * max(N)),
    size = 3
  ) +
  geom_segment(
    aes(x_inner, y_inner, xend = x_outer, yend = y_outer),
     data = . %&gt;% 
      mutate(
        x_inner = x + w*r*sin(label_radians),
        y_inner = 1 + w*r*cos(label_radians),
        x_outer = x + w*(r + 0.01)*sin(label_radians),
        y_outer = 1 + w*(r + 0.01)*cos(label_radians),
      ) %&gt;% 
      dplyr::filter(p * N &gt; min_p * max(N))
  ) +
  scale_fill_manual(
    values = colours$features %&gt;% 
      setNames(str_sep_to_title(names(.)))
  ) +
  labs(x = &quot;&quot;, fill = &quot;External Feature&quot;) +
  theme(panel.grid = element_blank())</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-feature-detected-1.png" alt="*Distribution of H3K27ac-bound windows by externally-defined features from enhancer_atlas_2.0_zr75.gtf.gz, according to whether the window is mapped to a detected gene in the RNA-Seq dataset.*" width="960" />
<p class="caption">
<em>Distribution of H3K27ac-bound windows by externally-defined features
from enhancer_atlas_2.0_zr75.gtf.gz, according to whether the window is
mapped to a detected gene in the RNA-Seq dataset.</em>
</p>
</div>
</div>
</div>
<div id="relationship-with-differentially-expressed-genes"
class="section level2 tabset">
<h2 class="tabset">Relationship With Differentially Expressed Genes</h2>
<pre class="r"><code>rna_dir_ranks &lt;- rnaseq %&gt;% 
  mutate(
    ranking_stat = -sign(!!sym(rna_lfc_col))*log10(!!sym(rna_p_col)) %&gt;% 
      setNames(gene_id)
  ) %&gt;% 
  arrange(ranking_stat) %&gt;% 
  dplyr::filter(!!sym(rna_p_col) &lt; 1) %&gt;% 
  pull(&quot;ranking_stat&quot;) 
rna_sig_ranks &lt;- rna_dir_ranks %&gt;% 
  abs() %&gt;% 
  sort()
dir_gs &lt;- merged_results %&gt;% 
  select(status, starts_with(&quot;gene&quot;)) %&gt;% 
  as_tibble() %&gt;% 
  mutate(group = glue(&quot;{target} {status}&quot;)) %&gt;% 
  split(.$group)%&gt;% 
  lapply(pull, &quot;gene_id&quot;) %&gt;% 
  lapply(unlist) %&gt;% 
  lapply(unique) %&gt;% 
  .[vapply(., length, integer(1)) &gt;= min_gs_size]
reg_dir_gs &lt;- merged_results %&gt;% 
  select(
    overlaps_ref, status, any_of(c(&quot;region&quot;, &quot;feature&quot;)), starts_with(&quot;gene&quot;)
  ) %&gt;% 
  as_tibble() %&gt;% 
  mutate(group = glue(&quot;{region} / {target} {status}&quot;)) %&gt;% 
  split(.$group)%&gt;% 
  lapply(pull, &quot;gene_id&quot;) %&gt;% 
  lapply(unlist) %&gt;% 
  lapply(unique) %&gt;% 
  .[vapply(., length, integer(1)) &gt;= min_gs_size]
if (has_features) {
  feat_dir_gs &lt;- merged_results %&gt;% 
  select(
    overlaps_ref, status, any_of(c(&quot;feature&quot;)), starts_with(&quot;gene&quot;)
  ) %&gt;% 
  as_tibble() %&gt;% 
  mutate(group = glue(&quot;{feature} / {target} {status}&quot;)) %&gt;% 
  split(.$group)%&gt;% 
  lapply(pull, &quot;gene_id&quot;) %&gt;% 
  lapply(unlist) %&gt;% 
  lapply(unique) %&gt;% 
  .[vapply(., length, integer(1)) &gt;= min_gs_size]
}</code></pre>
<div id="de-genes-associated-with-changed-h3k27ac-binding"
class="section level3">
<h3>DE Genes Associated with Changed H3K27ac Binding</h3>
<pre class="r"><code>de_genes_db_regions &lt;- tibble()
any_diff_sites &lt;- sum(mcols(merged_results)[[fdr_column]] &lt; fdr_alpha) &gt; 0
any_de &lt;- any(rnaseq$DE)
para &lt;- &quot;&quot;
if (any_de &amp; any_diff_sites) {
  ft_data &lt;- rnaseq %&gt;%
    dplyr::filter(gene_id %in% unlist(diff_windows)) %&gt;% 
    mutate(
      window = case_when(
        gene_id %in% unlist(diff_windows[c(&quot;Up&quot;, &quot;Down&quot;)]) ~ &quot;Diff&quot;,
        TRUE ~ &quot;Unchanged&quot;
      ) %&gt;%
        fct_infreq()
    ) %&gt;% 
    group_by(DE, window) %&gt;% 
    tally() %&gt;% 
    pivot_wider(
      names_from = &quot;DE&quot;, values_from = &quot;n&quot;, 
      names_prefix = &quot;DE_&quot;, values_fill = 0
    ) %&gt;% 
    as.data.frame() %&gt;% 
    column_to_rownames(&quot;window&quot;) %&gt;% 
    as.matrix()
  ft &lt;- fisher.test(ft_data)
  para &lt;- glue(
    &quot;
    Using the {comma(length(unique(unlist(diff_windows))))} genes mapped to a 
    {target} binding site, genes were tested for any association between sites 
    showing evidence of diferential binding and differential expression.
    {comma(length(unique(unlist(diff_windows[c(&#39;Up&#39;, &#39;Down&#39;)]))))} genes were 
    mapped to at least one site showing differential {target} binding with 
    {comma(ft_data[&#39;Diff&#39;, &#39;DE_TRUE&#39;])} 
    ({percent(ft_data[&#39;Diff&#39;, &#39;DE_TRUE&#39;] / sum(ft_data[&#39;Diff&#39;,]))}) of these
    being considered differentially expressed. This compares to 
    {percent(ft_data[&#39;Unchanged&#39;, &#39;DE_TRUE&#39;] / sum(ft_data[&#39;Unchanged&#39;, ]), 0.1)}
    of genes where no differential {target} binding was detected. Fisher&#39;s 
    Exact test for any association gave this a p-value of 
    {ifelse(ft$p.value &lt; 0.01, sprintf(&#39;%.2e&#39;, ft$p.value), round(ft$p.value, 3))}.
    &quot;
  )
}</code></pre>
<p>Using the 12,436 genes mapped to a H3K27ac binding site, genes were
tested for any association between sites showing evidence of diferential
binding and differential expression. 323 genes were mapped to at least
one site showing differential H3K27ac binding with 32 (10%) of these
being considered differentially expressed. This compares to 0.7% of
genes where no differential H3K27ac binding was detected. Fisher’s Exact
test for any association gave this a p-value of 8.83e-25.</p>
<pre class="r"><code>cmn_genes &lt;- intersect(
  rnaseq %&gt;% dplyr::filter(!!sym(rna_fdr_col) &lt; fdr_alpha) %&gt;% pull(&quot;gene_id&quot;),
  merged_results %&gt;% 
    filter(!!sym(fdr_column) &lt; fdr_alpha) %&gt;% 
    as_tibble() %&gt;% 
    pull(&quot;gene_id&quot;) %&gt;% 
    unlist()
)
de_genes_db_regions &lt;- merged_results %&gt;% 
  filter(!!sym(fdr_column) &lt; fdr_alpha) %&gt;% 
  filter(vapply(gene_id, function(x) any(x %in% cmn_genes), logical(1))) %&gt;% 
  as_tibble() %&gt;% 
  dplyr::select(
    range, ChIP_logCPM = AveExpr, ChIP_logFC = logFC, ChIP_FDR := !!sym(fdr_column), overlaps_ref,
    status, any_of(c(&quot;region&quot;, &quot;feature&quot;)), gene_id
  ) %&gt;% 
  unnest(gene_id) %&gt;% 
  dplyr::filter(gene_id %in% cmn_genes) %&gt;% 
  left_join(
    rnaseq %&gt;% 
      dplyr::filter(gene_id %in% cmn_genes) %&gt;% 
      dplyr::select(
        all_of(c(&quot;gene_id&quot;, &quot;gene_name&quot;)), 
        RNA_logFC := !!sym(rna_lfc_col), RNA_FDR := !!sym(rna_fdr_col)
      ),
    by = &quot;gene_id&quot;
  ) %&gt;% 
  arrange(RNA_FDR) %&gt;% 
  # dplyr::slice(1:20) %&gt;%
  mutate(
    dist2Gene = mapply(
      function(x, y) {
        distance(GRanges(x), subset(genes_gr, gene_id == y)) 
      },
      x = range,
      y = gene_id
    )
  ) %&gt;% 
  mutate(
    region = case_when(
      dist2Gene &gt; params$gene_regions$upstream &amp; str_detect(region, &quot;Promoter|Exon|Intron&quot;) ~ paste(
        str_extract(region, &quot;.*(Promoter|Exon|Intron)&quot;), &quot;(Other Gene)&quot;),
      TRUE ~ as.character(region)
    ),
    region = factor(
      region, 
      levels = c(
        levels(merged_results$region), 
        paste(
          str_extract(levels(merged_results$region), &quot;.*(Promoter|Exon|Intron)&quot;), 
          &quot;(Other Gene)&quot;
        )
      ) %&gt;% 
        unique()
    )
  ) %&gt;% 
  dplyr::select(
    gene_name, gene_id, starts_with(&quot;RNA&quot;), range, dist2Gene, 
    starts_with(&quot;ChIP&quot;), everything()
  ) %&gt;% 
  droplevels()</code></pre>
<pre class="r"><code>range_js &lt;- JS(
  &quot;function(values) {
    var min_val = Math.round(100 * Math.min(...values)) / 100
    var max_val = Math.round(100 * Math.max(...values)) / 100
    if (min_val == max_val) {
      var ret_val = min_val.toString()
    } else {
      var ret_val = &#39;[&#39; + min_val.toString() + &#39;, &#39; + max_val.toString() + &#39;]&#39;
    }
    return ret_val
  }&quot;
)
max_signal &lt;- max(merged_results$AveExpr)
feat_def &lt;- NULL
if (has_features) feat_def = list(
  feature = colDef (
    name = &quot;Feature&quot;,
    aggregate = &quot;unique&quot;
  )
)
cp &lt;-  htmltools::em(
  glue(
    &quot;
    Differentially Expressed (DE) genes were checked for {target} binding
    regions which showed evidence of changed binding. 
    {comma(length(unique(de_genes_db_regions$range)), 1)} unique regions were 
    mapped to {comma(length(unique(de_genes_db_regions$gene_id)), 1)} DE genes. 
    Data are presented in a gene-centric manner and ranges may map to multiple
    genes. The full set of ranges considered to be showing evidence of altered 
    {target} binding are shown for each gene. The summarised range containing 
    all mapped ranges is given in the collapsed row, along with the range of 
    distances to gene and the range of signal levels. In the collapsed row, the 
    value for logFC represents the average across all mapped regions, with the 
    maximum FDR also shown. If {target} binding occurs within another gene this 
    is indicated in the &#39;Region&#39; column.
    All sites and genes were exported as {basename(all_out$de_genes)}.
    &quot;
  )
)
fs &lt;- 12
tbl &lt;- de_genes_db_regions %&gt;% 
  reactable(
    groupBy = &quot;gene_name&quot;,
    filterable = TRUE,
    borderless = TRUE,
    showPageSizeOptions = TRUE,
    columns = c(
      list(
        gene_name = colDef(
          name = &quot;Gene&quot;, maxWidth = fs*11,
          style = list(
            borderRight = &quot;1px solid rgba(0, 0, 0, 0.1)&quot;,
            fontSize = fs
          )
        ),
        gene_id = colDef(
          name = &quot;ID&quot;, aggregate = &quot;unique&quot;, cell = function(value) &quot;&quot;,
          show = FALSE
        ),
        RNA_logFC = colDef(
          name = &quot;logFC&quot;,
          aggregate = &quot;mean&quot;, 
          style = JS(
            glue(
            &quot;function(rowInfo) {
              var value = rowInfo.row[&#39;RNA_logFC&#39;]
              if (value &lt; 0) {
                var color = &#39;{{direction_colours[[&#39;Down&#39;]]}}&#39;
              } else if (value &gt; 0) {
                var color = &#39;{{direction_colours[[&#39;Up&#39;]]}}&#39;
              } else {
                var color = &#39;#000000&#39;
              }
              return { color: color, fontSize: {{fs}} }
            }&quot;,
            .open = &quot;{{&quot;, .close = &quot;}}&quot;
            )
          ),
          format = colFormat(digits= 2),
          maxWidth = fs*6,
          cell = function(value) &quot;&quot;
        ),
        RNA_FDR = colDef(
          name = &quot;FDR&quot;,
          aggregate = &quot;min&quot;,
          format = colFormat(digits = 4),
          maxWidth = fs*6,
          cell = function(value) &quot;&quot;,
          style = list(
            borderRight = &quot;1px solid rgba(0, 0, 0, 0.1)&quot;, 
            fontSize = fs
          )
        ),
        range = colDef(
          name = &quot;Range&quot;,
          minWidth = 160,
          aggregate = JS(
            &quot;function(values){
              var chrom = [];
              var rng = [];
              var start = [];
              var end = [];
              for (i = 0; i &lt; values.length; i++) {
                chrom[i] = values[i].split(&#39;:&#39;)[0];
                rng[i] = values[i].split(&#39;:&#39;)[1];
                start[i] = rng[i].split(&#39;-&#39;)[0];
                end[i] = rng[i].split(&#39;-&#39;)[1];
              }
              
              min_start = Math.min(...start);
              max_end = Math.max(...end);
              var ret_val = [...new Set(chrom)] + &#39;:&#39; + min_start.toString() + &#39;-&#39; + max_end.toString();
              
              return ret_val
              
            }&quot;
          )
        ),
        dist2Gene = colDef(
          name = &quot;Distance to Gene&quot;,
          aggregate = range_js,
          format = colFormat(digits = 0, separators = TRUE),
          maxWidth = fs*8,
          style = list(
            borderRight = &quot;1px solid rgba(0, 0, 0, 0.1)&quot;,
            fontSize = fs
          ),
        ),
        ChIP_logCPM = colDef(
          name = &quot;logCPM&quot;,
          maxWidth = fs*6,
          aggregate = range_js,
          format = colFormat(digits = 2),
          style = function(value) bar_style(
            width = value / max_signal, fontSize = fs
          )
        ),
        ChIP_logFC = colDef(
          name = &quot;logFC&quot;,
          aggregate = &quot;mean&quot;,
          maxWidth = fs*5,
          format = colFormat(digits = 2),
          cell = function(value) sprintf(&quot;%.2f&quot;, value),
          style =  JS(
            glue(
            &quot;function(rowInfo) {
              var value = rowInfo.row[&#39;ChIP_logFC&#39;]
              if (value &lt; 0) {
                var color = &#39;{{direction_colours[[&#39;Down&#39;]]}}&#39;
              } else if (value &gt; 0) {
                var color = &#39;{{direction_colours[[&#39;Up&#39;]]}}&#39;
              } else {
                var color = &#39;#000000&#39;
              }
              return { color: color, fontSize: {{fs}} }
            }&quot;,
            .open = &quot;{{&quot;, .close = &quot;}}&quot;
            )
          )
        ),
        ChIP_FDR = colDef(
          name = &quot;FDR&quot;,
          aggregate = &quot;max&quot;,
          maxWidth = 10 + fs*5,
          format = colFormat(prefix = &quot;&lt; &quot;, digits = 4),
          cell = function(value) ifelse(
            value &lt; 0.001,
            sprintf(&quot;%.2e&quot;, value),
            sprintf(&quot;%.3f&quot;, value)
          )
        ),
        overlaps_ref = colDef(
          name = &quot;Macs Peak&quot;,
          show = FALSE,
          aggregate = &quot;frequency&quot;,
          cell = function(value) ifelse(value, &quot;\u2714 Yes&quot;, &quot;\u2716 No&quot;),
          style = function(value) {
            color &lt;- ifelse(value, &quot;#008000&quot;, &quot;#e00000&quot;)
            list(color = color, fontSize = fs)
          },
          maxWidth = fs*5
        ),
        status = colDef(
          name = &quot;Status&quot;,
          aggregate = &quot;frequency&quot;,
          maxWidth = fs*6,
          cell = function(value) {
            html_symbol &lt;- &quot;&quot;
            if (str_detect(value, &quot;Up&quot;)) html_symbol &lt;- &quot;\u21E7&quot;
            if (str_detect(value, &quot;Down&quot;)) html_symbol &lt;- &quot;\u21E9&quot;
            paste(html_symbol, value)
          },
          style = JS(
            glue(
            &quot;function(rowInfo) {
              var value = rowInfo.row[&#39;ChIP_logFC&#39;]
              if (value &lt; 0) {
                var color = &#39;{{direction_colours[[&#39;Down&#39;]]}}&#39;
              } else if (value &gt; 0) {
                var color = &#39;{{direction_colours[[&#39;Up&#39;]]}}&#39;
              } else {
                var color = &#39;#000000&#39;
              }
              return { color: color, fontSize: {{fs}} }
            }&quot;,
            .open = &quot;{{&quot;, .close = &quot;}}&quot;
            )
          )
        ),
        region = colDef(
          name = &quot;Binding Region&quot;,
          aggregate = &quot;unique&quot;
        )
      ),
      feat_def
    ),
    columnGroups = list(
      colGroup(name = &quot;RNA-Seq&quot;, columns = c(&quot;RNA_logFC&quot;, &quot;RNA_FDR&quot;)),
      colGroup(
        name = paste(target, &quot;ChIP-Seq&quot;), 
        columns = c(&quot;ChIP_logCPM&quot;, &quot;ChIP_logFC&quot;, &quot;ChIP_FDR&quot;, &quot;status&quot;)
      )
    ),
    theme = reactableTheme(style = list(fontSize = fs))
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Differentially Expressed (DE) genes were checked for H3K27ac binding
regions which showed evidence of changed binding. 
52 unique regions were 
mapped to 32 DE genes. 
Data are presented in a gene-centric manner and ranges may map to multiple
genes. The full set of ranges considered to be showing evidence of altered 
H3K27ac binding are shown for each gene. The summarised range containing 
all mapped ranges is given in the collapsed row, along with the range of 
distances to gene and the range of signal levels. In the collapsed row, the 
value for logFC represents the average across all mapped regions, with the 
maximum FDR also shown. If H3K27ac binding occurs within another gene this 
is indicated in the 'Region' column.
All sites and genes were exported as H3K27ac_E2_E2DHT-DE_genes.csv.</em>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-9b2b6af56b6caa3f87ff" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9b2b6af56b6caa3f87ff">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"gene_name":["AQP3","AQP3","UGDH","UGDH","FKBP5","FKBP5","FKBP5","FKBP5","FKBP5","SEC14L2","RANBP3L","RANBP3L","HSD11B2","AC021148.3","AC021148.3","ZNF652","ZNF689","EHF","EHF","ARHGEF37","ARHGEF37","ARHGEF37","ARHGEF37","NRP1","AL033523.1","TTC12","PTPRJ","KDM4B","SYBU","SYBU","NEDD4L","NEDD4L","NEDD4L","CSRNP1","GPCPD1","WWC1","SASH1","DIO2","DIO2","AKAP13","AKAP13","CRYBG1","CRYBG1","CD9","CD9","SPRED1","VSTM2L","IQGAP2","PRKAB2","PRKAB2","TMEM164","TMEM164","NFKBIA","NFKBIA"],"gene_id":["ENSG00000165272","ENSG00000165272","ENSG00000109814","ENSG00000109814","ENSG00000096060","ENSG00000096060","ENSG00000096060","ENSG00000096060","ENSG00000096060","ENSG00000100003","ENSG00000164188","ENSG00000164188","ENSG00000176387","ENSG00000287262","ENSG00000287262","ENSG00000198740","ENSG00000156853","ENSG00000135373","ENSG00000135373","ENSG00000183111","ENSG00000183111","ENSG00000183111","ENSG00000183111","ENSG00000099250","ENSG00000228793","ENSG00000149292","ENSG00000149177","ENSG00000127663","ENSG00000147642","ENSG00000147642","ENSG00000049759","ENSG00000049759","ENSG00000049759","ENSG00000144655","ENSG00000125772","ENSG00000113645","ENSG00000111961","ENSG00000211448","ENSG00000211448","ENSG00000170776","ENSG00000170776","ENSG00000112297","ENSG00000112297","ENSG00000010278","ENSG00000010278","ENSG00000166068","ENSG00000132821","ENSG00000145703","ENSG00000131791","ENSG00000131791","ENSG00000157600","ENSG00000157600","ENSG00000100906","ENSG00000100906"],"RNA_logFC":[2.3694217784228075,2.3694217784228075,1.5219553586011434,1.5219553586011434,1.9989916696075092,1.9989916696075092,1.9989916696075092,1.9989916696075092,1.9989916696075092,2.6536480494766477,4.4057001853782669,4.4057001853782669,1.1383035024697568,3.3237998599929983,3.3237998599929983,0.76846273439691082,1.2120804850051532,0.59105033642913674,0.59105033642913674,0.95946664570342277,0.95946664570342277,0.95946664570342277,0.95946664570342277,0.62125204835983949,2.2137864683363677,0.75332249415079311,0.60123463986271897,0.73855715621635132,0.84070988458888962,0.84070988458888962,0.53717343669714313,0.53717343669714313,0.53717343669714313,0.72429045421256133,0.69938748809967766,0.56353098638065779,0.83602249900780767,1.4691900937544462,1.4691900937544462,0.50202678916631771,0.50202678916631771,0.48445966470898144,0.48445966470898144,0.45709384288830213,0.45709384288830213,0.46335634203522158,1.1965909914340669,0.68747223251921119,0.4776862698939684,0.4776862698939684,0.43087524428963114,0.43087524428963114,0.48617507638998542,0.48617507638998542],"RNA_FDR":[1.1692892572145723e-11,1.1692892572145723e-11,2.3405905788575905e-10,2.3405905788575905e-10,6.5078423559250725e-10,6.5078423559250725e-10,6.5078423559250725e-10,6.5078423559250725e-10,6.5078423559250725e-10,8.8689756271636755e-10,3.1449943242342671e-07,3.1449943242342671e-07,3.1449943242342671e-07,5.4163708602363581e-07,5.4163708602363581e-07,2.6349190543781581e-06,3.3074495881217472e-06,1.1335385070950072e-05,1.1335385070950072e-05,1.8113096972567875e-05,1.8113096972567875e-05,1.8113096972567875e-05,1.8113096972567875e-05,3.6436162860320297e-05,6.5239055808790969e-05,8.7986317484187263e-05,0.0001019525657750917,0.0001019525657750917,0.00019400293929134035,0.00019400293929134035,0.00032265242894288922,0.00032265242894288922,0.00032265242894288922,0.0003326452012648099,0.0003507099526110025,0.00056367394915331865,0.00067694285714587482,0.0035468576041831502,0.0035468576041831502,0.0055688949365209402,0.0055688949365209402,0.0072598693535531802,0.0072598693535531802,0.016165300141433709,0.016165300141433709,0.01692134046275541,0.017614009645174081,0.018344341741886181,0.025616417520557159,0.025616417520557159,0.033285366591985728,0.033285366591985728,0.038425695267583278,0.038425695267583278],"range":["chr9:33430321-33432640","chr9:33436601-33438360","chr4:39541241-39541960","chr4:39546001-39546440","chr6:35569081-35569400","chr6:35569961-35570440","chr6:35693961-35694080","chr6:35694721-35696480","chr6:35699281-35700360","chr22:30804281-30804920","chr5:36285521-36286080","chr5:36286281-36286760","chr16:67492721-67497800","chr4:39541241-39541960","chr4:39546001-39546440","chr17:47465881-47470640","chr16:30626361-30627200","chr11:34692601-34693920","chr11:34771361-34771960","chr5:148980201-148980640","chr5:148980801-148981240","chr5:148993201-148993800","chr5:148993921-148994400","chr10:33529841-33530560","chr6:3669521-3670280","chr11:113211081-113213880","chr11:48062921-48063600","chr19:4989481-4993480","chr8:110583201-110583400","chr8:110592561-110593440","chr18:55901441-55903320","chr18:55952361-55953040","chr18:55953241-55954000","chr3:39171481-39173080","chr20:5641241-5641880","chr5:167710481-167710960","chr6:148579241-148580160","chr14:80851641-80851800","chr14:80852121-80852320","chr15:86079801-86079920","chr15:86080641-86081560","chr6:106878841-106879160","chr6:106882121-106882640","chr12:6375481-6376440","chr12:6376601-6377320","chr15:38508481-38509080","chr20:36618201-36618800","chr5:75708841-75709520","chr1:146580761-146582200","chr1:146584881-146587360","chrX:109187361-109187720","chrX:109195481-109196320","chr14:35848001-35848400","chr14:35849041-35849240"],"dist2Gene":[8513,2793,11309,16069,0,0,0,0,2920,0,0,0,21264,0,0,26045,0,9996,88756,0,0,0,0,0,0,0,0,0,2806,0,0,0,0,10265,49588,7695,13279,0,0,0,0,0,0,28043,29163,35956,44448,0,44484,39324,58138,49538,22316,21476],"ChIP_logCPM":[1.4513887518949842,0.69336585756429436,0.88158471139458872,0.18985165413107127,0.14119288059530963,0.12662515261410665,-0.33525398737899614,1.4256828448331011,0.92176647397543632,0.45248237737860653,0.58593457053092313,0.43094159075469018,2.9091673907666475,0.88158471139458872,0.18985165413107127,3.9022802193623232,1.0043440301590385,1.1413892589117698,0.62921997740341085,0.34319280827156706,0.46491757327187139,0.61758380569280213,0.14955471362323344,0.72119827125321301,0.73328824613802079,2.0987109994088438,1.0040613267372969,1.9053065138417029,-0.062042787996550462,1.6689793156293196,1.0039929873559452,0.89744244013644747,0.33429310201982709,1.2324301748286062,0.61592846136052093,0.34659195802806675,1.6328912965950253,-0.051480141511274641,-0.16146969106111755,-0.091967412332285073,0.66573277176037404,-0.010137045303582051,0.4436162474288623,0.93686439256161069,0.76208932792550566,0.5344464270479018,0.65014356513704075,0.49196267380884351,1.1612398463226625,2.2100196203493221,0.19376578044921736,1.0485598652686863,-0.087820187555010532,-0.29326233666019608],"ChIP_logFC":[1.3984600235274756,1.6172472146368941,0.92844676046355012,1.5972439888885495,1.3045352955599547,1.8776824748182173,2.1636939837886264,1.1451286392100741,0.88863952720749062,1.5733449337711876,1.8640593875680262,1.6047900652189862,0.67659803097724702,0.92844676046355012,1.5972439888885495,0.59728187331143434,1.282542702795622,1.9615158692703409,1.2754698383086134,1.759394238114806,2.1174830277799699,1.3137074754793678,1.6550404782502088,1.142714344362636,1.4793745867131005,0.79749794131589669,1.0110062286304471,1.2580223282227676,1.3359473823287373,1.0768066741877536,0.90118807035537973,1.5432408395633046,1.1670313850069975,1.0957709060371872,0.95194746310781408,1.4288584379879188,0.93669442113524237,1.6560721275430927,1.2321612791018293,2.0653817096280287,1.5428260495160955,1.6897256955359927,1.0737183529968406,1.1273566938984847,1.0034457345223791,1.3590647567518133,1.2507235745135266,1.3575500877695472,2.1649163218197667,0.75602183986195548,1.1933040389494027,0.93916000026058288,2.1180771406175594,2.2626296749869002],"ChIP_FDR":[2.3324036210483527e-06,7.8225608549365211e-06,0.048336116906369082,0.0002312452933419626,0.0054807858737205284,7.8225608549365211e-06,0.00046641816374131664,0.00018001468063712659,0.040230104643007546,7.9216379588775297e-05,2.4632202622975069e-07,3.4559559210046053e-05,0.0055855855883287951,0.048336116906369082,0.0002312452933419626,0.00014808585511015757,0.00018610138704490422,2.4172161154951888e-10,0.0015837821232540425,5.9430737097006438e-06,8.8985430655940932e-09,0.00058412524151660197,0.00010234684855023142,0.0041205917478760812,4.3468155716681911e-05,0.012658723171565502,0.0135855394307685,8.5146651834556065e-07,0.0085354806303902849,0.00029603134296767118,0.02662694570690435,4.0149016481298463e-06,0.011724164740683172,0.0015437780409232309,0.049269222561070795,0.00049951293618727725,0.0038664047808076602,0.023443604918848889,0.036166520296419126,0.0001895841910483058,1.6274361003497607e-05,0.00020837938556357439,0.023093992205689116,0.0021711601843957531,0.016846678248287655,0.00055436532045714337,0.0011871270895851716,0.028169224719234283,2.2920119916353057e-12,0.0088375800101217969,0.015604795913651964,0.02330418324710894,2.6199264590734963e-06,0.00010999760865489126],"overlaps_ref":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"status":["Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up","Up"],"region":["Intergenic (<10kb)","Intergenic (<10kb)","Intron (Other Gene)","Exon (Other Gene)","Intron","Intron","Intron","Intron","Upstream Promoter (<5kb)","Promoter (-1500/+500bp)","Intron","Intron","Upstream Promoter (Other Gene)","Intron","Exon","Intron (Other Gene)","Promoter (-1500/+500bp)","Intergenic (>10kb)","Intergenic (<10kb)","Intron","Intron","Intron","Intron","Intron","Intron","Promoter (-1500/+500bp)","Upstream Promoter (<5kb)","Intron","Intergenic (<10kb)","Promoter (-1500/+500bp)","Intron","Intron","Intron","Promoter (Other Gene)","Intergenic (>10kb)","Intergenic (<10kb)","Intron (Other Gene)","Intron","Intron","Exon","Intron","Intron","Intron","Intergenic (<10kb)","Intergenic (<10kb)","Intron (Other Gene)","Intron (Other Gene)","Intron","Intron (Other Gene)","Intron (Other Gene)","Intergenic (>10kb)","Intergenic (>10kb)","Intergenic (<10kb)","Intergenic (<10kb)"],"feature":["Enhancer","No Feature","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","No Feature","No Feature","No Feature","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","No Feature","Enhancer","Enhancer","Enhancer","No Feature","No Feature","No Feature","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","No Feature","No Feature","No Feature","No Feature","Enhancer","No Feature","No Feature","Enhancer","No Feature","No Feature","No Feature","No Feature","No Feature","No Feature","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","Enhancer","No Feature","No Feature","No Feature","No Feature"]},"columns":[{"id":"gene_name","name":"Gene","type":"character","maxWidth":132,"style":{"borderRight":"1px solid rgba(0, 0, 0, 0.1)","fontSize":12}},{"id":"gene_id","name":"ID","type":"character","aggregate":"unique","show":false,"cell":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},{"id":"RNA_logFC","name":"logFC","type":"numeric","aggregate":"mean","format":{"cell":{"digits":2},"aggregated":{"digits":2}},"cell":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"maxWidth":72,"style":"function(rowInfo) {\n  var value = rowInfo.row['RNA_logFC']\n  if (value < 0) {\n    var color = '#0571B0'\n  } else if (value > 0) {\n    var color = '#CA0020'\n  } else {\n    var color = '#000000'\n  }\n  return { color: color, fontSize: 12 }\n}"},{"id":"RNA_FDR","name":"FDR","type":"numeric","aggregate":"min","format":{"cell":{"digits":4},"aggregated":{"digits":4}},"cell":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"maxWidth":72,"style":{"borderRight":"1px solid rgba(0, 0, 0, 0.1)","fontSize":12}},{"id":"range","name":"Range","type":"character","aggregate":"function(values){\n              var chrom = [];\n              var rng = [];\n              var start = [];\n              var end = [];\n              for (i = 0; i < values.length; i++) {\n                chrom[i] = values[i].split(':')[0];\n                rng[i] = values[i].split(':')[1];\n                start[i] = rng[i].split('-')[0];\n                end[i] = rng[i].split('-')[1];\n              }\n              \n              min_start = Math.min(...start);\n              max_end = Math.max(...end);\n              var ret_val = [...new Set(chrom)] + ':' + min_start.toString() + '-' + max_end.toString();\n              \n              return ret_val\n              \n            }","minWidth":160},{"id":"dist2Gene","name":"Distance to Gene","type":"numeric","aggregate":"function(values) {\n    var min_val = Math.round(100 * Math.min(...values)) / 100\n    var max_val = Math.round(100 * Math.max(...values)) / 100\n    if (min_val == max_val) {\n      var ret_val = min_val.toString()\n    } else {\n      var ret_val = '[' + min_val.toString() + ', ' + max_val.toString() + ']'\n    }\n    return ret_val\n  }","format":{"cell":{"digits":0,"separators":true},"aggregated":{"digits":0,"separators":true}},"maxWidth":96,"style":{"borderRight":"1px solid rgba(0, 0, 0, 0.1)","fontSize":12}},{"id":"ChIP_logCPM","name":"logCPM","type":"numeric","aggregate":"function(values) {\n    var min_val = Math.round(100 * Math.min(...values)) / 100\n    var max_val = Math.round(100 * Math.max(...values)) / 100\n    if (min_val == max_val) {\n      var ret_val = min_val.toString()\n    } else {\n      var ret_val = '[' + min_val.toString() + ', ' + max_val.toString() + ']'\n    }\n    return ret_val\n  }","format":{"cell":{"digits":2},"aggregated":{"digits":2}},"maxWidth":72,"style":[{"backgroundImage":"linear-gradient(90deg, #e6e6e6 29.2562525047955%, transparent 29.2562525047955%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 13.9764667327206%, transparent 13.9764667327206%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 17.7704732017887%, transparent 17.7704732017887%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 3.82691951033778%, transparent 3.82691951033778%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 2.84608418053573%, transparent 2.84608418053573%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 2.55243637068273%, transparent 2.55243637068273%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 -6.75785539552611%, transparent -6.75785539552611%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 28.7380877423324%, transparent 28.7380877423324%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 18.5804338623065%, transparent 18.5804338623065%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 9.12087727652206%, transparent 9.12087727652206%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 11.8109291699829%, transparent 11.8109291699829%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 8.68667059564597%, transparent 8.68667059564597%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 58.6413086444701%, transparent 58.6413086444701%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 17.7704732017887%, transparent 17.7704732017887%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 3.82691951033778%, transparent 3.82691951033778%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 78.6599009349312%, transparent 78.6599009349312%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 20.2449843363143%, transparent 20.2449843363143%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 23.0074625570753%, transparent 23.0074625570753%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 12.6834512916963%, transparent 12.6834512916963%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 6.91788154173963%, transparent 6.91788154173963%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 9.37153874163604%, transparent 9.37153874163604%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 12.4488960925394%, transparent 12.4488960925394%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 3.01463715998281%, transparent 3.01463715998281%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 14.5374963821772%, transparent 14.5374963821772%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 14.7811990824667%, transparent 14.7811990824667%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 42.3045988561853%, transparent 42.3045988561853%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 20.2392857647362%, transparent 20.2392857647362%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 38.4060634307697%, transparent 38.4060634307697%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 -1.25062252918707%, transparent -1.25062252918707%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 33.6423168634733%, transparent 33.6423168634733%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 20.2379082191308%, transparent 20.2379082191308%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 18.0901240986408%, transparent 18.0901240986408%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 6.73848642586908%, transparent 6.73848642586908%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 24.8426125269598%, transparent 24.8426125269598%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 12.4155286217606%, transparent 12.4155286217606%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 6.98639963067199%, transparent 6.98639963067199%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 32.9148755105714%, transparent 32.9148755105714%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 -1.0377068287666%, transparent -1.0377068287666%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 -3.25481236325385%, transparent -3.25481236325385%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 -1.85382574716319%, transparent -1.85382574716319%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 13.4194550191389%, transparent 13.4194550191389%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 -0.204336678692689%, transparent -0.204336678692689%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 8.94215897226941%, transparent 8.94215897226941%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 18.884768946809%, transparent 18.884768946809%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 15.3617545815263%, transparent 15.3617545815263%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 10.7730610421118%, transparent 10.7730610421118%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 13.1052168353813%, transparent 13.1052168353813%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 9.91669818929896%, transparent 9.91669818929896%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 23.407599182706%, transparent 23.407599182706%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 44.5482934665669%, transparent 44.5482934665669%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 3.90581819806003%, transparent 3.90581819806003%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 21.1362614906875%, transparent 21.1362614906875%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 -1.7702283959231%, transparent -1.7702283959231%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12},{"backgroundImage":"linear-gradient(90deg, #e6e6e6 -5.91141205984613%, transparent -5.91141205984613%)","backgroundSize":"100% 75%","backgroundRepeat":"no-repeat","backgroundPosition":"center","color":null,"fontSize":12}]},{"id":"ChIP_logFC","name":"logFC","type":"numeric","aggregate":"mean","format":{"cell":{"digits":2},"aggregated":{"digits":2}},"cell":["1.40","1.62","0.93","1.60","1.30","1.88","2.16","1.15","0.89","1.57","1.86","1.60","0.68","0.93","1.60","0.60","1.28","1.96","1.28","1.76","2.12","1.31","1.66","1.14","1.48","0.80","1.01","1.26","1.34","1.08","0.90","1.54","1.17","1.10","0.95","1.43","0.94","1.66","1.23","2.07","1.54","1.69","1.07","1.13","1.00","1.36","1.25","1.36","2.16","0.76","1.19","0.94","2.12","2.26"],"maxWidth":60,"style":"function(rowInfo) {\n  var value = rowInfo.row['ChIP_logFC']\n  if (value < 0) {\n    var color = '#0571B0'\n  } else if (value > 0) {\n    var color = '#CA0020'\n  } else {\n    var color = '#000000'\n  }\n  return { color: color, fontSize: 12 }\n}"},{"id":"ChIP_FDR","name":"FDR","type":"numeric","aggregate":"max","format":{"cell":{"prefix":"< ","digits":4},"aggregated":{"prefix":"< ","digits":4}},"cell":["2.33e-06","7.82e-06","0.048","2.31e-04","0.005","7.82e-06","4.66e-04","1.80e-04","0.040","7.92e-05","2.46e-07","3.46e-05","0.006","0.048","2.31e-04","1.48e-04","1.86e-04","2.42e-10","0.002","5.94e-06","8.90e-09","5.84e-04","1.02e-04","0.004","4.35e-05","0.013","0.014","8.51e-07","0.009","2.96e-04","0.027","4.01e-06","0.012","0.002","0.049","5.00e-04","0.004","0.023","0.036","1.90e-04","1.63e-05","2.08e-04","0.023","0.002","0.017","5.54e-04","0.001","0.028","2.29e-12","0.009","0.016","0.023","2.62e-06","1.10e-04"],"maxWidth":70},{"id":"overlaps_ref","name":"Macs Peak","type":"logical","aggregate":"frequency","show":false,"cell":["✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes","✔ Yes"],"maxWidth":60,"style":[{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12},{"color":"#008000","fontSize":12}]},{"id":"status","name":"Status","type":"factor","aggregate":"frequency","cell":["⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up"],"maxWidth":72,"style":"function(rowInfo) {\n  var value = rowInfo.row['ChIP_logFC']\n  if (value < 0) {\n    var color = '#0571B0'\n  } else if (value > 0) {\n    var color = '#CA0020'\n  } else {\n    var color = '#000000'\n  }\n  return { color: color, fontSize: 12 }\n}"},{"id":"region","name":"Binding Region","type":"factor","aggregate":"unique"},{"id":"feature","name":"Feature","type":"factor","aggregate":"unique"}],"columnGroups":[{"name":"RNA-Seq","columns":["RNA_logFC","RNA_FDR"]},{"name":"H3K27ac ChIP-Seq","columns":["ChIP_logCPM","ChIP_logFC","ChIP_FDR","status"]}],"groupBy":["gene_name"],"filterable":true,"showPageSizeOptions":true,"borderless":true,"theme":{"style":{"fontSize":12}},"dataKey":"6beb90e5719bdb189cc2b5a580236b5b"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.2.style","tag.attribs.columns.4.aggregate","tag.attribs.columns.5.aggregate","tag.attribs.columns.6.aggregate","tag.attribs.columns.7.style","tag.attribs.columns.10.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="volcano-plots-by-h3k27ac-binding" class="section level3">
<h3>Volcano Plots By H3K27ac Binding</h3>
<pre class="r"><code>diff_tbl &lt;- diff_windows %&gt;% 
  lapply(function(x) tibble(gene_id = x)) %&gt;% 
  bind_rows(.id = &quot;status&quot;)
rnaseq %&gt;% 
  left_join(diff_tbl) %&gt;% 
  mutate(
    status = str_replace_na(status, &quot;Undetected&quot;),
    status = glue(&quot;{target} {status}&quot;) %&gt;%
      factor(levels = paste(target, c(&quot;Up&quot;, &quot;Down&quot;, &quot;Ambiguous&quot;, &quot;Unchanged&quot;, &quot;Undetected&quot;)))
  ) %&gt;% 
  left_join(rna_status) %&gt;% 
  droplevels() %&gt;% 
  ggplot(
    aes(!!sym(rna_lfc_col), -log10(!!sym(rna_p_col)), colour = de_status)
  ) +
  geom_point() +
  geom_text_repel(
    aes(label = gene_name),
    data = . %&gt;% 
      dplyr::arrange(!!sym(rna_p_col)) %&gt;% 
      dplyr::filter(!!sym(rna_lfc_col) &gt; 0, DE) %&gt;% 
      split(.$status) %&gt;% 
      lapply(dplyr::slice, 1:2) %&gt;% 
      bind_rows(),
    show.legend = FALSE
  ) +
  geom_text_repel(
    aes(label = gene_name),
    data = . %&gt;% 
      dplyr::arrange(!!sym(rna_p_col)) %&gt;% 
      dplyr::filter(!!sym(rna_lfc_col) &lt; 0, DE) %&gt;% 
      split(.$status) %&gt;% 
      lapply(dplyr::slice, 1:2) %&gt;% 
      bind_rows(),
    show.legend = FALSE
  ) +
  geom_text(
    aes(label = lab),
    data = . %&gt;% 
      group_by(status) %&gt;% 
      summarise(n = dplyr::n()) %&gt;% 
      mutate(lab = glue(&quot;n = {comma(n)}&quot;)),
    x = min(rnaseq[[rna_lfc_col]]) + 0.9 * diff(range(rnaseq[[rna_lfc_col]])),
    y = 1,
    colour = &quot;black&quot;,
    inherit.aes = FALSE,
    show.legend = FALSE
  ) +
  facet_wrap(~status, ncol = 2) +
  scale_colour_manual(
    values = direction_colours
  ) +
  labs(colour = &quot;DE Status&quot;) </code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-volcano-by-target-1.png" alt="*Volcano plot showing gene expression patterns separated by H3K27ac status. The two most highly ranked genes for up and down regulation are labelled in each panel. Given that some genes may be mapped to multiple H3K27ac binding events which include different binding patterns, genes may appear in multiple panels.*" width="960" />
<p class="caption">
<em>Volcano plot showing gene expression patterns separated by H3K27ac
status. The two most highly ranked genes for up and down regulation are
labelled in each panel. Given that some genes may be mapped to multiple
H3K27ac binding events which include different binding patterns, genes
may appear in multiple panels.</em>
</p>
</div>
</div>
<div id="p-values-by-h3k27ac-status" class="section level3">
<h3>P-Values By H3K27ac Status</h3>
<pre class="r"><code>p &lt;- rnaseq %&gt;% 
  mutate(
    mapped = case_when(
      gene_id %in% unlist(diff_windows[names(diff_windows) %in% c(&quot;Up&quot;, &quot;Down&quot;)]) ~ paste(target, &quot;Differentially Bound&quot;),
      gene_id %in% unlist(diff_windows[names(diff_windows) %in% c(&quot;Unchanged&quot;)]) ~ paste(target, &quot;Unchanged&quot;),
      TRUE ~ paste(&quot;No&quot;, target, &quot;Detected&quot;)
    )
  ) %&gt;% 
  ggplot(
    aes(!!sym(rna_p_col), stat(density))
  ) +
  geom_histogram(
    colour = &quot;black&quot;, fill = &quot;grey&quot;, bins = 100
  ) +
  facet_wrap(~mapped, nrow = 1) +
  scale_y_continuous(expand = expansion(c(0, 0.05))) +
  labs(y = &quot;Density&quot;, x = &quot;P (Differential Expression)&quot;)
y &lt;- 0.95 * max(layer_scales(p)$y$range$range)
p  +
  geom_text(
    aes(0.8, y, label = lab),
    data = . %&gt;% 
      group_by(mapped) %&gt;% 
      tally() %&gt;% 
      mutate(lab = glue(&quot;N = {comma(n, 1)}&quot;))
  ) </code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-p-target-1.png" alt="*P-Values for differential expression partitioned by H3K27ac ChIP peak status. Genes were considered as being mapped to a differentially bound peak if one or more peaks was considered as differentially bound. No IHW procedure was undertaken using this data.*" width="960" />
<p class="caption">
<em>P-Values for differential expression partitioned by H3K27ac ChIP
peak status. Genes were considered as being mapped to a differentially
bound peak if one or more peaks was considered as differentially bound.
No IHW procedure was undertaken using this data.</em>
</p>
</div>
</div>
<div id="chip-logfc-vs-rna-logfc" class="section level3">
<h3>ChIP logFC Vs RNA logFC</h3>
<pre class="r"><code>de_genes_db_regions %&gt;% 
  dplyr::filter(ChIP_FDR &lt; fdr_alpha) %&gt;% 
  group_by(gene_name) %&gt;%
  dplyr::filter(ChIP_FDR == min(ChIP_FDR)) %&gt;%
  mutate(DE = ifelse(RNA_logFC &gt; 0, &quot;Up&quot;, &quot;Down&quot;)) %&gt;% 
  ungroup() %&gt;% 
  ggplot(
    aes(ChIP_logFC, RNA_logFC, colour = DE)
  ) +
  geom_point() +
  geom_label_repel(
    aes(label = lab),
    data = . %&gt;% 
      mutate(grp = paste(DE, status)) %&gt;% 
      # arrange(desc(abs(ChIP_logFC))) %&gt;% 
      arrange(ChIP_FDR, RNA_FDR) %&gt;% 
      split(.$grp) %&gt;% 
      lapply(dplyr::slice, 1) %&gt;% 
      bind_rows() %&gt;% 
      mutate(
        range = GRanges(range) %&gt;% 
          resize(width = 1, fix = &quot;center&quot;) %&gt;% 
          as.character(),
        lab = paste(gene_name, &quot;\n&quot;, range)
      ),
    show.legend = FALSE,
    alpha = 0.7
  ) +
  geom_text(
    aes(x, y, label = lab),
    data = . %&gt;% 
      group_by(DE, status) %&gt;% 
      summarise(
        n = dplyr::n(),
        lab = glue(&quot;n = {comma(n)}&quot;),
        x = max(abs(ChIP_logFC)) * sign(min(ChIP_logFC)) * 1.05,
        y = max(abs(RNA_logFC)) * sign(min(RNA_logFC)) * 1.05,
        .groups = &quot;drop&quot;
      ) %&gt;% 
      group_by(DE) %&gt;% 
      mutate(y = max(abs(y)) * sign(y)) %&gt;% 
      ungroup() %&gt;% 
      group_by(status) %&gt;% 
      mutate(x = max(abs(x)) * sign(x)),
    colour = &quot;black&quot;
  ) +
  geom_hline(yintercept = 0, colour = &quot;grey20&quot;) +
  geom_vline(xintercept = 0, colour = &quot;grey20&quot;) +
  scale_colour_manual(values = direction_colours[c(&quot;Up&quot;, &quot;Down&quot;)]) +
  labs(
    x = glue(&quot;logFC ({target} ChIP-Seq)&quot;),
    y = &quot;logFC (RNA-Seq)&quot;,
    colour = &quot;Differential\nExpression&quot;
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-chip-rna-logfc-1.png" alt="*logFC values for differentially bound ChIP-Seq peaks mapped to DE genes. The most highly ranked peak for each quandrant is labelled at showing both the gene and centre of the binding region. Whilst binding sites may be mapped to multiple genes, only the most highly ranked binding site is shown mapped to the mosthighly ranked DE genes. Points are coloured by differential expression status.*" width="960" />
<p class="caption">
<em>logFC values for differentially bound ChIP-Seq peaks mapped to DE
genes. The most highly ranked peak for each quandrant is labelled at
showing both the gene and centre of the binding region. Whilst binding
sites may be mapped to multiple genes, only the most highly ranked
binding site is shown mapped to the mosthighly ranked DE genes. Points
are coloured by differential expression status.</em>
</p>
</div>
</div>
</div>
<div id="binding-pattern-gsea" class="section level2">
<h2>Binding Pattern GSEA</h2>
<div id="gsea-by-direction-of-regulation" class="section level3 tabset">
<h3 class="tabset">GSEA By Direction of Regulation</h3>
<p>GSEA analysis was first performed by taking the genes mapped to
various sets of peaks, and checking for enrichment amongst the RNA-Seq
results, ranking genes from up- to down-regulated, by significance of
the logFC estimates.</p>
<div id="all-windows" class="section level4">
<h4>All Windows</h4>
<pre class="r"><code>gsea_dir &lt;- fgsea(dir_gs, rna_dir_ranks)
gsea_dir_sig &lt;- gsea_dir %&gt;% 
  arrange(pval) %&gt;% 
  mutate(padj = p.adjust(pval, adj_method)) %&gt;% 
  dplyr::filter(padj &lt; enrich_alpha, size &gt;= min_sig) %&gt;% 
  as_tibble() 
p &lt;- gsea_dir_sig %&gt;% 
  dplyr::slice(1:9) %&gt;% 
  pull(&quot;pathway&quot;) %&gt;% 
  lapply(
    function(x) {
      plotEnrichment(dir_gs[[x]], rna_dir_ranks) +
        ggtitle(x) +
        theme(
          plot.title = element_text(hjust = 0.5, size = 10)
        )
    }
  )</code></pre>
<pre class="r"><code>cp &lt;-  htmltools::em(
  glue(
    &quot;Merged windows were mapped to genes and their position amongst the &quot;,
    &quot;RNA-Seq results was assessed. Windows were classified based on  &quot;,
    &quot;the direction of {target} binding with &quot;,
    &quot;{treat_levels[[2]]} treatment. {nrow(gsea_dir_sig)} sets of windows were &quot;,
    &quot;associated with changes in gene expression, using the sign of &quot;, 
    &quot;fold-change and ranking statistic to initially rank the &quot;, 
    &quot;{comma(nrow(rnaseq), 1)} genes considered as detected.&quot;
  )
)
tbl &lt;- gsea_dir_sig %&gt;%
  mutate(
    `Edge Size` = vapply(leadingEdge, length, integer(1)),
    leadingEdge = lapply(leadingEdge, function(x) id2gene[x]) %&gt;% 
      vapply(paste, character(1), collapse = &quot;; &quot;),
    Direction = ifelse(NES &gt; 0, &quot;\u21E7 Up-regulated&quot;, &quot;\u21E9 Down-regulated&quot;),
    &quot;{target}&quot; := str_extract(pathway, &quot;(Up|Down|Unchanged)$&quot;),
    pathway = str_remove_all(pathway, &quot; / [^/]+$&quot;)
  ) %&gt;% 
  dplyr::select(
    !!sym(target), Windows = size, Direction, 
    p = pval, padj, `Edge Size`, `Leading Edge` = leadingEdge
  ) %&gt;% 
  reactable(
    filterable = TRUE,
    columns = list2(
      &quot;{target}&quot; := colDef(
        maxWidth = 90,
        cell = function(value) {
          html_symbol &lt;- &quot;&quot;
          if (str_detect(value, &quot;Up&quot;)) html_symbol &lt;- &quot;\u21E7&quot;
          if (str_detect(value, &quot;Down&quot;)) html_symbol &lt;- &quot;\u21E9&quot;
          paste(html_symbol, value)
        },
        style = function(value) {
          colour &lt;- case_when(
            str_detect(value, &quot;Up&quot;) ~ colours$direction[[&quot;up&quot;]],
            str_detect(value, &quot;Down&quot;) ~ colours$direction[[&quot;down&quot;]],
            TRUE ~ colours$direction[[&quot;unchanged&quot;]]
          )
          list(color = colour)
        }
      ),
      Windows = colDef(maxWidth = 80, format = colFormat(separators = TRUE)),
      Direction = colDef(
        name = &quot;Gene Direction&quot;,
        maxWidth = 150,
        style = function(value) {
          colour &lt;- ifelse(
            str_detect(value, &quot;Up&quot;), 
            colours$direction[[&quot;up&quot;]], 
            colours$direction[[&quot;down&quot;]]
          )
          list(color = colour)
        },
      ),
      p = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      padj = colDef(
        name = glue(&quot;p&lt;sub&gt;{adj_method}&lt;/sub&gt;&quot;), html = TRUE,
        cell = function(value) {
          ifelse(
            value &lt; 0.001, sprintf(&quot;%.2e&quot;, value), sprintf(&quot;%.3f&quot;, value)
          )
        }
      ),
      &quot;Edge Size&quot; = colDef(maxWidth = 80),
     &quot;Leading Edge&quot; = colDef(
       minWidth = 150,
       cell = function(value) with_tooltip(value, width = 50)
     ) 
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Merged windows were mapped to genes and their position amongst the RNA-Seq results was assessed. Windows were classified based on  the direction of H3K27ac binding with E2DHT treatment. 1 sets of windows were associated with changes in gene expression, using the sign of fold-change and ranking statistic to initially rank the 13,043 genes considered as detected.</em>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4591f97c274bf44d5da1" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4591f97c274bf44d5da1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"H3K27ac":["Up"],"Windows":[322],"Direction":["⇧ Up-regulated"],"p":[4.0025627543400031e-16],"padj":[8.0051255086800061e-16],"Edge Size":[70],"Leading Edge":["AQP3; UGDH; FKBP5; SEC14L2; RANBP3L; HSD11B2; AC021148.3; ZNF652; ZNF689; EHF; ARHGEF37; NRP1; AL033523.1; TTC12; KDM4B; PTPRJ; SYBU; NEDD4L; CSRNP1; GPCPD1; WWC1; SASH1; DIO2; AKAP13; CRYBG1; CD9; SPRED1; VSTM2L; IQGAP2; PRKAB2; TMEM164; NFKBIA; MCCC2; AC092053.4; ECI2; FGFR2; LMO3; GSTM3; PEA15; SGK3; RAB6C; SORD; MYCBP2; TTC21A; TMEM17; CCDC40; CNNM1; MTMR9; CRAT; NAMPT; RASSF3; ACACA; DSCAM-AS1; PEX10; PXDC1; PRAG1; KIAA0825; PRKAA2; VIPR1; CHPT1; DEPTOR; VIPR1-AS1; DUSP16; ZFX; NOL6; CCDC96; ACSM1; MAFB; SMIM14; TOR1AIP2"]},"columns":[{"id":"H3K27ac","name":"H3K27ac","type":"character","cell":["⇧ Up"],"maxWidth":90,"style":[{"color":"#CA0020"}]},{"id":"Windows","name":"Windows","type":"numeric","format":{"cell":{"separators":true},"aggregated":{"separators":true}},"maxWidth":80},{"id":"Direction","name":"Gene Direction","type":"character","maxWidth":150,"style":[{"color":"#CA0020"}]},{"id":"p","name":"p","type":"numeric","cell":["4.00e-16"],"maxWidth":80},{"id":"padj","name":"p<sub>fdr<\/sub>","type":"numeric","cell":["8.01e-16"],"html":true},{"id":"Edge Size","name":"Edge Size","type":"numeric","maxWidth":80},{"id":"Leading Edge","name":"Leading Edge","type":"character","cell":[{"name":"span","attribs":{"title":"AQP3; UGDH; FKBP5; SEC14L2; RANBP3L; HSD11B2; AC021148.3; ZNF652; ZNF689; EHF; ARHGEF37; NRP1; AL033523.1; TTC12; KDM4B; PTPRJ; SYBU; NEDD4L; CSRNP1; GPCPD1; WWC1; SASH1; DIO2; AKAP13; CRYBG1; CD9; SPRED1; VSTM2L; IQGAP2; PRKAB2; TMEM164; NFKBIA; MCCC2; AC092053.4; ECI2; FGFR2; LMO3; GSTM3; PEA15; SGK3; RAB6C; SORD; MYCBP2; TTC21A; TMEM17; CCDC40; CNNM1; MTMR9; CRAT; NAMPT; RASSF3; ACACA; DSCAM-AS1; PEX10; PXDC1; PRAG1; KIAA0825; PRKAA2; VIPR1; CHPT1; DEPTOR; VIPR1-AS1; DUSP16; ZFX; NOL6; CCDC96; ACSM1; MAFB; SMIM14; TOR1AIP2"},"children":["AQP3; UGDH; FKBP5; SEC14L2; RANBP3L; HSD11B2; A..."]}],"minWidth":150}],"filterable":true,"dataKey":"6a820cef8910467a4057feb5d5c6f88f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<pre class="r"><code>plot_grid(plotlist = p, nrow = ceiling(length(p) / 3))</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/barcode-gsea-dir-sig-1.png" alt="*Barcode plots for the top 1 sets of windows associated with __directional__ changes in gene expression.*" width="960" />
<p class="caption">
<em>Barcode plots for the top 1 sets of windows associated with
<strong>directional</strong> changes in gene expression.</em>
</p>
</div>
</div>
<div id="windows-by-region" class="section level4">
<h4>Windows By Region</h4>
<pre class="r"><code>gsea_reg_dir &lt;- fgsea(reg_dir_gs, rna_dir_ranks)
gsea_reg_dir_sig &lt;- gsea_reg_dir %&gt;% 
  arrange(pval) %&gt;% 
  mutate(padj = p.adjust(pval, adj_method)) %&gt;% 
  dplyr::filter(padj &lt; enrich_alpha, size &gt;= min_sig) %&gt;% 
  as_tibble() 
p &lt;- gsea_reg_dir_sig %&gt;% 
  dplyr::slice(1:9) %&gt;% 
  pull(&quot;pathway&quot;) %&gt;% 
  lapply(
    function(x) {
      plotEnrichment(reg_dir_gs[[x]], rna_dir_ranks) +
        ggtitle(x) +
        theme(
          plot.title = element_text(hjust = 0.5, size = 10)
        )
    }
  )</code></pre>
<pre class="r"><code>cp &lt;-  htmltools::em(
  glue(
    &quot;Merged windows were mapped to genes and their position amongst the &quot;,
    &quot;RNA-Seq results was assessed. Windows were classified based on which &quot;,
    &quot;region was the best overlap, and the direction of {target} binding with &quot;,
    &quot;{treat_levels[[2]]} treatment. {nrow(gsea_reg_dir_sig)} sets of windows were &quot;,
    &quot;associated with changes in gene expression, using the sign of &quot;, 
    &quot;fold-change and ranking statistic to initially rank the &quot;, 
    &quot;{comma(nrow(rnaseq), 1)} genes considered as detected.&quot;
  )
)
tbl &lt;- gsea_reg_dir_sig %&gt;%
  mutate(
    `Edge Size` = vapply(leadingEdge, length, integer(1)),
    leadingEdge = lapply(leadingEdge, function(x) id2gene[x]) %&gt;% 
      vapply(paste, character(1), collapse = &quot;; &quot;),
    Direction = ifelse(NES &gt; 0, &quot;\u21E7 Up-regulated&quot;, &quot;\u21E9 Down-regulated&quot;),
    &quot;{target}&quot; := str_extract(pathway, &quot;(Up|Down|Unchanged)$&quot;),
    pathway = str_remove_all(pathway, &quot; / [^/]+$&quot;)
  ) %&gt;% 
  dplyr::select(
    pathway, !!sym(target), Windows = size, Direction, 
    p = pval, padj, `Edge Size`, `Leading Edge` = leadingEdge
  ) %&gt;% 
  reactable(
    filterable = TRUE,
    columns = list2(
      pathway = colDef(
        minWidth = 100, name = &quot;Region&quot;
      ),
      &quot;{target}&quot; := colDef(
        maxWidth = 90,
        cell = function(value) {
          html_symbol &lt;- &quot;&quot;
          if (str_detect(value, &quot;Up&quot;)) html_symbol &lt;- &quot;\u21E7&quot;
          if (str_detect(value, &quot;Down&quot;)) html_symbol &lt;- &quot;\u21E9&quot;
          paste(html_symbol, value)
        },
        style = function(value) {
          colour &lt;- case_when(
            str_detect(value, &quot;Up&quot;) ~ colours$direction[[&quot;up&quot;]],
            str_detect(value, &quot;Down&quot;) ~ colours$direction[[&quot;down&quot;]],
            TRUE ~ colours$direction[[&quot;unchanged&quot;]]
          )
          list(color = colour)
        }
      ),
      Windows = colDef(maxWidth = 80, format = colFormat(separators = TRUE)),
      Direction = colDef(
        name = &quot;Gene Direction&quot;,
        maxWidth = 150,
        style = function(value) {
          colour &lt;- ifelse(
            str_detect(value, &quot;Up&quot;), 
            colours$direction[[&quot;up&quot;]], 
            colours$direction[[&quot;down&quot;]]
          )
          list(color = colour)
        },
      ),
      p = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      padj = colDef(
        name = glue(&quot;p&lt;sub&gt;{adj_method}&lt;/sub&gt;&quot;), html = TRUE,
        cell = function(value) {
          ifelse(
            value &lt; 0.001, sprintf(&quot;%.2e&quot;, value), sprintf(&quot;%.3f&quot;, value)
          )
        }
      ),
      &quot;Edge Size&quot; = colDef(maxWidth = 80),
     &quot;Leading Edge&quot; = colDef(
       minWidth = 150,
       cell = function(value) with_tooltip(value, width = 50)
     ) 
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Merged windows were mapped to genes and their position amongst the RNA-Seq results was assessed. Windows were classified based on which region was the best overlap, and the direction of H3K27ac binding with E2DHT treatment. 6 sets of windows were associated with changes in gene expression, using the sign of fold-change and ranking statistic to initially rank the 13,043 genes considered as detected.</em>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2cb3dbd6c450d5319221" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2cb3dbd6c450d5319221">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"pathway":["Intron","Promoter (-1500/+500bp)","Upstream Promoter (<5kb)","Intergenic (<10kb)","Upstream Promoter (<5kb)","Exon"],"H3K27ac":["Up","Up","Up","Up","Unchanged","Up"],"Windows":[187,34,38,37,3870,13],"Direction":["⇧ Up-regulated","⇧ Up-regulated","⇧ Up-regulated","⇧ Up-regulated","⇧ Up-regulated","⇧ Up-regulated"],"p":[2.363769782473668e-08,0.00012435667204913634,0.00050003797970866115,0.00084997239003947625,0.0028303629130486526,0.01435504587224507],"padj":[2.8365237389684013e-07,0.00074614003229481803,0.0020001519188346446,0.0025499171701184285,0.006792870991316766,0.02871009174449014],"Edge Size":[38,11,7,14,374,5],"Leading Edge":["UGDH; FKBP5; RANBP3L; AC021148.3; ZNF652; ARHGEF37; NRP1; AL033523.1; KDM4B; NEDD4L; SASH1; DIO2; AKAP13; CRYBG1; SPRED1; VSTM2L; IQGAP2; PRKAB2; FGFR2; LMO3; GSTM3; PEA15; SGK3; SORD; MYCBP2; CCDC40; CNNM1; RASSF3; ACACA; DSCAM-AS1; PXDC1; KIAA0825; PRKAA2; DEPTOR; CCDC96; ACSM1; SMIM14; TOR1AIP2","SEC14L2; ZNF689; TTC12; SYBU; CSRNP1; AC092053.4; TTC21A; MTMR9; CRAT; PEX10; CHPT1","FKBP5; HSD11B2; PTPRJ; MCCC2; ECI2; MYCBP2; RNF215","AQP3; EHF; SYBU; WWC1; CD9; NFKBIA; NAMPT; PRAG1; VIPR1; VIPR1-AS1; DUSP16; NOL6; TUT7; AC104825.1","AQP3; UGDH; FKBP5; SEC14L2; EAF2; HSD11B2; AC021148.3; PISD; ZNF652; ZNF689; ANKRD22; ARHGEF26; EHF; KRT4; PARM1; ARHGEF37; THBS1; NRP1; WWC3; GREB1; TTC12; KDM4B; PTPRJ; ADD3; SYBU; NEDD4L; CSRNP1; GPRC5A; WWC1; CNTNAP2; TBC1D16; OSGIN1; SLC26A2; AC068580.3; DIO2; SERHL; PER1; AKAP13; SLC22A23; CRYBG1; KRT15; CD9; TRGC1; VSTM2L; HS3ST3B1; IQGAP2; TNNI2; STON2; PRKAB2; PMEPA1; NDRG1; TMEM164; NFKBIA; MCCC2; GRHL2; HEY2; LNX2; KLF13; FAM214A; AC092053.4; CYP2B7P; AL135905.2; MTSS1; AL606500.1; STEAP4; KLF9; NXPE3; TPD52; EMP1; TBC1D8; EPN2; ELL2; STARD13-AS; STARD13; MYCBP2; AL162377.1; IFITM10; AL445309.1; CRYBG2; LRP2BP; YPEL3; FSBP; TTC21A; ZBTB7C; CCDC40; PID1; PAQR5; TRGC2; MTMR9; CRAT; NAMPT; ZNF703; CHN1; CBX4; ARHGEF26-AS1; TESK2; TOE1; LRIG1; RASSF3; NYNRIN; BCL6; FAH; HERC3; KCNB1; GDPD3; GLDC; PXDC1; APCDD1; SLC2A1; PXYLP1; SRMS; LPAR3; CA13; FZD5; NSRP1; SLC22A5; RN7SL674P; HEG1; SNHG30; SPRY4; MYO1F; RNF227; DLGAP1-AS1; AC040162.1; SEPHS2; CASD1; GET4; BBS5; ATP7B; AC068580.4; MRFAP1; LBP; RFLNA; SLC44A5; PARTICL; AL158211.5; SORD2P; PRR15L; PRAG1; CORO1A; SYT8; DBI; HSP90AA2P; VMP1; DOK7; PIM1; GRK5; RPH3AL; BAG3; EGLN3; TMEM63C; SPRED2; ZNRF1; MRPL38; ARRB1; KRT81; ID3; VCPKMT; SLC6A17; KLRG2; AZGP1P1; PSMD6-AS2; HGD; NEDD4; ZFX; DRC3; CSF1; LOXL3; PSCA; NOL6; ID1; SKAP1; GADD45B; ENPP1; AIFM2; IFNLR1; CNOT2-DT; AL135905.1; BTN2A3P; MFF-DT; RNU4-1; KL; CCDC96; ENTPD1-AS1; MFSD2A; VAMP5; RPS10P3; CARMIL1; MAGIX; AC020904.2; GRAMD1B; SLC20A1; HAP1; LMNTD2-AS1; RBM26-AS1; TRIM36; RABGEF1; TMEM62; LRRC26; TLK2P1; SMIM14; TGFB1I1; IZUMO4; HERC6; IGFBP3; AC234917.3; AMH; UBXN10; RAB11B-AS1; ZFP36L2; LIF; NKX2-1; C15orf48; SERTAD1; AC092171.5; CFAP45; HES1; MGAT2; AC007405.4; EML6; PRDM4; RASD2; ATP1A1; PTCH1; TMEM160; SPOCD1; PXMP4; EFNA4; HMGCS2; HEBP1; SNHG22; TMEM191A; BCCIP; BCAR3; LINC01089; MIR3936HG; AC090772.5; PAM16; TMEM254-AS1; PHKA1; IQCD; ADPRM; AC090517.5; HOOK1; TSKU; EFNA3; AC141930.1; STBD1; AC092910.3; RNF215; GCNA; SPRYD7; RILP; OPLAH; FMO5; CRELD1; NNAT; DNMT3B; ABTB1; DNMBP; CCN1; AL139385.1; ATG101; ZCCHC17; FEM1A; SLC24A3; ANP32B; CCDC124; CLIC6; EML5; HDAC10; AC084082.1; RASGEF1A; PRELID2; SDHAF2; SLC27A5; RFLNB; MAPK15; AC006449.7; WDR60; ZNF688; FAM81A; AC104109.2; CYP4Z2P; C3orf18; C22orf46; PLEKHG5; EEPD1; RHOB; PSG4; KCNMA1; FBXL16; VPS37D; DHCR24; LIN7B; OLMALINC; GPKOW; AC097523.1; SNORD3C; ZNF764; SNHG19; THBD; AC087289.5; LARGE1; ETHE1; KLHL8; ZC3H10; MAPT; ZSCAN31; CAP2; RILPL2; HINT2; FLT4; PPP1R37; ZCWPW1; TSC22D1; TAGLN; KLC3; IGSF8; AC091982.3; ZFPM1; AC009078.3; CUEDC1; CHST3; LTBP4; TMEM107; OSBPL6; MBD3; UQCRHL; PRSS27; DGLUCY; UCKL1-AS1; RPL13P5; BOLA2-SMG1P6; ULBP2; MTCL1; LINC02482; RDM1; CASP9; ACYP2; AC018521.5; AC108134.2; PIK3CB; MAFF; SIX1; CALML5; SESTD1; NR4A1; DHRS2; EFNA5; ANKRD18B; TMEM186; SPAG6; NDFIP2; MRC2; TPO; ANAPC11; CST6; KIF13B; MED4; ARG2; TOB1-AS1; EIF4A3; AC005914.1; BCL2L12; SH3TC1; AC139149.1; AL731571.1; TMC5; PYDC1; TTPA; DCST1-AS1; TPRN; AL445363.3","UGDH; AC021148.3; AKAP13; RAB6C; SMIM14"]},"columns":[{"id":"pathway","name":"Region","type":"character","minWidth":100},{"id":"H3K27ac","name":"H3K27ac","type":"character","cell":["⇧ Up","⇧ Up","⇧ Up","⇧ Up"," Unchanged","⇧ Up"],"maxWidth":90,"style":[{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#7F7F7F"},{"color":"#CA0020"}]},{"id":"Windows","name":"Windows","type":"numeric","format":{"cell":{"separators":true},"aggregated":{"separators":true}},"maxWidth":80},{"id":"Direction","name":"Gene Direction","type":"character","maxWidth":150,"style":[{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"}]},{"id":"p","name":"p","type":"numeric","cell":["2.36e-08","1.24e-04","5.00e-04","8.50e-04","2.83e-03","1.44e-02"],"maxWidth":80},{"id":"padj","name":"p<sub>fdr<\/sub>","type":"numeric","cell":["2.84e-07","7.46e-04","0.002","0.003","0.007","0.029"],"html":true},{"id":"Edge Size","name":"Edge Size","type":"numeric","maxWidth":80},{"id":"Leading Edge","name":"Leading Edge","type":"character","cell":[{"name":"span","attribs":{"title":"UGDH; FKBP5; RANBP3L; AC021148.3; ZNF652; ARHGEF37; NRP1; AL033523.1; KDM4B; NEDD4L; SASH1; DIO2; AKAP13; CRYBG1; SPRED1; VSTM2L; IQGAP2; PRKAB2; FGFR2; LMO3; GSTM3; PEA15; SGK3; SORD; MYCBP2; CCDC40; CNNM1; RASSF3; ACACA; DSCAM-AS1; PXDC1; KIAA0825; PRKAA2; DEPTOR; CCDC96; ACSM1; SMIM14; TOR1AIP2"},"children":["UGDH; FKBP5; RANBP3L; AC021148.3; ZNF652; ARHGE..."]},{"name":"span","attribs":{"title":"SEC14L2; ZNF689; TTC12; SYBU; CSRNP1; AC092053.4; TTC21A; MTMR9; CRAT; PEX10; CHPT1"},"children":["SEC14L2; ZNF689; TTC12; SYBU; CSRNP1; AC092053...."]},{"name":"span","attribs":{"title":"FKBP5; HSD11B2; PTPRJ; MCCC2; ECI2; MYCBP2; RNF215"},"children":["FKBP5; HSD11B2; PTPRJ; MCCC2; ECI2; MYCBP2; RNF215"]},{"name":"span","attribs":{"title":"AQP3; EHF; SYBU; WWC1; CD9; NFKBIA; NAMPT; PRAG1; VIPR1; VIPR1-AS1; DUSP16; NOL6; TUT7; AC104825.1"},"children":["AQP3; EHF; SYBU; WWC1; CD9; NFKBIA; NAMPT; PRAG..."]},{"name":"span","attribs":{"title":"AQP3; UGDH; FKBP5; SEC14L2; EAF2; HSD11B2; AC021148.3; PISD; ZNF652; ZNF689; ANKRD22; ARHGEF26; EHF; KRT4; PARM1; ARHGEF37; THBS1; NRP1; WWC3; GREB1; TTC12; KDM4B; PTPRJ; ADD3; SYBU; NEDD4L; CSRNP1; GPRC5A; WWC1; CNTNAP2; TBC1D16; OSGIN1; SLC26A2; AC068580.3; DIO2; SERHL; PER1; AKAP13; SLC22A23; CRYBG1; KRT15; CD9; TRGC1; VSTM2L; HS3ST3B1; IQGAP2; TNNI2; STON2; PRKAB2; PMEPA1; NDRG1; TMEM164; NFKBIA; MCCC2; GRHL2; HEY2; LNX2; KLF13; FAM214A; AC092053.4; CYP2B7P; AL135905.2; MTSS1; AL606500.1; STEAP4; KLF9; NXPE3; TPD52; EMP1; TBC1D8; EPN2; ELL2; STARD13-AS; STARD13; MYCBP2; AL162377.1; IFITM10; AL445309.1; CRYBG2; LRP2BP; YPEL3; FSBP; TTC21A; ZBTB7C; CCDC40; PID1; PAQR5; TRGC2; MTMR9; CRAT; NAMPT; ZNF703; CHN1; CBX4; ARHGEF26-AS1; TESK2; TOE1; LRIG1; RASSF3; NYNRIN; BCL6; FAH; HERC3; KCNB1; GDPD3; GLDC; PXDC1; APCDD1; SLC2A1; PXYLP1; SRMS; LPAR3; CA13; FZD5; NSRP1; SLC22A5; RN7SL674P; HEG1; SNHG30; SPRY4; MYO1F; RNF227; DLGAP1-AS1; AC040162.1; SEPHS2; CASD1; GET4; BBS5; ATP7B; AC068580.4; MRFAP1; LBP; RFLNA; SLC44A5; PARTICL; AL158211.5; SORD2P; PRR15L; PRAG1; CORO1A; SYT8; DBI; HSP90AA2P; VMP1; DOK7; PIM1; GRK5; RPH3AL; BAG3; EGLN3; TMEM63C; SPRED2; ZNRF1; MRPL38; ARRB1; KRT81; ID3; VCPKMT; SLC6A17; KLRG2; AZGP1P1; PSMD6-AS2; HGD; NEDD4; ZFX; DRC3; CSF1; LOXL3; PSCA; NOL6; ID1; SKAP1; GADD45B; ENPP1; AIFM2; IFNLR1; CNOT2-DT; AL135905.1; BTN2A3P; MFF-DT; RNU4-1; KL; CCDC96; ENTPD1-AS1; MFSD2A; VAMP5; RPS10P3; CARMIL1; MAGIX; AC020904.2; GRAMD1B; SLC20A1; HAP1; LMNTD2-AS1; RBM26-AS1; TRIM36; RABGEF1; TMEM62; LRRC26; TLK2P1; SMIM14; TGFB1I1; IZUMO4; HERC6; IGFBP3; AC234917.3; AMH; UBXN10; RAB11B-AS1; ZFP36L2; LIF; NKX2-1; C15orf48; SERTAD1; AC092171.5; CFAP45; HES1; MGAT2; AC007405.4; EML6; PRDM4; RASD2; ATP1A1; PTCH1; TMEM160; SPOCD1; PXMP4; EFNA4; HMGCS2; HEBP1; SNHG22; TMEM191A; BCCIP; BCAR3; LINC01089; MIR3936HG; AC090772.5; PAM16; TMEM254-AS1; PHKA1; IQCD; ADPRM; AC090517.5; HOOK1; TSKU; EFNA3; AC141930.1; STBD1; AC092910.3; RNF215; GCNA; SPRYD7; RILP; OPLAH; FMO5; CRELD1; NNAT; DNMT3B; ABTB1; DNMBP; CCN1; AL139385.1; ATG101; ZCCHC17; FEM1A; SLC24A3; ANP32B; CCDC124; CLIC6; EML5; HDAC10; AC084082.1; RASGEF1A; PRELID2; SDHAF2; SLC27A5; RFLNB; MAPK15; AC006449.7; WDR60; ZNF688; FAM81A; AC104109.2; CYP4Z2P; C3orf18; C22orf46; PLEKHG5; EEPD1; RHOB; PSG4; KCNMA1; FBXL16; VPS37D; DHCR24; LIN7B; OLMALINC; GPKOW; AC097523.1; SNORD3C; ZNF764; SNHG19; THBD; AC087289.5; LARGE1; ETHE1; KLHL8; ZC3H10; MAPT; ZSCAN31; CAP2; RILPL2; HINT2; FLT4; PPP1R37; ZCWPW1; TSC22D1; TAGLN; KLC3; IGSF8; AC091982.3; ZFPM1; AC009078.3; CUEDC1; CHST3; LTBP4; TMEM107; OSBPL6; MBD3; UQCRHL; PRSS27; DGLUCY; UCKL1-AS1; RPL13P5; BOLA2-SMG1P6; ULBP2; MTCL1; LINC02482; RDM1; CASP9; ACYP2; AC018521.5; AC108134.2; PIK3CB; MAFF; SIX1; CALML5; SESTD1; NR4A1; DHRS2; EFNA5; ANKRD18B; TMEM186; SPAG6; NDFIP2; MRC2; TPO; ANAPC11; CST6; KIF13B; MED4; ARG2; TOB1-AS1; EIF4A3; AC005914.1; BCL2L12; SH3TC1; AC139149.1; AL731571.1; TMC5; PYDC1; TTPA; DCST1-AS1; TPRN; AL445363.3"},"children":["AQP3; UGDH; FKBP5; SEC14L2; EAF2; HSD11B2; AC02..."]},{"name":"span","attribs":{"title":"UGDH; AC021148.3; AKAP13; RAB6C; SMIM14"},"children":["UGDH; AC021148.3; AKAP13; RAB6C; SMIM14"]}],"minWidth":150}],"filterable":true,"dataKey":"92df088e7a1a67ed5bc1a110fdf392a6"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<pre class="r"><code>plot_grid(plotlist = p, nrow = ceiling(length(p) / 3))</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/barcode-gsea-reg-dir-sig-1.png" alt="*Barcode plots for the top 6 sets of windows associated with __directional__ changes in gene expression.*" width="960" />
<p class="caption">
<em>Barcode plots for the top 6 sets of windows associated with
<strong>directional</strong> changes in gene expression.</em>
</p>
</div>
</div>
<div id="windows-by-feature" class="section level4">
<h4>Windows By Feature</h4>
<pre class="r"><code>gsea_feat_dir &lt;- fgsea(feat_dir_gs, rna_dir_ranks)
gsea_feat_dir_sig &lt;- gsea_feat_dir %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(padj &lt; enrich_alpha, size &gt;= min_sig) %&gt;% 
  as_tibble() 
p &lt;- gsea_feat_dir_sig %&gt;% 
  dplyr::slice(1:9) %&gt;% 
  pull(&quot;pathway&quot;) %&gt;% 
  lapply(
    function(x) {
      plotEnrichment(feat_dir_gs[[x]], rna_dir_ranks) +
        ggtitle(x) +
        theme(
          plot.title = element_text(hjust = 0.5, size = 10)
        )
    }
  )</code></pre>
<pre class="r"><code>cp &lt;-  htmltools::em(
  glue(
    &quot;Merged windows were mapped to genes and their position amongst the &quot;,
    &quot;RNA-Seq results was assessed. Windows were classified based on which &quot;,
    &quot;feature was the best overlap, and the direction of {target} binding with &quot;,
    &quot;{treat_levels[[2]]} treatment. {nrow(gsea_feat_dir_sig)} sets of windows were &quot;,
    &quot;associated with changes in gene expression, using the sign of &quot;, 
    &quot;fold-change and ranking statistic to initially rank the &quot;, 
    &quot;{comma(nrow(rnaseq), 1)} genes considered as detected.&quot;
  )
)
tbl &lt;- gsea_feat_dir_sig %&gt;%
  mutate(
    `Edge Size` = vapply(leadingEdge, length, integer(1)),
    leadingEdge = lapply(leadingEdge, function(x) id2gene[x]) %&gt;% 
      vapply(paste, character(1), collapse = &quot;; &quot;),
    Direction = ifelse(NES &gt; 0, &quot;\u21E7 Up-regulated&quot;, &quot;\u21E9 Down-regulated&quot;),
    &quot;{target}&quot; := str_extract(pathway, &quot;(Up|Down|Unchanged)$&quot;),
    pathway = str_remove_all(pathway, &quot; / [^/]+$&quot;)
  ) %&gt;% 
  dplyr::select(
    pathway, !!sym(target), Windows = size, Direction, 
    p = pval, FDR = padj, `Edge Size`, `Leading Edge` = leadingEdge
  ) %&gt;% 
  reactable(
    filterable = TRUE,
    columns = list2(
      pathway = colDef(
        minWidth = 100, name = &quot;Region&quot;
      ),
      &quot;{target}&quot; := colDef(
        maxWidth = 120,
        cell = function(value) {
          html_symbol &lt;- &quot;&quot;
          if (str_detect(value, &quot;Up&quot;)) html_symbol &lt;- &quot;\u21E7&quot;
          if (str_detect(value, &quot;Down&quot;)) html_symbol &lt;- &quot;\u21E9&quot;
          paste(html_symbol, value)
        },
        style = function(value) {
          colour &lt;- case_when(
            str_detect(value, &quot;Up&quot;) ~ colours$direction[[&quot;up&quot;]],
            str_detect(value, &quot;Down&quot;) ~ colours$direction[[&quot;down&quot;]],
            TRUE ~ colours$direction[[&quot;unchanged&quot;]]
          )
          list(color = colour)
        }
      ),
      Windows = colDef(maxWidth = 80, format = colFormat(separators = TRUE)),
      Direction = colDef(
        name = &quot;Gene Direction&quot;,
        maxWidth = 120,
        style = function(value) {
          colour &lt;- ifelse(
            str_detect(value, &quot;Up&quot;), 
            colours$direction[[&quot;up&quot;]], 
            colours$direction[[&quot;down&quot;]]
          )
          list(color = colour)
        },
      ),
      p = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      FDR = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      &quot;Edge Size&quot; = colDef(maxWidth = 80),
     &quot;Leading Edge&quot; = colDef(
       minWidth = 150,
       cell = function(value) with_tooltip(value, width = 50)
     ) 
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Merged windows were mapped to genes and their position amongst the RNA-Seq results was assessed. Windows were classified based on which feature was the best overlap, and the direction of H3K27ac binding with E2DHT treatment. 2 sets of windows were associated with changes in gene expression, using the sign of fold-change and ranking statistic to initially rank the 13,043 genes considered as detected.</em>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2bd902ea5cb3a0ee6834" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2bd902ea5cb3a0ee6834">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"pathway":["No Feature","Enhancer"],"H3K27ac":["Up","Up"],"Windows":[112,225],"Direction":["⇧ Up-regulated","⇧ Up-regulated"],"p":[6.2381936934075557e-10,1.9669585098042495e-09],"FDR":[2.4952774773630223e-09,3.9339170196084991e-09],"Edge Size":[34,42],"Leading Edge":["AQP3; FKBP5; SEC14L2; RANBP3L; ZNF689; EHF; ARHGEF37; NRP1; SYBU; NEDD4L; GPCPD1; WWC1; DIO2; AKAP13; CRYBG1; TMEM164; NFKBIA; MCCC2; FGFR2; LMO3; SGK3; RAB6C; SORD; MYCBP2; TMEM17; CCDC40; MTMR9; CRAT; RASSF3; ACACA; DSCAM-AS1; PEX10; PRAG1; DEPTOR","AQP3; UGDH; FKBP5; HSD11B2; AC021148.3; ZNF652; EHF; ARHGEF37; AL033523.1; TTC12; KDM4B; PTPRJ; CSRNP1; SASH1; CD9; SPRED1; VSTM2L; IQGAP2; PRKAB2; MCCC2; AC092053.4; ECI2; GSTM3; PEA15; TTC21A; TMEM17; CNNM1; NAMPT; ACACA; PXDC1; KIAA0825; PRKAA2; VIPR1; CHPT1; VIPR1-AS1; DUSP16; ZFX; NOL6; CCDC96; MAFB; SMIM14; TOR1AIP2"]},"columns":[{"id":"pathway","name":"Region","type":"character","minWidth":100},{"id":"H3K27ac","name":"H3K27ac","type":"character","cell":["⇧ Up","⇧ Up"],"maxWidth":120,"style":[{"color":"#CA0020"},{"color":"#CA0020"}]},{"id":"Windows","name":"Windows","type":"numeric","format":{"cell":{"separators":true},"aggregated":{"separators":true}},"maxWidth":80},{"id":"Direction","name":"Gene Direction","type":"character","maxWidth":120,"style":[{"color":"#CA0020"},{"color":"#CA0020"}]},{"id":"p","name":"p","type":"numeric","cell":["6.24e-10","1.97e-09"],"maxWidth":80},{"id":"FDR","name":"FDR","type":"numeric","cell":["2.50e-09","3.93e-09"],"maxWidth":80},{"id":"Edge Size","name":"Edge Size","type":"numeric","maxWidth":80},{"id":"Leading Edge","name":"Leading Edge","type":"character","cell":[{"name":"span","attribs":{"title":"AQP3; FKBP5; SEC14L2; RANBP3L; ZNF689; EHF; ARHGEF37; NRP1; SYBU; NEDD4L; GPCPD1; WWC1; DIO2; AKAP13; CRYBG1; TMEM164; NFKBIA; MCCC2; FGFR2; LMO3; SGK3; RAB6C; SORD; MYCBP2; TMEM17; CCDC40; MTMR9; CRAT; RASSF3; ACACA; DSCAM-AS1; PEX10; PRAG1; DEPTOR"},"children":["AQP3; FKBP5; SEC14L2; RANBP3L; ZNF689; EHF; ARH..."]},{"name":"span","attribs":{"title":"AQP3; UGDH; FKBP5; HSD11B2; AC021148.3; ZNF652; EHF; ARHGEF37; AL033523.1; TTC12; KDM4B; PTPRJ; CSRNP1; SASH1; CD9; SPRED1; VSTM2L; IQGAP2; PRKAB2; MCCC2; AC092053.4; ECI2; GSTM3; PEA15; TTC21A; TMEM17; CNNM1; NAMPT; ACACA; PXDC1; KIAA0825; PRKAA2; VIPR1; CHPT1; VIPR1-AS1; DUSP16; ZFX; NOL6; CCDC96; MAFB; SMIM14; TOR1AIP2"},"children":["AQP3; UGDH; FKBP5; HSD11B2; AC021148.3; ZNF652;..."]}],"minWidth":150}],"filterable":true,"dataKey":"4db5660545a4d9ccde5699be5bf68a7a"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<pre class="r"><code>plot_grid(plotlist = p, nrow = ceiling(length(p) / 3))</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/barcode-gsea-feat-dir-sig-1.png" alt="*Barcode plots for the top 2 sets of windows associated with __directional__ changes in gene expression.*" width="960" />
<p class="caption">
<em>Barcode plots for the top 2 sets of windows associated with
<strong>directional</strong> changes in gene expression.</em>
</p>
</div>
</div>
</div>
<div id="gsea-by-significance-only" class="section level3 tabset">
<h3 class="tabset">GSEA By Significance Only</h3>
<p>GSEA analysis was then performed by taking the genes mapped to
various sets of peaks, and checking for enrichment amongst the RNA-Seq
results, ranking genes only from least to most significant, which
effectively treats up- and down-regulation as indistinguishable.</p>
<div id="all-windows-1" class="section level4">
<h4>All Windows</h4>
<pre class="r"><code>gsea_nondir &lt;- fgsea(dir_gs, rna_sig_ranks, scoreType = &quot;pos&quot;)
gsea_nondir_sig &lt;- gsea_nondir %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(padj &lt; enrich_alpha, size &gt;= min_sig) %&gt;% 
  as_tibble() 
p &lt;- gsea_nondir_sig %&gt;% 
  dplyr::slice(1:9) %&gt;% 
  pull(&quot;pathway&quot;) %&gt;% 
  lapply(
    function(x) {
      plotEnrichment(dir_gs[[x]], rna_sig_ranks) +
        ggtitle(x) +
        theme(plot.title = element_text(hjust = 0.5, size = 10))
    }
  )</code></pre>
<pre class="r"><code>cp &lt;-  htmltools::em(
  glue(
    &quot;Merged windows were mapped to genes and their position amongst the &quot;,
    &quot;RNA-Seq results was assessed. Windows were classified based on  &quot;,
    &quot;the direction of {target} binding with &quot;,
    &quot;{treat_levels[[2]]} treatment. {nrow(gsea_nondir_sig)} sets of windows were &quot;,
    &quot;associated with changes in gene expression, using only the p-value to &quot;, 
    &quot;rank the {comma(nrow(rnaseq), 1)} genes considered as detected.&quot;
  )
)
tbl &lt;- gsea_nondir_sig %&gt;%
  mutate(
    `Edge Size` = vapply(leadingEdge, length, integer(1)),
    leadingEdge = lapply(leadingEdge, function(x) id2gene[x]) %&gt;% 
      vapply(paste, character(1), collapse = &quot;; &quot;),
    &quot;{target}&quot; := str_extract(pathway, &quot;(Up|Down|Unchanged)$&quot;),
    pathway = str_remove_all(pathway, &quot; / [^/]+$&quot;)
  ) %&gt;% 
  dplyr::select(
    !!sym(target), Windows = size, p = pval, FDR = padj, 
    `Edge Size`, `Leading Edge` = leadingEdge
  ) %&gt;% 
  reactable(
    filterable = TRUE,
    columns = list2(
      &quot;{target}&quot; := colDef(
        maxWidth = 150,
        cell = function(value) {
          html_symbol &lt;- &quot;&quot;
          if (str_detect(value, &quot;Up&quot;)) html_symbol &lt;- &quot;\u21E7&quot;
          if (str_detect(value, &quot;Down&quot;)) html_symbol &lt;- &quot;\u21E9&quot;
          paste(html_symbol, value)
        },
        style = function(value) {
           colour &lt;- case_when(
            str_detect(value, &quot;Up&quot;) ~ colours$direction[[&quot;up&quot;]],
            str_detect(value, &quot;Down&quot;) ~ colours$direction[[&quot;down&quot;]],
            TRUE ~ colours$direction[[&quot;unchanged&quot;]]
          )
          list(color = colour)
        }
      ),
      Windows = colDef(maxWidth = 80, format = colFormat(separators = TRUE)),
      p = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      FDR = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      &quot;Edge Size&quot; = colDef(maxWidth = 80),
     &quot;Leading Edge&quot; = colDef(
       minWidth = 150,
       cell = function(value) with_tooltip(value, width = 50)
     ) 
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Merged windows were mapped to genes and their position amongst the RNA-Seq results was assessed. Windows were classified based on  the direction of H3K27ac binding with E2DHT treatment. 1 sets of windows were associated with changes in gene expression, using only the p-value to rank the 13,043 genes considered as detected.</em>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8b26df7dd9ccc4118943" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8b26df7dd9ccc4118943">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"H3K27ac":["Up"],"Windows":[322],"p":[3.4494226370643756e-14],"FDR":[6.8988452741287511e-14],"Edge Size":[77],"Leading Edge":["AQP3; UGDH; FKBP5; SEC14L2; RANBP3L; HSD11B2; AC021148.3; ZNF652; ZNF689; EHF; ARHGEF37; NRP1; AL033523.1; TTC12; KDM4B; PTPRJ; SYBU; NEDD4L; CSRNP1; GPCPD1; WWC1; SASH1; DIO2; AKAP13; CRYBG1; CD9; SPRED1; VSTM2L; IQGAP2; PRKAB2; TMEM164; NFKBIA; MCCC2; AC092053.4; ECI2; FGFR2; LMO3; GSTM3; PEA15; SGK3; RAB6C; SORD; MYCBP2; TTC21A; TMEM17; CCDC40; CNNM1; MTMR9; CRAT; NAMPT; RASSF3; SCIN; ACACA; GIPR; DSCAM-AS1; PEX10; PXDC1; STX18-AS1; DLG2; PRAG1; RAD51B; KIAA0825; MAGI2; PRKAA2; VIPR1; CHPT1; DEPTOR; VIPR1-AS1; DUSP16; ZFX; NOL6; CCDC96; AC007191.1; ACSM1; MAFB; SMIM14; TOR1AIP2"]},"columns":[{"id":"H3K27ac","name":"H3K27ac","type":"character","cell":["⇧ Up"],"maxWidth":150,"style":[{"color":"#CA0020"}]},{"id":"Windows","name":"Windows","type":"numeric","format":{"cell":{"separators":true},"aggregated":{"separators":true}},"maxWidth":80},{"id":"p","name":"p","type":"numeric","cell":["3.45e-14"],"maxWidth":80},{"id":"FDR","name":"FDR","type":"numeric","cell":["6.90e-14"],"maxWidth":80},{"id":"Edge Size","name":"Edge Size","type":"numeric","maxWidth":80},{"id":"Leading Edge","name":"Leading Edge","type":"character","cell":[{"name":"span","attribs":{"title":"AQP3; UGDH; FKBP5; SEC14L2; RANBP3L; HSD11B2; AC021148.3; ZNF652; ZNF689; EHF; ARHGEF37; NRP1; AL033523.1; TTC12; KDM4B; PTPRJ; SYBU; NEDD4L; CSRNP1; GPCPD1; WWC1; SASH1; DIO2; AKAP13; CRYBG1; CD9; SPRED1; VSTM2L; IQGAP2; PRKAB2; TMEM164; NFKBIA; MCCC2; AC092053.4; ECI2; FGFR2; LMO3; GSTM3; PEA15; SGK3; RAB6C; SORD; MYCBP2; TTC21A; TMEM17; CCDC40; CNNM1; MTMR9; CRAT; NAMPT; RASSF3; SCIN; ACACA; GIPR; DSCAM-AS1; PEX10; PXDC1; STX18-AS1; DLG2; PRAG1; RAD51B; KIAA0825; MAGI2; PRKAA2; VIPR1; CHPT1; DEPTOR; VIPR1-AS1; DUSP16; ZFX; NOL6; CCDC96; AC007191.1; ACSM1; MAFB; SMIM14; TOR1AIP2"},"children":["AQP3; UGDH; FKBP5; SEC14L2; RANBP3L; HSD11B2; A..."]}],"minWidth":150}],"filterable":true,"dataKey":"b682c1befe0c4b7dab498bd9b242afb2"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<pre class="r"><code>plot_grid(plotlist = p, nrow = ceiling(length(p) / 3))</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/barcode-gsea-nondir-sig-1.png" alt="*Barcode plots for the top 1 sets of windows associated with __non-directional__ changes in gene expression.*" width="960" />
<p class="caption">
<em>Barcode plots for the top 1 sets of windows associated with
<strong>non-directional</strong> changes in gene expression.</em>
</p>
</div>
</div>
<div id="windows-by-region-1" class="section level4">
<h4>Windows By Region</h4>
<pre class="r"><code>gsea_reg_nondir &lt;- fgsea(reg_dir_gs, rna_sig_ranks, scoreType = &quot;pos&quot;)
gsea_reg_nondir_sig &lt;- gsea_reg_nondir %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(padj &lt; enrich_alpha, size &gt;= min_sig) %&gt;% 
  as_tibble() 
p &lt;- gsea_reg_nondir_sig %&gt;% 
  dplyr::slice(1:9) %&gt;% 
  pull(&quot;pathway&quot;) %&gt;% 
  lapply(
    function(x) {
      plotEnrichment(reg_dir_gs[[x]], rna_sig_ranks) +
        ggtitle(x) +
        theme(plot.title = element_text(hjust = 0.5, size = 10))
    }
  )</code></pre>
<pre class="r"><code>cp &lt;-  htmltools::em(
  glue(
    &quot;Merged windows were mapped to genes and their position amongst the &quot;,
    &quot;RNA-Seq results was assessed. Windows were classified based on which &quot;,
    &quot;region was the best overlap, and the direction of {target} binding with &quot;,
    &quot;{treat_levels[[2]]} treatment. {nrow(gsea_reg_nondir_sig)} sets of windows were &quot;,
    &quot;associated with changes in gene expression, using only the p-value to &quot;, 
    &quot;rank the {comma(nrow(rnaseq), 1)} genes considered as detected.&quot;
  )
)
tbl &lt;- gsea_reg_nondir_sig %&gt;%
  mutate(
    `Edge Size` = vapply(leadingEdge, length, integer(1)),
    leadingEdge = lapply(leadingEdge, function(x) id2gene[x]) %&gt;% 
      vapply(paste, character(1), collapse = &quot;; &quot;),
    &quot;{target}&quot; := str_extract(pathway, &quot;(Up|Down|Unchanged)$&quot;),
    pathway = str_remove_all(pathway, &quot; / [^/]+$&quot;)
  ) %&gt;% 
  dplyr::select(
    pathway, !!sym(target), Windows = size, p = pval, FDR = padj, 
    `Edge Size`, `Leading Edge` = leadingEdge
  ) %&gt;% 
  reactable(
    filterable = TRUE,
    columns = list2(
      pathway = colDef(
        minWidth = 100, name = &quot;Region&quot;
      ),
      &quot;{target}&quot; := colDef(
        maxWidth = 90,
        cell = function(value) {
          html_symbol &lt;- &quot;&quot;
          if (str_detect(value, &quot;Up&quot;)) html_symbol &lt;- &quot;\u21E7&quot;
          if (str_detect(value, &quot;Down&quot;)) html_symbol &lt;- &quot;\u21E9&quot;
          paste(html_symbol, value)
        },
        style = function(value) {
           colour &lt;- case_when(
            str_detect(value, &quot;Up&quot;) ~ colours$direction[[&quot;up&quot;]],
            str_detect(value, &quot;Down&quot;) ~ colours$direction[[&quot;down&quot;]],
            TRUE ~ colours$direction[[&quot;unchanged&quot;]]
          )
          list(color = colour)
        }
      ),
      Windows = colDef(maxWidth = 80, format = colFormat(separators = TRUE)),
      p = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      FDR = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      &quot;Edge Size&quot; = colDef(maxWidth = 80),
     &quot;Leading Edge&quot; = colDef(
       minWidth = 150,
       cell = function(value) with_tooltip(value, width = 50)
     ) 
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Merged windows were mapped to genes and their position amongst the RNA-Seq results was assessed. Windows were classified based on which region was the best overlap, and the direction of H3K27ac binding with E2DHT treatment. 10 sets of windows were associated with changes in gene expression, using only the p-value to rank the 13,043 genes considered as detected.</em>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a8970009c3d19ef9c4ce" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a8970009c3d19ef9c4ce">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"pathway":["Intron","Intergenic (>10kb)","Upstream Promoter (<5kb)","Intron","Intergenic (<10kb)","Promoter (-1500/+500bp)","Upstream Promoter (<5kb)","Intergenic (<10kb)","Exon","Intergenic (>10kb)"],"H3K27ac":["Up","Unchanged","Unchanged","Unchanged","Unchanged","Up","Up","Up","Up","Up"],"Windows":[187,1953,3870,6192,2408,34,38,37,13,34],"p":[1.246404465853597e-08,5.0871542933804908e-08,6.7639716756162556e-08,2.0971618567680638e-07,1.7453276514914865e-05,0.00096643831761091784,0.0012241482313509965,0.0034223265412954393,0.0079960656744232066,0.032967032967032968],"FDR":[1.4956853590243164e-07,2.7055886702465022e-07,2.7055886702465022e-07,6.2914855703041918e-07,4.1887863635795671e-05,0.0019328766352218357,0.0020985398251731368,0.0051334898119431592,0.010661420899230941,0.039560439560439559],"Edge Size":[44,374,575,1106,475,11,6,12,5,11],"Leading Edge":["UGDH; FKBP5; RANBP3L; AC021148.3; ZNF652; ARHGEF37; NRP1; AL033523.1; KDM4B; NEDD4L; SASH1; DIO2; AKAP13; CRYBG1; SPRED1; VSTM2L; IQGAP2; PRKAB2; FGFR2; LMO3; GSTM3; PEA15; SGK3; SORD; MYCBP2; CCDC40; CNNM1; RASSF3; ACACA; GIPR; DSCAM-AS1; PXDC1; STX18-AS1; DLG2; RAD51B; KIAA0825; MAGI2; PRKAA2; DEPTOR; CCDC96; AC007191.1; ACSM1; SMIM14; TOR1AIP2","CLDN8; EAF2; EHF; KRT4; AMIGO2; SERHL2; WWC3; AL033523.1; PTPRJ; PWWP3B; SYBU; AR; ARHGEF28; NEDD4L; GPCPD1; SASH1; SLC15A2; TBC1D16; AL035661.1; SOWAHC; SERHL; DOCK2; AKAP13; SLC22A23; ARL4C; TMTC2; CD9; MCC; IQGAP2; FOXI1; CABLES1; PMEPA1; SLC7A11; MPDZ; NDRG1; TMEM164; BCL2; NFKBIA; RRP7A; SLC16A6; MCCC2; RRP7BP; KLF13; FHDC1; CYP2B7P; AL135905.2; ESR1; TMCC3; DKK1; MTSS1; PREX1; TACR3; CDC42EP3; CXCR4; ENC1; PDGFD; KLF9; GRM4; PCED1B; RNF152; TBC1D8; BCL2L1; COLCA1; STARD13-AS; STARD13; OXGR1; DIPK2A; GNA12; YPEL3; FRMD3; GUCY1A1; ZBTB7C; ANK3; PID1; TBX3; SERPINB2; SEMA6D; TRGC2; GUCY1A2; MYH11; CLEC3A; GPAT3; NAMPT; SLC16A14; SOX5; SPSB1; PXK; LINC02303; TNFAIP8; GATA3; BOC; FAM161A; NPIPB3; LINC01341; EPHB3; RNF144B; LRIG1; KCTD15; DNM3; BCL6; ACACA; GDPD3; AC008268.1; TIPARP; SH3PXD2A; AL603750.1; SLC2A1; HSPA2; PDE4B; RORC; TAPT1; FZD5; NPIPB13; H4C8; SPRY4; MALT1; FHL2; CASD1; MNX1; GET4; AL353622.1; EIF2AK3-DT; TMEM154; CACNA1D; SYDE1; PARTICL; KCNK5; AL158211.5; FSTL1; CDK18; SORD2P; SMKR1; CORO1A; KCTD6; HECW2; KRT23; DBI; RAD51B; RBM34; KRT10; LEKR1; GRK5; SHANK2; TSC22D3; VIPR1; SNORA37; SPRED2; FOXO6; C14orf132; SYTL2; ITGAM; PDE11A; SMAD6; MUC16; CFAP44; AC083843.3; ULK1; RAD17P1; ARRB1; SUSD2; DUSP16; RBM20; LYST; ST6GAL1; AKAP7; SOX11; NEDD4; COLCA2; CSF1; FAM83B; BDKRB2; FAM117A; LRRC37A3; ID1; SKAP1; INPP5J; GADD45B; PIPSL; PLLP; MYRIP; NT5E; CTSO; KL; AC132192.2; MFSD2A; VAMP5; GRHL3; UNC5B; SEMA3C; SILC1; WNT5A; SLC20A1; HAP1; MLLT3; IRS2; RBM26-AS1; MAFB; NTN1; SNORA23; TDO2; WNT4; NOVA1; GRIK3; ZNF519; RHOBTB1; AC093904.4; RRS1; LINC00511; TRIM35; SLC52A3; UBXN10; COL12A1; CYTH1; FABP5; ZFP36L2; ELF3-AS1; LINC00265; C15orf48; CATSPERB; BBOX1; SPRY1; HES1; LURAP1L; MGAT2; EDN2; PRDM4; RASD2; BX470102.2; ATP1A1; MIR1915HG; AADAT; KCNE4; SPOCD1; NKILA; TCF7; AC027097.2; PTCHD1; VASN; HMGCS2; FAM225A; LINC01522; TFCP2L1; AHR; EVL; GPRIN3; MRPL12; AF111167.2; LINC02615; TTYH1; GATA3-AS1; AC106782.1; FAM89A; PAM16; AREG; TMEM254-AS1; NABP1; NUP50-DT; TAPT1-AS1; AP4S1; AC007114.1; AP000766.1; MTUS2; FGD1; AC092910.3; KALRN; STC2; SLC12A5; AL359715.1; GLIS2; C9orf106; BHLHE41; SMCO4; COL17A1; SEMA6B; SIK1B; FOXN3; NCOR2; FZD1; SIK1; AL356273.6; AL591848.4; EEFSEC; HLF; FAM241B; TNFRSF11A; GABPB1-AS1; CCN1; AL157838.1; AL139385.1; ANG; ZCCHC4; ATG101; ZCCHC17; AL157935.2; ANP32B; CLIC6; MPP7; EPHA2; RASGEF1A; TLR3; ITGAV; ATXN1; FAM53A; B3GNTL1; NFIX; DAPK2; APOL3; CHST15; RHOB; ACOX2; PPP1R26-AS1; KIF12; ZNF594; DHCR24; NTRK3; AC009133.1; TNS2; AC097523.1; AL109627.1; RABEP1; AC005332.3; GLCE; LRRC49; THBD; APIP; SRCAP; AC139530.1; UBALD2; AL691482.4; ASAP1; CAP2; CCDC18-AS1; RIPOR3; TSC22D1; TMEM178B; METTL15P1; MR1; LCA5; DAB2IP; ARHGEF19; CA2; CSPG4P12; CUEDC1; SLC25A25-AS1; LTBP4; FOXD1; SERPINB5; UNC5C; ARID5B; PYROXD2; PARP8; TMLHE; ARMCX5-GPRASP2; CEP126; TTYH2; AL360270.2; SCUBE3; LINC02482; RDM1; RPS26P6; PROM1; AC108134.2; ADAMTS17; PPARG; IGF2BP2; PIK3CB; A4GALT; BCL9L; GIHCG; SIX1; CALML5; NR4A1; TRIM62; DHRS2","AQP3; UGDH; FKBP5; SEC14L2; EAF2; HSD11B2; AC021148.3; PISD; ZNF652; ZNF689; ANKRD22; ARHGEF26; EHF; KRT4; AMIGO2; PARM1; ARHGEF37; THBS1; NRP1; WWC3; GREB1; TTC12; KDM4B; PTPRJ; ADD3; SYBU; NEDD4L; CSRNP1; GPRC5A; WWC1; CNTNAP2; IL1R1; TBC1D16; OSGIN1; SLC26A2; AL035661.1; AC068580.3; DIO2; SERHL; PER1; AKAP13; SLC22A23; CRYBG1; KRT15; CD9; TRGC1; CEACAM7; VSTM2L; HS3ST3B1; IQGAP2; SOX9; TNNI2; STON2; CABLES1; PRKAB2; PMEPA1; NDRG1; SRGAP3; TMEM164; BCL2; NFKBIA; CEACAM5; PPFIBP2; MCCC2; GRHL2; HEY2; LNX2; KLF13; TRIM9; BLNK; FAM214A; AC092053.4; CYP2B7P; AL135905.2; ESR1; VAMP1; ADGRV1; MTSS1; PREX1; AL606500.1; STEAP4; ENC1; KLF9; BMP7; GRM4; PCED1B; NXPE3; TPD52; EMP1; TBC1D8; EPN2; COLCA1; AC005920.1; ELL2; STARD13-AS; ADGRG1; STARD13; MYCBP2; AL162377.1; IFITM10; AL445309.1; CRYBG2; LRP2BP; YPEL3; FSBP; TTC21A; CACNB4; ZBTB7C; ANK3; MUC19; CCDC40; PID1; TBX3; SERPINB2; PAQR5; TRGC2; MTMR9; MYH11; CLEC3A; MYRFL; PRKCE; CRAT; NAMPT; TEX19; PXK; ZNF703; CHN1; CBX4; MUC5B; DENND2B; TRMT9B; AC004918.5; IKZF2; ARHGEF26-AS1; TESK2; CEACAM6; TOE1; ITGA5; RNF144B; LRIG1; RASSF3; KCTD15; SOCS3; BX842570.1; RBBP8NL; NYNRIN; IGSF9; BCL6; TRIM66; FAH; HERC3; AC022007.1; KCNB1; GARNL3; SCIN; GDPD3; AC008268.1; GLDC; LIPH; AC022400.8; PXDC1; CISH; CMAHP; APCDD1; DLG2; SLC2A1; OAZ3; PXYLP1; SRMS; LPAR3; BNIPL; LRATD2; RORC; CA13; FZD5; GGT6; NSRP1; SLC22A5; RN7SL674P; HEG1; SNHG30; SPRY4; MYO1F; RNF227; VAV3; DLGAP1-AS1; AC040162.1; ARHGAP8; SEPHS2; NR1H3; SPATA24; SLC29A3; CASD1; DNAJC18; GET4; BBS5; PCDH8; ATP7B; AC068580.4; MAP2; NRCAM; PLEKHH1; DTX4; CACNA1D; AL157392.3; MRFAP1; DHRS3; LBP; RFLNA; SLC44A5; PARTICL; AL158211.5; SORD2P; PRR15L; PRAG1; CORO1A; KCTD6; CD160; AP000844.2; AC027702.2; FERMT1; TRERF1; SYT8; DBI; KLF3-AS1; LRRC46; RAD51B; HSP90AA2P; VMP1; DOK7; PIM1; GRK5; RPH3AL; BAG3; SHANK2; ZMIZ1; PPP1R3D; PROSER3; ARID5A; HOXC4; OSR2; S100A8; SLC25A35; SMIM5; AL137782.1; EGLN3; TMEM63C; RAB30; SNORA37; SPRED2; GSDME; ITGAM; GSN-AS1; CXXC4; PDE11A; AC118344.4; ZNRF1; ULK1; CNOT4; SLC4A8; IQCN; GLI4; MRPL38; IQCH-AS1; IRX6; ARRB1; KRT81; ZNF385A; ID3; BDNF-AS; VCPKMT; NPRL3; RBM20; TCF7L2; SLC6A17; AC026979.4; KLRG2; ST6GAL1; AZGP1P1; PSMD6-AS2; LINC01176; HGD; WNT2B; NEDD4; ICOSLG; COLCA2; ZFX; AL353593.1; DRC3; CSF1; SYT15; LOXL3; MAST3; PSCA; NOL6; MMP25; ID1; SKAP1; INPP5J; GADD45B; ENPP1; BCYRN1; AIFM2; IFNLR1; CNOT2-DT; SPRR3; AL135905.1; FGD6; BTN2A3P; MFF-DT; RNU4-1; CTSO; GUCY1B1; KL; CCDC96; ANKRD61; ENTPD1-AS1; AP005131.6; MFSD2A; SAMD10; VAMP5; PLEKHA2; RPS10P3; GRHL3; PDPR; CARMIL1; MAGIX; AC020904.2; GRAMD1B; DRAIC; SLC20A1; HAP1; LMNTD2-AS1; NFATC2; DGAT2; RBM26-AS1; TRIM36; RABGEF1; TMEM62; LRRC26; TLK2P1; TDO2; SMIM14; ABCC3; RAVER1; TGFB1I1; FP565260.3; CHRM1; IZUMO4; HERC6; GRIK3; AC141586.1; DPF1; IGFBP3; AC234917.3; MYB; AMH; LINC00511; AP000350.6; ADAMTSL4; IL17RE; SLC52A3; UBXN10; AC232271.1; ARHGEF3; RAB11B-AS1; ZFP36L2; LIF; LINC00265; NFKBIZ; NKX2-1; C15orf48; SERTAD1; AC092171.5; CFAP45; CATSPERB; HCAR1; HES1; DNASE1L2; HUS1; MGAT2; AC007405.4; EML6; BACE1-AS; PRDM4; RASD2; BX470102.2; ATP1A1; PTCH1; TMEM160; SPOCD1; HOXC6; PXMP4; FRMD4A; RAPGEF4; AC027097.2; KLF8; EFNA4; HMGCS2; RPS6KA2; HEBP1; SNHG22; LINC01522; TMEM191A; EVL; BCCIP; AC010184.1; BCAR3; LINC01089; MIR3936HG; TMEM44; AC090772.5; NAV1; EPN3; TRIM45; AC106782.1; PAM16; SAMD15; TMEM254-AS1; PHKA1; GPR162; IQCD; SIDT1; AL928654.1; RPL29P11; ADPRM; NRM; BAHCC1; AC013394.1; AC090517.5; HOOK1; ZNF117; FOXA3; AC018809.2; LRRC15; AC020978.9; TSKU; EFNA3; CDKN2B-AS1; FCGRT; KSR1; AC141930.1; STBD1; AC092910.3; KALRN; AC121338.2; IRF5; AC092117.2; FO681492.1; RGS16; CSTA; ZSCAN12; SHROOM2; RNF215; GCNA; ZFPL1; MS4A7; CSRNP2; ASB16-AS1; FKRP; AC005041.1; SPRYD7; KDM6B; RILP; OPLAH; RAP1GAP; FOXN3; FMO5; SRRM2; GPR157; AL158163.1; CRELD1; NCOR2; SELENON; GXYLT2; NNAT; DICER1-AS1; C15orf62; EEFSEC; UBAP1L; MAN1C1; DNMT3B; FAM47E; ABTB1; MIR34AHG; DNMBP; MLKL; AC008895.1; CCN1; THAP7-AS1; AL157838.1; AL139385.1; ANG; ATG101; MTMR11; MLLT11; ZCCHC17; FEM1A; CCDC157; HTR7P1; AC133555.3; SUFU; SLC24A3; ANP32B; SEPTIN1; CCDC124; CLIC6; MPP7; EML5; HDAC10; AC084082.1; RASGEF1A; PALM2AKAP2; AC097376.3; PRELID2; SDHAF2; SLC27A5; LASP1; RFLNB; SCAMP5; MAPK15; AC006449.7; GSEC; WDR60; ZNF688; ID2; FTX; PRR12; TRIM17; FLNB-AS1; FAM81A; PLAAT4; B3GNTL1; AC104109.2; PITX1; CYP4Z2P; C3orf18; NFIX; C22orf46; RTN4RL1; AL049834.1; PLEKHG5; AC009126.1; EEPD1; RHOB; PSG4; BICRA; KCNMA1; ACOX2; FBXL16; POM121C; BAALC-AS1; VPS37D; KIF12; CRYBB2P1; TMC8; DHCR24; HDAC9; AL158212.3; ALPK3; LIN7B; TMED2-DT; CLN3; OLMALINC; GPKOW; AC097523.1; SNORD3C; SYNE3; ZNF764; SNHG19; RFX2; LRRC49; THBD; NHEJ1; AC087289.5","UGDH; FKBP5; STEAP2; RANBP3L; HSD11B2; AC021148.3; PISD; ZNF652; OTULINL; ARHGEF26; EHF; AMIGO2; PARM1; ARHGEF37; GLUL; THBS1; NRP1; EPGN; WWC3; CROT; GREB1; AL033523.1; KDM4B; PTPRJ; ADD3; SYBU; AR; MYLIP; ARHGEF28; NEDD4L; GPRC5A; FAM49A; WWC1; SASH1; PRR15; CNTNAP2; IL1R1; TBC1D16; SCUBE2; SLC26A2; AL035661.1; FRK; DIO2; SOWAHC; SERHL; DOCK2; SLC22A23; TBC1D2; CRYBG1; KRT15; LEF1; GRIN2B; BAMBI; TMTC2; DAB2; CD9; PDE10A; PLCL1; SPRED1; PPP3CA; TRGC1; CEACAM7; MCC; VSTM2L; IQGAP2; SOX9; STON2; CABLES1; JUN; SOSTDC1; PRKAB2; NADK2; PMEPA1; MPDZ; NDRG1; SRGAP3; SLC37A2; TMEM164; IL20RA; BCL2; CEACAM5; RRP7A; PPFIBP2; SLC16A6; MCCC2; GRHL2; AC007255.1; HEY2; TRIM9; TRIM2; FHDC1; BLNK; TGFB3; CYP2B7P; FAM167A; FGFR2; ESR1; TMCC3; SERPINI1; ASB13; SSTR2; PARP9; SLC25A18; AL645768.1; ADGRV1; MTSS1; ADH1C; PREX1; ATP13A4; PLEKHH2; POU2F3; STEAP4; MKLN1-AS; GSTM3; KLF9; PGR; PEA15; GRM4; PCED1B; RNF152; NXPE3; TPD52; INSYN2A; SGK3; EMP1; TBC1D8; EPN2; BCL2L1; CDRT1; AC005920.1; SORD; ELL2; STARD13-AS; STARD13; MYCBP2; KLF5; OXGR1; AL445309.1; FAM107B; GNA12; HMGN5; LFNG; AC005912.1; LRP2BP; FRMD3; FSBP; WWTR1; CACNB4; DOCK4; ZBTB7C; ANK3; F2R; MUC19; AL157895.2; RARRES1; TP53TG1; CCDC40; CNNM1; ALCAM; TBX3; PAQR5; LRCH1; SEMA6D; TRGC2; GUCY1A2; MYH11; CLEC3A; MYRFL; ID2-AS1; SNX25; VWFP1; PRKCE; NUAK1; PDE9A; CRAT; GPAT3; SLC16A14; NR3C2; SOX5; PACSIN2; GPSM2; AK4; SPSB1; PXK; LINC02303; CHN1; GCOM1; FBXO32; TNFAIP8; SLC9A1; KMO; GATA3; AC004918.5; BOC; FAM161A; GPR137C; IKZF2; IGFBP4; ARHGEF26-AS1; TESK2; CEACAM6; SYT16; SLC6A9; Z83843.1; NPIPB3; ZNF552; SAP30L-AS1; TOE1; LINC01341; CPM; EPHB3; ITGA5; GCNT1; SGSM1; RNF144B; LRIG1; RASSF3; SOCS3; RBBP8NL; NYNRIN; DNM3; BCL6; UAP1; FAH; HERC3; AP000331.1; AC022007.1; KCNB1; GARNL3; SCIN; ACACA; AC008268.1; CREB3L1; RPL39P3; SLC38A2; GLDC; GIPR; DSCAM-AS1; ADCY2; RAB11FIP1P1; TIPARP; PGM5; LYPD6; LIPH; AC022400.8; PXDC1; SH3PXD2A; PHLDA1; STX18-AS1; CMAHP; DOCK8; AL441992.2; SPAG5-AS1; DLG2; SLC2A1; CD44; ADIRF-AS1; PDE4B; PXYLP1; TGFBR3; DLC1; LPAR3; LRATD2; AL158206.1; CENPS; SEMA3F-AS1; CA13; FZD5; GGT6; PIK3C2G; SAMD12-AS1; RGL1; AC105285.1; H4C8; SLC22A5; RN7SL674P; HEG1; GPR161; SPRY4; MYO1F; AC005083.1; VAV3; HMGCS1; CRYM; DLGAP1-AS1; NKD1; LINC01814; AC040162.1; ARHGAP8; TFPI2; ZNF232; SPATA24; FHL2; TTC32; C20orf144; SLC29A3; ARL10; CASD1; MNX1; DNAJC18; GET4; ATP7B; AL353622.1; MAP2; CICP14; NRCAM; PLEKHH1; DTX4; CACNA1D; AL157392.3; PLCH2; DHRS3; DDR2; RFLNA; SLC44A5; KCNK5; WNT9A; TAMM41; FSTL1; PRR15L; PRAG1; GLCCI1; SMKR1; TCP11L2; CD160; AP000844.2; HECW2; TRERF1; KRT23; DBI; KLF3-AS1; LRRC46; RAD51B; KIAA0825; VMP1; ARHGAP40; AC005562.1; AL390726.5; PDIA5; PCDH10; ACACB; PIM1; LEKR1; CGNL1; STOX1; MAGI2; SRCIN1; MOK; BAG3; SHANK2; ZMIZ1; LINC01881; THSD1; OSR2; TSC22D3; TES; PRKAA2; SMIM5; AL137782.1; EGLN3; CMTM8; TMEM63C; VIPR1; RAB30; LIMD2; SNORA37; SPRED2; HSPG2; FOXO6; SPCS2P4; C14orf132; SYTL2; LMO4; MEGF11; GSN-AS1; ADAM19; RNF150; PDE11A; LYRM9; SMAD6; CHPT1; NRAD1; SCYL3; ZNRF1; AC083843.3; ULK1; RAD17P1; HNRNPCP2; DEPTOR; NRARP; IRX6; ARRB1; ZNF385A; VIPR1-AS1; ID3; PHLDB1; ANXA3; BDNF-AS; SUSD2; DUSP16; VCPKMT; SLC35F1; AL357568.1; ZBTB10; RBM20; TJP2; EXOC3-AS1; TCF7L2; SLC6A17; ZNF837; AC026979.4; KLRG2; ST6GAL1; AC138028.4; AL133230.2; AKAP7; SOX11; AZGP1P1; PSMD6-AS2; STARD5; AC113404.3; LINC01176; HGD; ZMYND10; WNT2B; NEDD4; ICOSLG; COLCA2; PGAM4; RHBDL3; ERVMER34-1; CSF1; FAM83B; BDKRB2; CBARP; CCDC82; FAM117A; MAST3; CD163L1; LRRC37A3; RNF43; AL133243.2; CEP112; AC007285.1; NCCRP1; REEP1; ID1; DTX2; SKAP1; COL5A2; INPP5J; AC116533.1; GADD45B; PIPSL; ENPP1; BCYRN1; AIFM2; PIFO; MNS1; PTAFR; FRAS1; IFNLR1; CNOT2-DT; PPARGC1B; MYRIP; CNKSR3; MAP1B; NT5E; FGD6; BTN2A3P; IFI6; MFF-DT; CTSO; GUCY1B1; KL; CCDC96; ANKRD61; AP000873.2; Z99129.4; ENTPD1-AS1; AP005131.6; NFASC; SAMD10; VAMP5; LIFR; PLCH1; PLEKHA2; SLC16A2; URB1-AS1; GRHL3; UNC5B; PDPR; CARMIL1; SLC27A6; SEMA3C; MAGIX; WNT5A; GRAMD1B; DRAIC; SLC20A1; ACSM1; NFATC2; MLLT3; AP001816.1; IRS2; ANKRD44; AL391001.1; RBM26-AS1; AC007996.1; PRUNE2; EPB41L2; NTN1; TMEM62; LRRC26; ARL15; TLK2P1; EPM2A; CCDC34; RPS7P1; TDO2; SMIM14; AC115223.1; ABCC3; GAB2; FP565260.3; TOR1AIP2; CHRM1; RFESD; SNTB1; CEACAM1; HERC6; FAM222B; GRIK3; LRRC75A; NSMCE3; GBP2; DPF1; AC007637.1; CEMIP2; APBA1; TMOD1; MYB; AC108519.1; RHOBTB1; MOCS1; AC093904.4; GNB1L; RRS1; G3BP2; CXCR6; LINC00511; AP000350.6; CLHC1; DBP; ADAMTSL4; IL17RE; TXNDC16; SLC52A3; UBXN10; PINK1-AS; AC009061.2; CYTH1; AC232271.1; ARHGEF3; RAB11B-AS1; MAGI3; TUBB3; ZNF501; ZFP36L2; STAT5A; LIF; FDX2; LINC00265; NFKBIZ; CBR3-AS1; PRR19; ZNF410; GADD45G; RMDN2; SUPT3H; CATSPERB; BBOX1; MEIS1; AC005831.1; HCAR1; OPN3; HUS1; TSFM; LURAP1L; TSPAN12; TSPAN5; AC007405.4; ADAMTS13; EML6; PRDM4; PLAAT1; TP53INP2; ATP1A1; ENTPD3-AS1; AADAT; KCNE4; SPOCD1; FANCE; BPIFA4P; PXMP4; FRMD4A; RAPGEF4; RNF166; TCF7; QDPR; SLC39A14; AC027097.2; EFNA4; VASN; SLC16A4; HMGCS2; PLEKHG4B; PLEKHG1; RPS6KA2; HEBP1; LINC01116; SP140L; SLC16A10; LINC01522; PPIAP29; LDHD; FAM221A; AHR; CCDC167; SPIN3; EVL; BCCIP; GPRIN3; ZNF596; AC010184.1; BCAR3; LINC01089; LIPE; AF111167.2; GALNT10; DNM1; BCL2L11; LINS1; MIR3936HG; ARMCX1; PCDHA12; TMEM44; MCOLN2; IL17RD; LINC02615; MMEL1; DAPK1; EPN3; GMDS-DT; GATA3-AS1; LAMTOR5-AS1; TRIM45; FAM89A; PAM16; PHKA1; SIAH2; IQCD; ARHGAP27P1-BPTFP1-KPNA2P3; FOXN3-AS1; CD302; BMF; SIDT1; AL928654.1; TMEM42; NRM; TFB1M; AC013394.1; SMIM3; AC090517.5; AC093642.2; AP4S1; HOOK1; ZNF117; AC018809.2; CACNA2D2; AC020978.9; RCBTB2; ZEB1-AS1; EFNA3; CDKN2B-AS1; AXIN2; AL451123.1; KSR1; AC141930.1; STBD1; GRB7; CLIP2; AC092910.3; STAMBPL1; KALRN; PTOV1-AS2; PPARD; AC138028.2; AL390719.1; FAM66C; GLIS2; TUT7; CSTA; RPS2P55; C9orf106; LINC02809; SLC5A9; LYSMD4; AL451165.2; TBC1D30; ZSCAN12; MB21D2; LCMT1-AS2; SHROOM2; USP49; MPC2; MS4A7; ASB16-AS1; BHLHE41; FKRP; STXBP6; BRD7P2; CCDC7; SMCO4; WDFY3-AS2; ZBED3; RILP; LINC-PINT; CCDC134; RSKR; CMPK2; RGS2; AL121906.2; RAP1GAP; FOXN3; NFIL3; POLR2J4; NCK1-DT; PCDHAC1; MAP2K6; FMO5; SRRM2; OAS1; GPR157; AL158163.1; AC093752.1; TATDN2P2; CDC42EP1; CRELD1; NCOR2; PIK3IP1; SELENON; AC104667.2; LRRTM2; FAM151B; GAR1; USP35; AC104825.1; DICER1-AS1; AC074117.1; AL591848.4; TAF13; ATP6V1B2; CASC2; C15orf62; EEFSEC; HLF; ATP6V1B1; MAN1C1; PARD3B; DNMT3B; ANKRD62P1; PPM1M; FAM47E; ABTB1; ATP13A5; MIR34AHG; FAM189A2; DNMBP; H3P47; AMIGO1; FAM124A; SEMA7A; AC008895.1; CCN1; THAP7-AS1; AL157838.1; ANKRD34A; AL139385.1; ZNF814; YPEL1; MTMR11; ZCCHC17; HTR7P1; ZNF431; AC135050.6; AC133555.3; SUFU; SLC24A3; SH3RF2; SPC25; AL157935.2; ANP32B; AC080013.1; MAP1S; CLIC6; COL27A1; MPP7; EML5; NRSN2-AS1; BMP1; EOGT; AC084082.1; C15orf41; RASGEF1A; PALM2AKAP2; APTR; SMPDL3A; AC087521.2; AC097376.3; PRELID2; AL009174.1; SLC27A5; SLC35C1; LASP1; SCAMP5; ATXN1; GSEC; LINC00624; WDR60; ACTN2; FTX; FLNB-AS1; FAM81A; PLAAT4; FGFR1OP; AC104109.2; PITX1; CYP4Z2P; TNS1; RTN4RL1; AL049834.1; PLEKHG5; SLC25A32; C3orf62; DAPK2; AC009126.1; NSMCE1-DT; KRT8P45; CHST15; NMB; CLSTN2; AC008966.1; PGD; BICRA; KCNMA1; SRP9P1; FBXL16; CRY2; ATL1; MPND; DMTN; HOXB7; CCDC71L; VPS37D; CRYBB2P1; ZNF594; DHCR24; CAMKMT; HDAC9; AL158212.3; XG; ALPK3; PLD6; TRIM68; AK1; CLN3; DIPK1B; OLMALINC; GPKOW; RABEP1; KCNQ1OT1; KDM4A-AS1; ZSWIM3; PRSS53; GLCE; RFX2; ZNF438; LRRC49; HOMER2; IRAK2; APIP; CPS1; GPRASP1; KIAA1211L; AC104447.1; OCEL1; LARGE1; PDLIM1; SRCAP; JOSD2; ABLIM3; ETHE1; KLHL8; POLE4; UBALD2; MFSD13A; PLA2R1; MAPT; CFAP157; UBASH3B; CPQ; ASAP1; CENPQ; METAP1D; AP001107.1; RAD51-AS1; CSGALNACT1; AC139887.2; ELK3; RPS17; CAP2; C1QTNF6; TMEM143; TMEM8B; NOL4L; AC010536.1; KCNS3; HINT2; KLF3; CYSRT1; SUSD3; ACSS1; ENOX1; CNFN; GTF2IP13; PPP1R37; RIPOR3; TSC22D1; TMEM178B; LINC01521; METTL15P1; MR1; ELAVL2; CAMKK1; KCNJ13; GGACT; TIMP2; AC092279.2; KLC3; IGSF8; AC091982.3; CPAMD8; ZFPM1; HS6ST1; ZNF782; DLEU1; CAPZB; DAB2IP; NATD1; ERMAP; ROBO1; LRRC27; TTC13; CUEDC1; MLXIP; OTUD7A; MAOB; PLAAT3; RBIS; DOCK3; USP3-AS1; MBTPS1; TUBD1; DGLUCY; MED21; AL391684.1; UCKL1-AS1; SERPINB5; UNC5C; HNF4G; ARID5B; BCAS3; ARMCX5-GPRASP2; SMOC1; AL031666.1; FBXO27; CEP126; LZTS3; TTYH2; AC005632.6; MATN3; WNT3; AL355488.1; SCUBE3; BOLA2-SMG1P6; ULBP2; ALKBH7; NDST2; MGAM; MTCL1; FAM161B; SIN3B; MAP3K5; ARHGAP44; TEX9; ACYP2; AC018521.5; CAMP; PROM1; SERGEF; STRADB; AC011476.3; ADAMTS17; ANGPTL4; AC018797.3; CRISPLD2; AUH; IGF2BP2; PIK3CB; DNAH11; RGS9BP; RTN4IP1; DBNDD2; ABCC12; A4GALT; AC004943.2; NOSTRIN; BCL9L; MAFF; EPS8; CTU2; NOD2; GIHCG; PPP3CB-AS1; SIX1; SESTD1; NR4A1; TRIM62; AP003498.1; DHRS2; EFNA5; NEK5; FUT4; PAX9; GRTP1; TMEM186; AC015712.2; ASH1L-AS1; ZNF428; MYC; ZC3H12A; FBXL3; SPAG6; AC073857.1; GSDMB; CTSS; YBX1P1; RERG; JMJD7-PLA2G4B; RAB19; NDFIP2; MRC2; NHSL1; TPO; ANAPC11; EML3; CTNND2; CST6; CRTC3; KIF13B; MED4; KCNC3; ZBED3-AS1; TOB1-AS1; EIF4A3; KIAA1522; CDON; TLE1; DHRS4; KTN1-AS1; AC008014.1; CCDC74A; NCALD; WDR66; TTLL1; IQCG; SH3TC1; AC139149.1; KIAA1671; AL121839.2; AL731571.1; TMC5; MAML2; LRRC8C; PYDC1; HS6ST1P1; H2BC10; DACH1; ARSJ; H3P36; DCST1-AS1; TPRN; AL445363.3; STX18; ZSCAN21","AQP3; FKBP5; ZNF689; ANKRD22; OLR1; EHF; AMIGO2; ARHGEF37; SERHL2; GLUL; WWC3; CROT; AR; CSRNP1; GPRC5A; SASH1; IL1R1; TBC1D16; AL035661.1; AC068580.3; PER1; DOCK2; AKAP13; ASRGL1; KRT15; LEF1; TENT5C; TRGC1; IQGAP2; TNNI2; FOXI1; NFKBIA; RRP7A; MCCC2; GRHL2; PLEKHD1; BIRC3; KLF13; TRIM2; BMP4; BLNK; PARP14; AC092053.4; CYP2B7P; ECI2; TMCC3; ASB13; PARP9; PREX1; ATP13A4; ENC1; GSTM3; PGR; BMP7; GRM4; PCED1B; RNF152; NXPE3; TPD52; EMP1; BCL2L1; COLCA1; RAB6C; AC005920.1; SORD; ELL2; AL162377.1; KLF5; IFITM10; LFNG; TTC21A; ZBTB7C; ANK3; MUC19; TMEM17; TP53TG1; SERPINB2; TRGC2; CLEC3A; ATP10A; GNMT; VWFP1; PRKCE; HECTD3; NAMPT; TEX19; SPSB1; ZNF703; LINC02303; CHN1; CBX4; MUC5B; FBXO32; TRMT9B; GATA3; IKZF2; IGFBP4; ARHGEF26-AS1; TESK2; TOE1; EPHB3; KCTD15; SOCS3; ARSK; NYNRIN; IGSF9; BCL6; AC008268.1; CREB3L1; SLC38A2; GLDC; GIPR; LIPH; PHLDA1; AL603750.1; DLG2; SLC2A1; CD44; LPAR3; TAPT1; AC024896.1; SAMD12-AS1; RGL1; H4C8; AC005083.1; VAV3; CRYM; ARHGAP8; SEPHS2; FHL2; C20orf144; CASD1; ATP7B; AC068580.4; CACNA1D; MRFAP1; PLCH2; DHRS3; SYDE1; SLC44A5; PARTICL; AL158211.5; QSOX2; TSPAN33; PRAG1; HECW2; TRERF1; SYT8; KRT23; KLF3-AS1; VMP1; ARHGAP40; SGPP1; BAG3; S100A8; VIPR1; SPRED2; FOXO6; C14orf132; SYTL2; GSN-AS1; SMAD6; AC083843.3; ULK1; RAD17P1; CNOT4; IQCN; GLI4; NUDT11; VIPR1-AS1; SUSD2; ZBTB10; RBM20; SLC6A17; AC026979.4; KLRG2; AL133230.2; SOX11; AZGP1P1; LINC01176; HGD; NEDD4; C7orf31; COLCA2; CSF1; BDKRB2; LRRC37A3; POP1; NOL6; ID1; DTX2; SKAP1; MGAT5B; GADD45B; LINC00641; IFNLR1; IFI6; POTEKP; KL; AC132192.2; FRAT1; AL135999.1; MFSD2A; VAMP5; CARMIL1; THTPA; AC020904.2; SILC1; RHPN1-AS1; SLC20A1; AC007191.1; MLLT3; FZD7; PAK6; SETP14; IZUMO4; RFESD; HERC6; GRIK3; ZNF714; CEMIP2; AC234917.3; MYB; SESN3; RRS1; AP000350.6; CLHC1; DBP; SLC52A3; UBXN10; TNNI1; RPL23AP2; ALPK1; ELF3-AS1; LIF; LINC00265; NFKBIZ; HSPBAP1; C15orf48; CFAP45; SPRY1; HES1; UROD; TSFM; TSPAN5; EDN2; MCOLN3; PRDM4; RASD2; BX470102.2; MIR1915HG; AADAT; SPOCD1; FANCE; PXMP4; NKILA; PTCHD1; HMGCS2; AHR; EVL; GPRIN3; MRPL12; AF111167.2; RNU4-2; PCDHA12; LINC02615; MMEL1; DAPK1; GATA3-AS1; SERPINE1; RPSAP47; AREG; TMEM254-AS1; BMF; FAM89B; SALL2; BAHCC1; TAPT1-AS1; HOOK1; FOXA3; LRRC15; AC007114.1; TSKU; MSX1; KSR1; GRB7; CLIP2; AC092910.3; STC1; PPARD; STC2; MTHFS; AL359715.1; TUT7; TMEM216; CSTA; AP000350.7; C9orf106; AL451165.2; KCNK1; BHLHE41; FKRP; AL121906.2; DDT; MAP2K6; GPR157; AL158163.1; CDC42EP1; NCOR2; C15orf62; TNFRSF11A; PARD3B; ANKRD62P1; DNMBP; SEMA7A; CCN1; AL157838.1; ANG; SLC25A53; ZCCHC4; ATG101; ZCCHC17; FEM1A; SUFU; MAP1S; DTX1; EPHA2; MAD2L1BP; SEMA4G; ITGAV; PALM2AKAP2; PRELID2; SDHAF2; LASP1; FAM53A; WDR60; ZNF688; FAM81A; PITX1; Z99572.1; POU2F1; CHST15; RHOB; BICRA; HOXB7; AP1AR; FKBP9P1; ZNF594; XG; LIN7B; CLN3; AC097523.1; RABEP1; SYNE3; AC005332.3; ZNF764; GLCE; LRRC49; THBD; KIAA1211L; SRCAP; ABLIM3; ETHE1; KLHL8; AC139530.1; ZNF319; POLE4; SRRM3; EMSLR; AL691482.4; ASAP1; CENPQ; RNF125; ELK3; TMEM143; ZDHHC18; ZBTB9; KLF3; SUSD3; ACSS1; RIPOR3; TSC22D1; LINC01504; MR1; RFX1; TIMP2; HS6ST1; DAB2IP; AC009078.3; CSPG4P12; SIX5; AC131971.1; CUEDC1; MLXIP; CHST3; FOXD1; UQCRHL; TUBD1; MED21; RAC2; ARID5B; PARP8; CEP126; WNT3; B3GLCT; MYPOP; LINC02482; RPS26P6; AC018521.5; PROM1; AC108134.2; LGALS1; ADAMTS17; ZNF114; RGS9BP; RTN4IP1; ABCC12; A4GALT; BCL9L; MAFF; GIHCG; SIX1; CALML5; SESTD1; TRIM62; AP003498.1; DHRS2; ANKRD18B; MYC; ZC3H12A; RAB19; NHSL1; FZD2; AL360270.1; KCNG1; KIF13B; AL009179.1; FBXO4; ZNF786; TOB1-AS1; EIF4A3; KIAA1522; TNFRSF14; SLC15A1; AC005914.1; CCDC74A; NCALD; FCRLB; SH3TC1; HS6ST1P1; H2BC10; ZSCAN21; PSD4; EIF2AK4; NCEH1; HSPA12A; SCARA3; MINCR; AL390719.2; BTN2A2; ZNF19; AC007114.2; FAM241A; CACNA1H; SECTM1; MRM1; ITPRIPL2; C9orf152; LSM10; DLGAP3; ABTB2; NKAIN1; VAV1; CCNB3; RPL14P1","SEC14L2; ZNF689; TTC12; SYBU; CSRNP1; AC092053.4; TTC21A; MTMR9; CRAT; PEX10; CHPT1","FKBP5; HSD11B2; PTPRJ; MCCC2; ECI2; MYCBP2","AQP3; EHF; SYBU; WWC1; CD9; NFKBIA; NAMPT; PRAG1; VIPR1; VIPR1-AS1; DUSP16; NOL6","UGDH; AC021148.3; AKAP13; RAB6C; SMIM14","EHF; GPCPD1; TMEM164; TMEM17; SCIN; ZFX; MAFB; KCNE4; SPRYD7; ATG101; ITGAV"]},"columns":[{"id":"pathway","name":"Region","type":"character","minWidth":100},{"id":"H3K27ac","name":"H3K27ac","type":"character","cell":["⇧ Up"," Unchanged"," Unchanged"," Unchanged"," Unchanged","⇧ Up","⇧ Up","⇧ Up","⇧ Up","⇧ Up"],"maxWidth":90,"style":[{"color":"#CA0020"},{"color":"#7F7F7F"},{"color":"#7F7F7F"},{"color":"#7F7F7F"},{"color":"#7F7F7F"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"}]},{"id":"Windows","name":"Windows","type":"numeric","format":{"cell":{"separators":true},"aggregated":{"separators":true}},"maxWidth":80},{"id":"p","name":"p","type":"numeric","cell":["1.25e-08","5.09e-08","6.76e-08","2.10e-07","1.75e-05","9.66e-04","1.22e-03","3.42e-03","8.00e-03","3.30e-02"],"maxWidth":80},{"id":"FDR","name":"FDR","type":"numeric","cell":["1.50e-07","2.71e-07","2.71e-07","6.29e-07","4.19e-05","1.93e-03","2.10e-03","5.13e-03","1.07e-02","3.96e-02"],"maxWidth":80},{"id":"Edge Size","name":"Edge Size","type":"numeric","maxWidth":80},{"id":"Leading Edge","name":"Leading Edge","type":"character","cell":[{"name":"span","attribs":{"title":"UGDH; FKBP5; RANBP3L; AC021148.3; ZNF652; ARHGEF37; NRP1; AL033523.1; KDM4B; NEDD4L; SASH1; DIO2; AKAP13; CRYBG1; SPRED1; VSTM2L; IQGAP2; PRKAB2; FGFR2; LMO3; GSTM3; PEA15; SGK3; SORD; MYCBP2; CCDC40; CNNM1; RASSF3; ACACA; GIPR; DSCAM-AS1; PXDC1; STX18-AS1; DLG2; RAD51B; KIAA0825; MAGI2; PRKAA2; DEPTOR; CCDC96; AC007191.1; ACSM1; SMIM14; TOR1AIP2"},"children":["UGDH; FKBP5; RANBP3L; AC021148.3; ZNF652; ARHGE..."]},{"name":"span","attribs":{"title":"CLDN8; EAF2; EHF; KRT4; AMIGO2; SERHL2; WWC3; AL033523.1; PTPRJ; PWWP3B; SYBU; AR; ARHGEF28; NEDD4L; GPCPD1; SASH1; SLC15A2; TBC1D16; AL035661.1; SOWAHC; SERHL; DOCK2; AKAP13; SLC22A23; ARL4C; TMTC2; CD9; MCC; IQGAP2; FOXI1; CABLES1; PMEPA1; SLC7A11; MPDZ; NDRG1; TMEM164; BCL2; NFKBIA; RRP7A; SLC16A6; MCCC2; RRP7BP; KLF13; FHDC1; CYP2B7P; AL135905.2; ESR1; TMCC3; DKK1; MTSS1; PREX1; TACR3; CDC42EP3; CXCR4; ENC1; PDGFD; KLF9; GRM4; PCED1B; RNF152; TBC1D8; BCL2L1; COLCA1; STARD13-AS; STARD13; OXGR1; DIPK2A; GNA12; YPEL3; FRMD3; GUCY1A1; ZBTB7C; ANK3; PID1; TBX3; SERPINB2; SEMA6D; TRGC2; GUCY1A2; MYH11; CLEC3A; GPAT3; NAMPT; SLC16A14; SOX5; SPSB1; PXK; LINC02303; TNFAIP8; GATA3; BOC; FAM161A; NPIPB3; LINC01341; EPHB3; RNF144B; LRIG1; KCTD15; DNM3; BCL6; ACACA; GDPD3; AC008268.1; TIPARP; SH3PXD2A; AL603750.1; SLC2A1; HSPA2; PDE4B; RORC; TAPT1; FZD5; NPIPB13; H4C8; SPRY4; MALT1; FHL2; CASD1; MNX1; GET4; AL353622.1; EIF2AK3-DT; TMEM154; CACNA1D; SYDE1; PARTICL; KCNK5; AL158211.5; FSTL1; CDK18; SORD2P; SMKR1; CORO1A; KCTD6; HECW2; KRT23; DBI; RAD51B; RBM34; KRT10; LEKR1; GRK5; SHANK2; TSC22D3; VIPR1; SNORA37; SPRED2; FOXO6; C14orf132; SYTL2; ITGAM; PDE11A; SMAD6; MUC16; CFAP44; AC083843.3; ULK1; RAD17P1; ARRB1; SUSD2; DUSP16; RBM20; LYST; ST6GAL1; AKAP7; SOX11; NEDD4; COLCA2; CSF1; FAM83B; BDKRB2; FAM117A; LRRC37A3; ID1; SKAP1; INPP5J; GADD45B; PIPSL; PLLP; MYRIP; NT5E; CTSO; KL; AC132192.2; MFSD2A; VAMP5; GRHL3; UNC5B; SEMA3C; SILC1; WNT5A; SLC20A1; HAP1; MLLT3; IRS2; RBM26-AS1; MAFB; NTN1; SNORA23; TDO2; WNT4; NOVA1; GRIK3; ZNF519; RHOBTB1; AC093904.4; RRS1; LINC00511; TRIM35; SLC52A3; UBXN10; COL12A1; CYTH1; FABP5; ZFP36L2; ELF3-AS1; LINC00265; C15orf48; CATSPERB; BBOX1; SPRY1; HES1; LURAP1L; MGAT2; EDN2; PRDM4; RASD2; BX470102.2; ATP1A1; MIR1915HG; AADAT; KCNE4; SPOCD1; NKILA; TCF7; AC027097.2; PTCHD1; VASN; HMGCS2; FAM225A; LINC01522; TFCP2L1; AHR; EVL; GPRIN3; MRPL12; AF111167.2; LINC02615; TTYH1; GATA3-AS1; AC106782.1; FAM89A; PAM16; AREG; TMEM254-AS1; NABP1; NUP50-DT; TAPT1-AS1; AP4S1; AC007114.1; AP000766.1; MTUS2; FGD1; AC092910.3; KALRN; STC2; SLC12A5; AL359715.1; GLIS2; C9orf106; BHLHE41; SMCO4; COL17A1; SEMA6B; SIK1B; FOXN3; NCOR2; FZD1; SIK1; AL356273.6; AL591848.4; EEFSEC; HLF; FAM241B; TNFRSF11A; GABPB1-AS1; CCN1; AL157838.1; AL139385.1; ANG; ZCCHC4; ATG101; ZCCHC17; AL157935.2; ANP32B; CLIC6; MPP7; EPHA2; RASGEF1A; TLR3; ITGAV; ATXN1; FAM53A; B3GNTL1; NFIX; DAPK2; APOL3; CHST15; RHOB; ACOX2; PPP1R26-AS1; KIF12; ZNF594; DHCR24; NTRK3; AC009133.1; TNS2; AC097523.1; AL109627.1; RABEP1; AC005332.3; GLCE; LRRC49; THBD; APIP; SRCAP; AC139530.1; UBALD2; AL691482.4; ASAP1; CAP2; CCDC18-AS1; RIPOR3; TSC22D1; TMEM178B; METTL15P1; MR1; LCA5; DAB2IP; ARHGEF19; CA2; CSPG4P12; CUEDC1; SLC25A25-AS1; LTBP4; FOXD1; SERPINB5; UNC5C; ARID5B; PYROXD2; PARP8; TMLHE; ARMCX5-GPRASP2; CEP126; TTYH2; AL360270.2; SCUBE3; LINC02482; RDM1; RPS26P6; PROM1; AC108134.2; ADAMTS17; PPARG; IGF2BP2; PIK3CB; A4GALT; BCL9L; GIHCG; SIX1; CALML5; NR4A1; TRIM62; DHRS2"},"children":["CLDN8; EAF2; EHF; KRT4; AMIGO2; SERHL2; WWC3; A..."]},{"name":"span","attribs":{"title":"AQP3; UGDH; FKBP5; SEC14L2; EAF2; HSD11B2; AC021148.3; PISD; ZNF652; ZNF689; ANKRD22; ARHGEF26; EHF; KRT4; AMIGO2; PARM1; ARHGEF37; THBS1; NRP1; WWC3; GREB1; TTC12; KDM4B; PTPRJ; ADD3; SYBU; NEDD4L; CSRNP1; GPRC5A; WWC1; CNTNAP2; IL1R1; TBC1D16; OSGIN1; SLC26A2; AL035661.1; AC068580.3; DIO2; SERHL; PER1; AKAP13; SLC22A23; CRYBG1; KRT15; CD9; TRGC1; CEACAM7; VSTM2L; HS3ST3B1; IQGAP2; SOX9; TNNI2; STON2; CABLES1; PRKAB2; PMEPA1; NDRG1; SRGAP3; TMEM164; BCL2; NFKBIA; CEACAM5; PPFIBP2; MCCC2; GRHL2; HEY2; LNX2; KLF13; TRIM9; BLNK; FAM214A; AC092053.4; CYP2B7P; AL135905.2; ESR1; VAMP1; ADGRV1; MTSS1; PREX1; AL606500.1; STEAP4; ENC1; KLF9; BMP7; GRM4; PCED1B; NXPE3; TPD52; EMP1; TBC1D8; EPN2; COLCA1; AC005920.1; ELL2; STARD13-AS; ADGRG1; STARD13; MYCBP2; AL162377.1; IFITM10; AL445309.1; CRYBG2; LRP2BP; YPEL3; FSBP; TTC21A; CACNB4; ZBTB7C; ANK3; MUC19; CCDC40; PID1; TBX3; SERPINB2; PAQR5; TRGC2; MTMR9; MYH11; CLEC3A; MYRFL; PRKCE; CRAT; NAMPT; TEX19; PXK; ZNF703; CHN1; CBX4; MUC5B; DENND2B; TRMT9B; AC004918.5; IKZF2; ARHGEF26-AS1; TESK2; CEACAM6; TOE1; ITGA5; RNF144B; LRIG1; RASSF3; KCTD15; SOCS3; BX842570.1; RBBP8NL; NYNRIN; IGSF9; BCL6; TRIM66; FAH; HERC3; AC022007.1; KCNB1; GARNL3; SCIN; GDPD3; AC008268.1; GLDC; LIPH; AC022400.8; PXDC1; CISH; CMAHP; APCDD1; DLG2; SLC2A1; OAZ3; PXYLP1; SRMS; LPAR3; BNIPL; LRATD2; RORC; CA13; FZD5; GGT6; NSRP1; SLC22A5; RN7SL674P; HEG1; SNHG30; SPRY4; MYO1F; RNF227; VAV3; DLGAP1-AS1; AC040162.1; ARHGAP8; SEPHS2; NR1H3; SPATA24; SLC29A3; CASD1; DNAJC18; GET4; BBS5; PCDH8; ATP7B; AC068580.4; MAP2; NRCAM; PLEKHH1; DTX4; CACNA1D; AL157392.3; MRFAP1; DHRS3; LBP; RFLNA; SLC44A5; PARTICL; AL158211.5; SORD2P; PRR15L; PRAG1; CORO1A; KCTD6; CD160; AP000844.2; AC027702.2; FERMT1; TRERF1; SYT8; DBI; KLF3-AS1; LRRC46; RAD51B; HSP90AA2P; VMP1; DOK7; PIM1; GRK5; RPH3AL; BAG3; SHANK2; ZMIZ1; PPP1R3D; PROSER3; ARID5A; HOXC4; OSR2; S100A8; SLC25A35; SMIM5; AL137782.1; EGLN3; TMEM63C; RAB30; SNORA37; SPRED2; GSDME; ITGAM; GSN-AS1; CXXC4; PDE11A; AC118344.4; ZNRF1; ULK1; CNOT4; SLC4A8; IQCN; GLI4; MRPL38; IQCH-AS1; IRX6; ARRB1; KRT81; ZNF385A; ID3; BDNF-AS; VCPKMT; NPRL3; RBM20; TCF7L2; SLC6A17; AC026979.4; KLRG2; ST6GAL1; AZGP1P1; PSMD6-AS2; LINC01176; HGD; WNT2B; NEDD4; ICOSLG; COLCA2; ZFX; AL353593.1; DRC3; CSF1; SYT15; LOXL3; MAST3; PSCA; NOL6; MMP25; ID1; SKAP1; INPP5J; GADD45B; ENPP1; BCYRN1; AIFM2; IFNLR1; CNOT2-DT; SPRR3; AL135905.1; FGD6; BTN2A3P; MFF-DT; RNU4-1; CTSO; GUCY1B1; KL; CCDC96; ANKRD61; ENTPD1-AS1; AP005131.6; MFSD2A; SAMD10; VAMP5; PLEKHA2; RPS10P3; GRHL3; PDPR; CARMIL1; MAGIX; AC020904.2; GRAMD1B; DRAIC; SLC20A1; HAP1; LMNTD2-AS1; NFATC2; DGAT2; RBM26-AS1; TRIM36; RABGEF1; TMEM62; LRRC26; TLK2P1; TDO2; SMIM14; ABCC3; RAVER1; TGFB1I1; FP565260.3; CHRM1; IZUMO4; HERC6; GRIK3; AC141586.1; DPF1; IGFBP3; AC234917.3; MYB; AMH; LINC00511; AP000350.6; ADAMTSL4; IL17RE; SLC52A3; UBXN10; AC232271.1; ARHGEF3; RAB11B-AS1; ZFP36L2; LIF; LINC00265; NFKBIZ; NKX2-1; C15orf48; SERTAD1; AC092171.5; CFAP45; CATSPERB; HCAR1; HES1; DNASE1L2; HUS1; MGAT2; AC007405.4; EML6; BACE1-AS; PRDM4; RASD2; BX470102.2; ATP1A1; PTCH1; TMEM160; SPOCD1; HOXC6; PXMP4; FRMD4A; RAPGEF4; AC027097.2; KLF8; EFNA4; HMGCS2; RPS6KA2; HEBP1; SNHG22; LINC01522; TMEM191A; EVL; BCCIP; AC010184.1; BCAR3; LINC01089; MIR3936HG; TMEM44; AC090772.5; NAV1; EPN3; TRIM45; AC106782.1; PAM16; SAMD15; TMEM254-AS1; PHKA1; GPR162; IQCD; SIDT1; AL928654.1; RPL29P11; ADPRM; NRM; BAHCC1; AC013394.1; AC090517.5; HOOK1; ZNF117; FOXA3; AC018809.2; LRRC15; AC020978.9; TSKU; EFNA3; CDKN2B-AS1; FCGRT; KSR1; AC141930.1; STBD1; AC092910.3; KALRN; AC121338.2; IRF5; AC092117.2; FO681492.1; RGS16; CSTA; ZSCAN12; SHROOM2; RNF215; GCNA; ZFPL1; MS4A7; CSRNP2; ASB16-AS1; FKRP; AC005041.1; SPRYD7; KDM6B; RILP; OPLAH; RAP1GAP; FOXN3; FMO5; SRRM2; GPR157; AL158163.1; CRELD1; NCOR2; SELENON; GXYLT2; NNAT; DICER1-AS1; C15orf62; EEFSEC; UBAP1L; MAN1C1; DNMT3B; FAM47E; ABTB1; MIR34AHG; DNMBP; MLKL; AC008895.1; CCN1; THAP7-AS1; AL157838.1; AL139385.1; ANG; ATG101; MTMR11; MLLT11; ZCCHC17; FEM1A; CCDC157; HTR7P1; AC133555.3; SUFU; SLC24A3; ANP32B; SEPTIN1; CCDC124; CLIC6; MPP7; EML5; HDAC10; AC084082.1; RASGEF1A; PALM2AKAP2; AC097376.3; PRELID2; SDHAF2; SLC27A5; LASP1; RFLNB; SCAMP5; MAPK15; AC006449.7; GSEC; WDR60; ZNF688; ID2; FTX; PRR12; TRIM17; FLNB-AS1; FAM81A; PLAAT4; B3GNTL1; AC104109.2; PITX1; CYP4Z2P; C3orf18; NFIX; C22orf46; RTN4RL1; AL049834.1; PLEKHG5; AC009126.1; EEPD1; RHOB; PSG4; BICRA; KCNMA1; ACOX2; FBXL16; POM121C; BAALC-AS1; VPS37D; KIF12; CRYBB2P1; TMC8; DHCR24; HDAC9; AL158212.3; ALPK3; LIN7B; TMED2-DT; CLN3; OLMALINC; GPKOW; AC097523.1; SNORD3C; SYNE3; ZNF764; SNHG19; RFX2; LRRC49; THBD; NHEJ1; AC087289.5"},"children":["AQP3; UGDH; FKBP5; SEC14L2; EAF2; HSD11B2; AC02..."]},{"name":"span","attribs":{"title":"UGDH; FKBP5; STEAP2; RANBP3L; HSD11B2; AC021148.3; PISD; ZNF652; OTULINL; ARHGEF26; EHF; AMIGO2; PARM1; ARHGEF37; GLUL; THBS1; NRP1; EPGN; WWC3; CROT; GREB1; AL033523.1; KDM4B; PTPRJ; ADD3; SYBU; AR; MYLIP; ARHGEF28; NEDD4L; GPRC5A; FAM49A; WWC1; SASH1; PRR15; CNTNAP2; IL1R1; TBC1D16; SCUBE2; SLC26A2; AL035661.1; FRK; DIO2; SOWAHC; SERHL; DOCK2; SLC22A23; TBC1D2; CRYBG1; KRT15; LEF1; GRIN2B; BAMBI; TMTC2; DAB2; CD9; PDE10A; PLCL1; SPRED1; PPP3CA; TRGC1; CEACAM7; MCC; VSTM2L; IQGAP2; SOX9; STON2; CABLES1; JUN; SOSTDC1; PRKAB2; NADK2; PMEPA1; MPDZ; NDRG1; SRGAP3; SLC37A2; TMEM164; IL20RA; BCL2; CEACAM5; RRP7A; PPFIBP2; SLC16A6; MCCC2; GRHL2; AC007255.1; HEY2; TRIM9; TRIM2; FHDC1; BLNK; TGFB3; CYP2B7P; FAM167A; FGFR2; ESR1; TMCC3; SERPINI1; ASB13; SSTR2; PARP9; SLC25A18; AL645768.1; ADGRV1; MTSS1; ADH1C; PREX1; ATP13A4; PLEKHH2; POU2F3; STEAP4; MKLN1-AS; GSTM3; KLF9; PGR; PEA15; GRM4; PCED1B; RNF152; NXPE3; TPD52; INSYN2A; SGK3; EMP1; TBC1D8; EPN2; BCL2L1; CDRT1; AC005920.1; SORD; ELL2; STARD13-AS; STARD13; MYCBP2; KLF5; OXGR1; AL445309.1; FAM107B; GNA12; HMGN5; LFNG; AC005912.1; LRP2BP; FRMD3; FSBP; WWTR1; CACNB4; DOCK4; ZBTB7C; ANK3; F2R; MUC19; AL157895.2; RARRES1; TP53TG1; CCDC40; CNNM1; ALCAM; TBX3; PAQR5; LRCH1; SEMA6D; TRGC2; GUCY1A2; MYH11; CLEC3A; MYRFL; ID2-AS1; SNX25; VWFP1; PRKCE; NUAK1; PDE9A; CRAT; GPAT3; SLC16A14; NR3C2; SOX5; PACSIN2; GPSM2; AK4; SPSB1; PXK; LINC02303; CHN1; GCOM1; FBXO32; TNFAIP8; SLC9A1; KMO; GATA3; AC004918.5; BOC; FAM161A; GPR137C; IKZF2; IGFBP4; ARHGEF26-AS1; TESK2; CEACAM6; SYT16; SLC6A9; Z83843.1; NPIPB3; ZNF552; SAP30L-AS1; TOE1; LINC01341; CPM; EPHB3; ITGA5; GCNT1; SGSM1; RNF144B; LRIG1; RASSF3; SOCS3; RBBP8NL; NYNRIN; DNM3; BCL6; UAP1; FAH; HERC3; AP000331.1; AC022007.1; KCNB1; GARNL3; SCIN; ACACA; AC008268.1; CREB3L1; RPL39P3; SLC38A2; GLDC; GIPR; DSCAM-AS1; ADCY2; RAB11FIP1P1; TIPARP; PGM5; LYPD6; LIPH; AC022400.8; PXDC1; SH3PXD2A; PHLDA1; STX18-AS1; CMAHP; DOCK8; AL441992.2; SPAG5-AS1; DLG2; SLC2A1; CD44; ADIRF-AS1; PDE4B; PXYLP1; TGFBR3; DLC1; LPAR3; LRATD2; AL158206.1; CENPS; SEMA3F-AS1; CA13; FZD5; GGT6; PIK3C2G; SAMD12-AS1; RGL1; AC105285.1; H4C8; SLC22A5; RN7SL674P; HEG1; GPR161; SPRY4; MYO1F; AC005083.1; VAV3; HMGCS1; CRYM; DLGAP1-AS1; NKD1; LINC01814; AC040162.1; ARHGAP8; TFPI2; ZNF232; SPATA24; FHL2; TTC32; C20orf144; SLC29A3; ARL10; CASD1; MNX1; DNAJC18; GET4; ATP7B; AL353622.1; MAP2; CICP14; NRCAM; PLEKHH1; DTX4; CACNA1D; AL157392.3; PLCH2; DHRS3; DDR2; RFLNA; SLC44A5; KCNK5; WNT9A; TAMM41; FSTL1; PRR15L; PRAG1; GLCCI1; SMKR1; TCP11L2; CD160; AP000844.2; HECW2; TRERF1; KRT23; DBI; KLF3-AS1; LRRC46; RAD51B; KIAA0825; VMP1; ARHGAP40; AC005562.1; AL390726.5; PDIA5; PCDH10; ACACB; PIM1; LEKR1; CGNL1; STOX1; MAGI2; SRCIN1; MOK; BAG3; SHANK2; ZMIZ1; LINC01881; THSD1; OSR2; TSC22D3; TES; PRKAA2; SMIM5; AL137782.1; EGLN3; CMTM8; TMEM63C; VIPR1; RAB30; LIMD2; SNORA37; SPRED2; HSPG2; FOXO6; SPCS2P4; C14orf132; SYTL2; LMO4; MEGF11; GSN-AS1; ADAM19; RNF150; PDE11A; LYRM9; SMAD6; CHPT1; NRAD1; SCYL3; ZNRF1; AC083843.3; ULK1; RAD17P1; HNRNPCP2; DEPTOR; NRARP; IRX6; ARRB1; ZNF385A; VIPR1-AS1; ID3; PHLDB1; ANXA3; BDNF-AS; SUSD2; DUSP16; VCPKMT; SLC35F1; AL357568.1; ZBTB10; RBM20; TJP2; EXOC3-AS1; TCF7L2; SLC6A17; ZNF837; AC026979.4; KLRG2; ST6GAL1; AC138028.4; AL133230.2; AKAP7; SOX11; AZGP1P1; PSMD6-AS2; STARD5; AC113404.3; LINC01176; HGD; ZMYND10; WNT2B; NEDD4; ICOSLG; COLCA2; PGAM4; RHBDL3; ERVMER34-1; CSF1; FAM83B; BDKRB2; CBARP; CCDC82; FAM117A; MAST3; CD163L1; LRRC37A3; RNF43; AL133243.2; CEP112; AC007285.1; NCCRP1; REEP1; ID1; DTX2; SKAP1; COL5A2; INPP5J; AC116533.1; GADD45B; PIPSL; ENPP1; BCYRN1; AIFM2; PIFO; MNS1; PTAFR; FRAS1; IFNLR1; CNOT2-DT; PPARGC1B; MYRIP; CNKSR3; MAP1B; NT5E; FGD6; BTN2A3P; IFI6; MFF-DT; CTSO; GUCY1B1; KL; CCDC96; ANKRD61; AP000873.2; Z99129.4; ENTPD1-AS1; AP005131.6; NFASC; SAMD10; VAMP5; LIFR; PLCH1; PLEKHA2; SLC16A2; URB1-AS1; GRHL3; UNC5B; PDPR; CARMIL1; SLC27A6; SEMA3C; MAGIX; WNT5A; GRAMD1B; DRAIC; SLC20A1; ACSM1; NFATC2; MLLT3; AP001816.1; IRS2; ANKRD44; AL391001.1; RBM26-AS1; AC007996.1; PRUNE2; EPB41L2; NTN1; TMEM62; LRRC26; ARL15; TLK2P1; EPM2A; CCDC34; RPS7P1; TDO2; SMIM14; AC115223.1; ABCC3; GAB2; FP565260.3; TOR1AIP2; CHRM1; RFESD; SNTB1; CEACAM1; HERC6; FAM222B; GRIK3; LRRC75A; NSMCE3; GBP2; DPF1; AC007637.1; CEMIP2; APBA1; TMOD1; MYB; AC108519.1; RHOBTB1; MOCS1; AC093904.4; GNB1L; RRS1; G3BP2; CXCR6; LINC00511; AP000350.6; CLHC1; DBP; ADAMTSL4; IL17RE; TXNDC16; SLC52A3; UBXN10; PINK1-AS; AC009061.2; CYTH1; AC232271.1; ARHGEF3; RAB11B-AS1; MAGI3; TUBB3; ZNF501; ZFP36L2; STAT5A; LIF; FDX2; LINC00265; NFKBIZ; CBR3-AS1; PRR19; ZNF410; GADD45G; RMDN2; SUPT3H; CATSPERB; BBOX1; MEIS1; AC005831.1; HCAR1; OPN3; HUS1; TSFM; LURAP1L; TSPAN12; TSPAN5; AC007405.4; ADAMTS13; EML6; PRDM4; PLAAT1; TP53INP2; ATP1A1; ENTPD3-AS1; AADAT; KCNE4; SPOCD1; FANCE; BPIFA4P; PXMP4; FRMD4A; RAPGEF4; RNF166; TCF7; QDPR; SLC39A14; AC027097.2; EFNA4; VASN; SLC16A4; HMGCS2; PLEKHG4B; PLEKHG1; RPS6KA2; HEBP1; LINC01116; SP140L; SLC16A10; LINC01522; PPIAP29; LDHD; FAM221A; AHR; CCDC167; SPIN3; EVL; BCCIP; GPRIN3; ZNF596; AC010184.1; BCAR3; LINC01089; LIPE; AF111167.2; GALNT10; DNM1; BCL2L11; LINS1; MIR3936HG; ARMCX1; PCDHA12; TMEM44; MCOLN2; IL17RD; LINC02615; MMEL1; DAPK1; EPN3; GMDS-DT; GATA3-AS1; LAMTOR5-AS1; TRIM45; FAM89A; PAM16; PHKA1; SIAH2; IQCD; ARHGAP27P1-BPTFP1-KPNA2P3; FOXN3-AS1; CD302; BMF; SIDT1; AL928654.1; TMEM42; NRM; TFB1M; AC013394.1; SMIM3; AC090517.5; AC093642.2; AP4S1; HOOK1; ZNF117; AC018809.2; CACNA2D2; AC020978.9; RCBTB2; ZEB1-AS1; EFNA3; CDKN2B-AS1; AXIN2; AL451123.1; KSR1; AC141930.1; STBD1; GRB7; CLIP2; AC092910.3; STAMBPL1; KALRN; PTOV1-AS2; PPARD; AC138028.2; AL390719.1; FAM66C; GLIS2; TUT7; CSTA; RPS2P55; C9orf106; LINC02809; SLC5A9; LYSMD4; AL451165.2; TBC1D30; ZSCAN12; MB21D2; LCMT1-AS2; SHROOM2; USP49; MPC2; MS4A7; ASB16-AS1; BHLHE41; FKRP; STXBP6; BRD7P2; CCDC7; SMCO4; WDFY3-AS2; ZBED3; RILP; LINC-PINT; CCDC134; RSKR; CMPK2; RGS2; AL121906.2; RAP1GAP; FOXN3; NFIL3; POLR2J4; NCK1-DT; PCDHAC1; MAP2K6; FMO5; SRRM2; OAS1; GPR157; AL158163.1; AC093752.1; TATDN2P2; CDC42EP1; CRELD1; NCOR2; PIK3IP1; SELENON; AC104667.2; LRRTM2; FAM151B; GAR1; USP35; AC104825.1; DICER1-AS1; AC074117.1; AL591848.4; TAF13; ATP6V1B2; CASC2; C15orf62; EEFSEC; HLF; ATP6V1B1; MAN1C1; PARD3B; DNMT3B; ANKRD62P1; PPM1M; FAM47E; ABTB1; ATP13A5; MIR34AHG; FAM189A2; DNMBP; H3P47; AMIGO1; FAM124A; SEMA7A; AC008895.1; CCN1; THAP7-AS1; AL157838.1; ANKRD34A; AL139385.1; ZNF814; YPEL1; MTMR11; ZCCHC17; HTR7P1; ZNF431; AC135050.6; AC133555.3; SUFU; SLC24A3; SH3RF2; SPC25; AL157935.2; ANP32B; AC080013.1; MAP1S; CLIC6; COL27A1; MPP7; EML5; NRSN2-AS1; BMP1; EOGT; AC084082.1; C15orf41; RASGEF1A; PALM2AKAP2; APTR; SMPDL3A; AC087521.2; AC097376.3; PRELID2; AL009174.1; SLC27A5; SLC35C1; LASP1; SCAMP5; ATXN1; GSEC; LINC00624; WDR60; ACTN2; FTX; FLNB-AS1; FAM81A; PLAAT4; FGFR1OP; AC104109.2; PITX1; CYP4Z2P; TNS1; RTN4RL1; AL049834.1; PLEKHG5; SLC25A32; C3orf62; DAPK2; AC009126.1; NSMCE1-DT; KRT8P45; CHST15; NMB; CLSTN2; AC008966.1; PGD; BICRA; KCNMA1; SRP9P1; FBXL16; CRY2; ATL1; MPND; DMTN; HOXB7; CCDC71L; VPS37D; CRYBB2P1; ZNF594; DHCR24; CAMKMT; HDAC9; AL158212.3; XG; ALPK3; PLD6; TRIM68; AK1; CLN3; DIPK1B; OLMALINC; GPKOW; RABEP1; KCNQ1OT1; KDM4A-AS1; ZSWIM3; PRSS53; GLCE; RFX2; ZNF438; LRRC49; HOMER2; IRAK2; APIP; CPS1; GPRASP1; KIAA1211L; AC104447.1; OCEL1; LARGE1; PDLIM1; SRCAP; JOSD2; ABLIM3; ETHE1; KLHL8; POLE4; UBALD2; MFSD13A; PLA2R1; MAPT; CFAP157; UBASH3B; CPQ; ASAP1; CENPQ; METAP1D; AP001107.1; RAD51-AS1; CSGALNACT1; AC139887.2; ELK3; RPS17; CAP2; C1QTNF6; TMEM143; TMEM8B; NOL4L; AC010536.1; KCNS3; HINT2; KLF3; CYSRT1; SUSD3; ACSS1; ENOX1; CNFN; GTF2IP13; PPP1R37; RIPOR3; TSC22D1; TMEM178B; LINC01521; METTL15P1; MR1; ELAVL2; CAMKK1; KCNJ13; GGACT; TIMP2; AC092279.2; KLC3; IGSF8; AC091982.3; CPAMD8; ZFPM1; HS6ST1; ZNF782; DLEU1; CAPZB; DAB2IP; NATD1; ERMAP; ROBO1; LRRC27; TTC13; CUEDC1; MLXIP; OTUD7A; MAOB; PLAAT3; RBIS; DOCK3; USP3-AS1; MBTPS1; TUBD1; DGLUCY; MED21; AL391684.1; UCKL1-AS1; SERPINB5; UNC5C; HNF4G; ARID5B; BCAS3; ARMCX5-GPRASP2; SMOC1; AL031666.1; FBXO27; CEP126; LZTS3; TTYH2; AC005632.6; MATN3; WNT3; AL355488.1; SCUBE3; BOLA2-SMG1P6; ULBP2; ALKBH7; NDST2; MGAM; MTCL1; FAM161B; SIN3B; MAP3K5; ARHGAP44; TEX9; ACYP2; AC018521.5; CAMP; PROM1; SERGEF; STRADB; AC011476.3; ADAMTS17; ANGPTL4; AC018797.3; CRISPLD2; AUH; IGF2BP2; PIK3CB; DNAH11; RGS9BP; RTN4IP1; DBNDD2; ABCC12; A4GALT; AC004943.2; NOSTRIN; BCL9L; MAFF; EPS8; CTU2; NOD2; GIHCG; PPP3CB-AS1; SIX1; SESTD1; NR4A1; TRIM62; AP003498.1; DHRS2; EFNA5; NEK5; FUT4; PAX9; GRTP1; TMEM186; AC015712.2; ASH1L-AS1; ZNF428; MYC; ZC3H12A; FBXL3; SPAG6; AC073857.1; GSDMB; CTSS; YBX1P1; RERG; JMJD7-PLA2G4B; RAB19; NDFIP2; MRC2; NHSL1; TPO; ANAPC11; EML3; CTNND2; CST6; CRTC3; KIF13B; MED4; KCNC3; ZBED3-AS1; TOB1-AS1; EIF4A3; KIAA1522; CDON; TLE1; DHRS4; KTN1-AS1; AC008014.1; CCDC74A; NCALD; WDR66; TTLL1; IQCG; SH3TC1; AC139149.1; KIAA1671; AL121839.2; AL731571.1; TMC5; MAML2; LRRC8C; PYDC1; HS6ST1P1; H2BC10; DACH1; ARSJ; H3P36; DCST1-AS1; TPRN; AL445363.3; STX18; ZSCAN21"},"children":["UGDH; FKBP5; STEAP2; RANBP3L; HSD11B2; AC021148..."]},{"name":"span","attribs":{"title":"AQP3; FKBP5; ZNF689; ANKRD22; OLR1; EHF; AMIGO2; ARHGEF37; SERHL2; GLUL; WWC3; CROT; AR; CSRNP1; GPRC5A; SASH1; IL1R1; TBC1D16; AL035661.1; AC068580.3; PER1; DOCK2; AKAP13; ASRGL1; KRT15; LEF1; TENT5C; TRGC1; IQGAP2; TNNI2; FOXI1; NFKBIA; RRP7A; MCCC2; GRHL2; PLEKHD1; BIRC3; KLF13; TRIM2; BMP4; BLNK; PARP14; AC092053.4; CYP2B7P; ECI2; TMCC3; ASB13; PARP9; PREX1; ATP13A4; ENC1; GSTM3; PGR; BMP7; GRM4; PCED1B; RNF152; NXPE3; TPD52; EMP1; BCL2L1; COLCA1; RAB6C; AC005920.1; SORD; ELL2; AL162377.1; KLF5; IFITM10; LFNG; TTC21A; ZBTB7C; ANK3; MUC19; TMEM17; TP53TG1; SERPINB2; TRGC2; CLEC3A; ATP10A; GNMT; VWFP1; PRKCE; HECTD3; NAMPT; TEX19; SPSB1; ZNF703; LINC02303; CHN1; CBX4; MUC5B; FBXO32; TRMT9B; GATA3; IKZF2; IGFBP4; ARHGEF26-AS1; TESK2; TOE1; EPHB3; KCTD15; SOCS3; ARSK; NYNRIN; IGSF9; BCL6; AC008268.1; CREB3L1; SLC38A2; GLDC; GIPR; LIPH; PHLDA1; AL603750.1; DLG2; SLC2A1; CD44; LPAR3; TAPT1; AC024896.1; SAMD12-AS1; RGL1; H4C8; AC005083.1; VAV3; CRYM; ARHGAP8; SEPHS2; FHL2; C20orf144; CASD1; ATP7B; AC068580.4; CACNA1D; MRFAP1; PLCH2; DHRS3; SYDE1; SLC44A5; PARTICL; AL158211.5; QSOX2; TSPAN33; PRAG1; HECW2; TRERF1; SYT8; KRT23; KLF3-AS1; VMP1; ARHGAP40; SGPP1; BAG3; S100A8; VIPR1; SPRED2; FOXO6; C14orf132; SYTL2; GSN-AS1; SMAD6; AC083843.3; ULK1; RAD17P1; CNOT4; IQCN; GLI4; NUDT11; VIPR1-AS1; SUSD2; ZBTB10; RBM20; SLC6A17; AC026979.4; KLRG2; AL133230.2; SOX11; AZGP1P1; LINC01176; HGD; NEDD4; C7orf31; COLCA2; CSF1; BDKRB2; LRRC37A3; POP1; NOL6; ID1; DTX2; SKAP1; MGAT5B; GADD45B; LINC00641; IFNLR1; IFI6; POTEKP; KL; AC132192.2; FRAT1; AL135999.1; MFSD2A; VAMP5; CARMIL1; THTPA; AC020904.2; SILC1; RHPN1-AS1; SLC20A1; AC007191.1; MLLT3; FZD7; PAK6; SETP14; IZUMO4; RFESD; HERC6; GRIK3; ZNF714; CEMIP2; AC234917.3; MYB; SESN3; RRS1; AP000350.6; CLHC1; DBP; SLC52A3; UBXN10; TNNI1; RPL23AP2; ALPK1; ELF3-AS1; LIF; LINC00265; NFKBIZ; HSPBAP1; C15orf48; CFAP45; SPRY1; HES1; UROD; TSFM; TSPAN5; EDN2; MCOLN3; PRDM4; RASD2; BX470102.2; MIR1915HG; AADAT; SPOCD1; FANCE; PXMP4; NKILA; PTCHD1; HMGCS2; AHR; EVL; GPRIN3; MRPL12; AF111167.2; RNU4-2; PCDHA12; LINC02615; MMEL1; DAPK1; GATA3-AS1; SERPINE1; RPSAP47; AREG; TMEM254-AS1; BMF; FAM89B; SALL2; BAHCC1; TAPT1-AS1; HOOK1; FOXA3; LRRC15; AC007114.1; TSKU; MSX1; KSR1; GRB7; CLIP2; AC092910.3; STC1; PPARD; STC2; MTHFS; AL359715.1; TUT7; TMEM216; CSTA; AP000350.7; C9orf106; AL451165.2; KCNK1; BHLHE41; FKRP; AL121906.2; DDT; MAP2K6; GPR157; AL158163.1; CDC42EP1; NCOR2; C15orf62; TNFRSF11A; PARD3B; ANKRD62P1; DNMBP; SEMA7A; CCN1; AL157838.1; ANG; SLC25A53; ZCCHC4; ATG101; ZCCHC17; FEM1A; SUFU; MAP1S; DTX1; EPHA2; MAD2L1BP; SEMA4G; ITGAV; PALM2AKAP2; PRELID2; SDHAF2; LASP1; FAM53A; WDR60; ZNF688; FAM81A; PITX1; Z99572.1; POU2F1; CHST15; RHOB; BICRA; HOXB7; AP1AR; FKBP9P1; ZNF594; XG; LIN7B; CLN3; AC097523.1; RABEP1; SYNE3; AC005332.3; ZNF764; GLCE; LRRC49; THBD; KIAA1211L; SRCAP; ABLIM3; ETHE1; KLHL8; AC139530.1; ZNF319; POLE4; SRRM3; EMSLR; AL691482.4; ASAP1; CENPQ; RNF125; ELK3; TMEM143; ZDHHC18; ZBTB9; KLF3; SUSD3; ACSS1; RIPOR3; TSC22D1; LINC01504; MR1; RFX1; TIMP2; HS6ST1; DAB2IP; AC009078.3; CSPG4P12; SIX5; AC131971.1; CUEDC1; MLXIP; CHST3; FOXD1; UQCRHL; TUBD1; MED21; RAC2; ARID5B; PARP8; CEP126; WNT3; B3GLCT; MYPOP; LINC02482; RPS26P6; AC018521.5; PROM1; AC108134.2; LGALS1; ADAMTS17; ZNF114; RGS9BP; RTN4IP1; ABCC12; A4GALT; BCL9L; MAFF; GIHCG; SIX1; CALML5; SESTD1; TRIM62; AP003498.1; DHRS2; ANKRD18B; MYC; ZC3H12A; RAB19; NHSL1; FZD2; AL360270.1; KCNG1; KIF13B; AL009179.1; FBXO4; ZNF786; TOB1-AS1; EIF4A3; KIAA1522; TNFRSF14; SLC15A1; AC005914.1; CCDC74A; NCALD; FCRLB; SH3TC1; HS6ST1P1; H2BC10; ZSCAN21; PSD4; EIF2AK4; NCEH1; HSPA12A; SCARA3; MINCR; AL390719.2; BTN2A2; ZNF19; AC007114.2; FAM241A; CACNA1H; SECTM1; MRM1; ITPRIPL2; C9orf152; LSM10; DLGAP3; ABTB2; NKAIN1; VAV1; CCNB3; RPL14P1"},"children":["AQP3; FKBP5; ZNF689; ANKRD22; OLR1; EHF; AMIGO2..."]},{"name":"span","attribs":{"title":"SEC14L2; ZNF689; TTC12; SYBU; CSRNP1; AC092053.4; TTC21A; MTMR9; CRAT; PEX10; CHPT1"},"children":["SEC14L2; ZNF689; TTC12; SYBU; CSRNP1; AC092053...."]},{"name":"span","attribs":{"title":"FKBP5; HSD11B2; PTPRJ; MCCC2; ECI2; MYCBP2"},"children":["FKBP5; HSD11B2; PTPRJ; MCCC2; ECI2; MYCBP2"]},{"name":"span","attribs":{"title":"AQP3; EHF; SYBU; WWC1; CD9; NFKBIA; NAMPT; PRAG1; VIPR1; VIPR1-AS1; DUSP16; NOL6"},"children":["AQP3; EHF; SYBU; WWC1; CD9; NFKBIA; NAMPT; PRAG..."]},{"name":"span","attribs":{"title":"UGDH; AC021148.3; AKAP13; RAB6C; SMIM14"},"children":["UGDH; AC021148.3; AKAP13; RAB6C; SMIM14"]},{"name":"span","attribs":{"title":"EHF; GPCPD1; TMEM164; TMEM17; SCIN; ZFX; MAFB; KCNE4; SPRYD7; ATG101; ITGAV"},"children":["EHF; GPCPD1; TMEM164; TMEM17; SCIN; ZFX; MAFB; ..."]}],"minWidth":150}],"filterable":true,"dataKey":"f45bcad96484e1c4ec70cc7cc4d21cde"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<pre class="r"><code>plot_grid(plotlist = p, nrow = ceiling(length(p) / 3))</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/barcode-gsea-reg-nondir-sig-1.png" alt="*Barcode plots for the top 9 sets of windows associated with __non-directional__ changes in gene expression.*" width="960" />
<p class="caption">
<em>Barcode plots for the top 9 sets of windows associated with
<strong>non-directional</strong> changes in gene expression.</em>
</p>
</div>
</div>
<div id="windows-by-feature-1" class="section level4">
<h4>Windows By Feature</h4>
<pre class="r"><code>gsea_feat_nondir &lt;- fgsea(feat_dir_gs, rna_sig_ranks, scoreType = &quot;pos&quot;)
gsea_feat_nondir_sig &lt;- gsea_feat_nondir %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(padj &lt; enrich_alpha, size &gt;= min_sig) %&gt;% 
  as_tibble() 
p &lt;- gsea_feat_nondir_sig %&gt;% 
  dplyr::slice(1:9) %&gt;% 
  pull(&quot;pathway&quot;) %&gt;% 
  lapply(
    function(x) {
      plotEnrichment(feat_dir_gs[[x]], rna_sig_ranks) +
        ggtitle(x) +
        theme(
          plot.title = element_text(hjust = 0.5, size = 10)
        )
    }
  )</code></pre>
<pre class="r"><code>cp &lt;-  htmltools::em(
  glue(
    &quot;Merged windows were mapped to genes and their position amongst the &quot;,
    &quot;RNA-Seq results was assessed. Windows were classified based on which &quot;,
    &quot;feature was the best overlap, and the direction of {target} binding with &quot;,
    &quot;{treat_levels[[2]]} treatment. {nrow(gsea_feat_nondir_sig)} sets of windows were &quot;,
    &quot;associated with overall changes in gene expression, using only the &quot;, 
    &quot;test statistic to rank the &quot;, 
    &quot;{comma(nrow(rnaseq), 1)} genes considered as detected.&quot;
  )
)
tbl &lt;- gsea_feat_nondir_sig %&gt;%
  mutate(
    `Edge Size` = vapply(leadingEdge, length, integer(1)),
    leadingEdge = lapply(leadingEdge, function(x) id2gene[x]) %&gt;% 
      vapply(paste, character(1), collapse = &quot;; &quot;),
    Direction = ifelse(NES &gt; 0, &quot;\u21E7 Up-regulated&quot;, &quot;\u21E9 Down-regulated&quot;),
    &quot;{target}&quot; := str_extract(pathway, &quot;(Up|Down|Unchanged)$&quot;),
    pathway = str_remove_all(pathway, &quot; / [^/]+$&quot;)
  ) %&gt;% 
  dplyr::select(
    pathway, !!sym(target), Windows = size, Direction, 
    p = pval, FDR = padj, `Edge Size`, `Leading Edge` = leadingEdge
  ) %&gt;% 
  reactable(
    filterable = TRUE,
    columns = list2(
      pathway = colDef(
        minWidth = 100, name = &quot;Region&quot;
      ),
      &quot;{target}&quot; := colDef(
        maxWidth = 90,
        cell = function(value) {
          html_symbol &lt;- &quot;&quot;
          if (str_detect(value, &quot;Up&quot;)) html_symbol &lt;- &quot;\u21E7&quot;
          if (str_detect(value, &quot;Down&quot;)) html_symbol &lt;- &quot;\u21E9&quot;
          paste(html_symbol, value)
        },
        style = function(value) {
          colour &lt;- case_when(
            str_detect(value, &quot;Up&quot;) ~ colours$direction[[&quot;up&quot;]],
            str_detect(value, &quot;Down&quot;) ~ colours$direction[[&quot;down&quot;]],
            TRUE ~ colours$direction[[&quot;unchanged&quot;]]
          )
          list(color = colour)
        }
      ),
      Windows = colDef(maxWidth = 80, format = colFormat(separators = TRUE)),
      Direction = colDef(
        name = &quot;Gene Direction&quot;,
        maxWidth = 120,
        style = function(value) {
          colour &lt;- ifelse(
            str_detect(value, &quot;Up&quot;), 
            colours$direction[[&quot;up&quot;]], 
            colours$direction[[&quot;down&quot;]]
          )
          list(color = colour)
        },
      ),
      p = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      FDR = colDef(
        cell = function(value) sprintf(&quot;%.2e&quot;, value), maxWidth = 80
      ),
      &quot;Edge Size&quot; = colDef(maxWidth = 80),
     &quot;Leading Edge&quot; = colDef(
       minWidth = 150,
       cell = function(value) with_tooltip(value, width = 50)
     ) 
    )
  )
div(class = &quot;table&quot;,
  div(class = &quot;table-header&quot;,
      div(class = &quot;caption&quot;, cp),
      tbl
  )
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Merged windows were mapped to genes and their position amongst the RNA-Seq results was assessed. Windows were classified based on which feature was the best overlap, and the direction of H3K27ac binding with E2DHT treatment. 2 sets of windows were associated with overall changes in gene expression, using only the test statistic to rank the 13,043 genes considered as detected.</em>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8d09bfc85c6ec96c07ab" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8d09bfc85c6ec96c07ab">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"pathway":["No Feature","Enhancer"],"H3K27ac":["Up","Up"],"Windows":[112,225],"Direction":["⇧ Up-regulated","⇧ Up-regulated"],"p":[2.8616491298722473e-09,1.3109844444630511e-08],"FDR":[1.1446596519488989e-08,2.6219688889261023e-08],"Edge Size":[35,47],"Leading Edge":["AQP3; FKBP5; SEC14L2; RANBP3L; ZNF689; EHF; ARHGEF37; NRP1; SYBU; NEDD4L; GPCPD1; WWC1; DIO2; AKAP13; CRYBG1; TMEM164; NFKBIA; MCCC2; FGFR2; LMO3; SGK3; RAB6C; SORD; MYCBP2; TMEM17; CCDC40; MTMR9; CRAT; RASSF3; ACACA; DSCAM-AS1; PEX10; PRAG1; RAD51B; MAGI2","AQP3; UGDH; FKBP5; HSD11B2; AC021148.3; ZNF652; EHF; ARHGEF37; AL033523.1; TTC12; KDM4B; PTPRJ; CSRNP1; SASH1; CD9; SPRED1; VSTM2L; IQGAP2; PRKAB2; MCCC2; AC092053.4; ECI2; GSTM3; PEA15; TTC21A; TMEM17; CNNM1; NAMPT; SCIN; ACACA; GIPR; PXDC1; STX18-AS1; DLG2; KIAA0825; PRKAA2; VIPR1; CHPT1; VIPR1-AS1; DUSP16; ZFX; NOL6; CCDC96; AC007191.1; MAFB; SMIM14; TOR1AIP2"]},"columns":[{"id":"pathway","name":"Region","type":"character","minWidth":100},{"id":"H3K27ac","name":"H3K27ac","type":"character","cell":["⇧ Up","⇧ Up"],"maxWidth":90,"style":[{"color":"#CA0020"},{"color":"#CA0020"}]},{"id":"Windows","name":"Windows","type":"numeric","format":{"cell":{"separators":true},"aggregated":{"separators":true}},"maxWidth":80},{"id":"Direction","name":"Gene Direction","type":"character","maxWidth":120,"style":[{"color":"#CA0020"},{"color":"#CA0020"}]},{"id":"p","name":"p","type":"numeric","cell":["2.86e-09","1.31e-08"],"maxWidth":80},{"id":"FDR","name":"FDR","type":"numeric","cell":["1.14e-08","2.62e-08"],"maxWidth":80},{"id":"Edge Size","name":"Edge Size","type":"numeric","maxWidth":80},{"id":"Leading Edge","name":"Leading Edge","type":"character","cell":[{"name":"span","attribs":{"title":"AQP3; FKBP5; SEC14L2; RANBP3L; ZNF689; EHF; ARHGEF37; NRP1; SYBU; NEDD4L; GPCPD1; WWC1; DIO2; AKAP13; CRYBG1; TMEM164; NFKBIA; MCCC2; FGFR2; LMO3; SGK3; RAB6C; SORD; MYCBP2; TMEM17; CCDC40; MTMR9; CRAT; RASSF3; ACACA; DSCAM-AS1; PEX10; PRAG1; RAD51B; MAGI2"},"children":["AQP3; FKBP5; SEC14L2; RANBP3L; ZNF689; EHF; ARH..."]},{"name":"span","attribs":{"title":"AQP3; UGDH; FKBP5; HSD11B2; AC021148.3; ZNF652; EHF; ARHGEF37; AL033523.1; TTC12; KDM4B; PTPRJ; CSRNP1; SASH1; CD9; SPRED1; VSTM2L; IQGAP2; PRKAB2; MCCC2; AC092053.4; ECI2; GSTM3; PEA15; TTC21A; TMEM17; CNNM1; NAMPT; SCIN; ACACA; GIPR; PXDC1; STX18-AS1; DLG2; KIAA0825; PRKAA2; VIPR1; CHPT1; VIPR1-AS1; DUSP16; ZFX; NOL6; CCDC96; AC007191.1; MAFB; SMIM14; TOR1AIP2"},"children":["AQP3; UGDH; FKBP5; HSD11B2; AC021148.3; ZNF652;..."]}],"minWidth":150}],"filterable":true,"dataKey":"bec08f27fa80df0a8f52b53d9fd8a53b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<pre class="r"><code>plot_grid(plotlist = p, nrow = ceiling(length(p) / 3))</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/barcode-gsea-feat-nondir-sig-1.png" alt="*Barcode plots for the top 2 sets of windows associated with __nondirectional__ changes in gene expression.*" width="960" />
<p class="caption">
<em>Barcode plots for the top 2 sets of windows associated with
<strong>nondirectional</strong> changes in gene expression.</em>
</p>
</div>
<!-- Could be done regardless of changes in expression -->
</div>
</div>
</div>
<div id="integration-of-rna-and-chip-enrichment-analyses"
class="section level2">
<h2>Integration of RNA and ChIP Enrichment Analyses</h2>
<pre class="r"><code>rnaseq_gsea &lt;- fgsea(
  pathways = gs_by_gsid,
  stats = rna_dir_ranks, 
  minSize = min_gs_size, 
  maxSize = max_gs_size
) %&gt;% 
  dplyr::filter(!is.na(pval))
status_cols &lt;- setNames(
  hcl.colors(4, &quot;Viridis&quot;, rev = TRUE),
  c(&quot;Both&quot;, &quot;ChIP Only&quot;, &quot;RNA Only&quot;, &quot;Neither&quot;)
)</code></pre>
<p>The enrichment testing results from the H3K27ac differential binding
analysis were then compared to GSEA results obtained from the RNA-Seq
data set. Given the orthogonal nature of the two dataset, p-values from
each analysis were combined using Wilkinson’s maximum p-value method and
the resulting p-values adjusted as previously. Distances between nodes
(gene-sets) for all network plots were determined by using ChIP target
genes within the leading edge only.</p>
<div id="differentially-bound-windows" class="section level3 tabset">
<h3 class="tabset">Differentially Bound Windows</h3>
<pre class="r"><code>cmn_diff &lt;- rnaseq_gsea %&gt;%
  dplyr::select(-log2err, -ES, -size) %&gt;% 
  left_join(
    goseq_diff, by = c(&quot;pathway&quot; = &quot;gs_name&quot;), suffix = c(&quot;.rna&quot;, &quot;.chip&quot;)
  ) %&gt;%
  dplyr::filter(!is.na(pval.rna), !is.na(pval.chip)) %&gt;% 
  nest(p = starts_with(&quot;pval&quot;)) %&gt;% 
  mutate(
    pval = vapply(p, function(x) metap::maximump(unlist(x))$p, numeric(1))
  ) %&gt;%
  unnest(p) %&gt;% 
  dplyr::rename(padj_chip = adj_p, padj_rna = padj) %&gt;% 
  mutate(adj_p = p.adjust(pval, params$enrichment$adj)) %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(adj_p &lt; enrich_alpha) %&gt;% 
  mutate(
    leadingEdge = lapply(
      leadingEdge, intersect, dplyr::filter(mapped_ids, up | down)$gene_id
    ),
    numDEInCat = vapply(leadingEdge, length, integer(1)),
    Status = case_when(
      padj_rna &lt; enrich_alpha &amp; padj_chip &lt; enrich_alpha ~ &quot;Both&quot;,
      padj_rna &lt; enrich_alpha &amp; !padj_chip &lt; enrich_alpha ~ &quot;RNA Only&quot;,
      !padj_rna &lt; enrich_alpha &amp; padj_chip &lt; enrich_alpha ~ &quot;ChIP Only&quot;,
      !padj_rna &lt; enrich_alpha &amp; !padj_chip &lt; enrich_alpha ~ &quot;Neither&quot;
    ) %&gt;% 
      factor(levels = names(status_cols))
  ) %&gt;% 
  dplyr::filter(numDEInCat &gt;= min_sig) %&gt;% 
  dplyr::select(
    gs_name = pathway, adj_p, Status, NES, starts_with(&quot;padj&quot;),
    starts_with(&quot;num&quot;), leadingEdge
  ) 
tg_diff &lt;- cmn_diff %&gt;% 
  make_tbl_graph(setNames(.$leadingEdge, .$gs_name))
plot_net &lt;- length(tg_diff) &gt;= min_network_size
txt &lt;- ifelse(
  nrow(cmn_diff) == 0,
  glue(&quot;No gene sets were jointly enriched between all {target} differentially bound windows and the RNA-Seq data&quot;),
  &quot;#### Results Table&quot;
)</code></pre>
<div id="results-table-2" class="section level4">
<h4>Results Table</h4>
<pre class="r"><code>cp &lt;- htmltools::tags$em(
  glue(
    &quot;
    Genes mapped to all windows showing evidence of differential binding were 
    tested for enrichment using goseq, and results were compared to GSEA results
    for the RNA-Seq dataset. Wilkinson&#39;s method was used to integrate the two
    p-values with a combined FDR-adjusted p-value &lt; {enrich_alpha} being taken
    as evidence of potential regulatory targets from differentially bound 
    {target} binding sites. Of the {nrow(cmn_diff)} gene-sets of interest, 
    {sum(cmn_diff$Status == &#39;Both&#39;)} were individually enriched in both datasets,
    as indicated in the &#39;Status&#39; column
    &quot;
  )
)
tbl &lt;- cmn_diff %&gt;%
  mutate(
    leadingEdge = vapply(
      leadingEdge,
      function(x) paste(id2gene[x], collapse = &quot;; &quot;),
      character(1)
    )
  ) %&gt;% 
  reactable(
    filterable = TRUE, showPageSizeOptions = TRUE,
    columns = list(
      gs_name = colDef(
        name = &quot;Gene Set&quot;,
        cell = function(value) htmltools::tags$a(
          href = gs_url[[value]], 
          target = &quot;_blank&quot;, 
          str_replace_all(value, &quot;_&quot;, &quot; &quot;)
        ),
        minWidth = 120
      ),
      adj_p = colDef(
        name = glue(&quot;p&lt;sub&gt;{params$enrichment$adj}&lt;/sub&gt;&quot;), html = TRUE,
        cell = function(value) ifelse(
          value &lt; 0.001,
          sprintf(&quot;%.2e&quot;, value),
          sprintf(&quot;%.3f&quot;, value)
        ),
        maxWidth = 80
      ),
      Status = colDef(name = &quot;Prior Status&quot;, maxWidth = 100),
      NES = colDef(
        format = colFormat(digits = 2),
        style = function(value) {
          col &lt;- ifelse(value &gt; 0, colours$direction[&quot;up&quot;], colours$direction[&quot;down&quot;])
          list(color = col)
        },
        maxWidth = 80
      ),
      padj_rna = colDef(
        name =  glue(&quot;p&lt;sub&gt;{params$enrichment$adj}&lt;/sub&gt; (RNA)&quot;), html = TRUE,
        cell = function(value) ifelse(
          value &lt; 0.001,
          sprintf(&quot;%.2e&quot;, value),
          sprintf(&quot;%.3f&quot;, value)
        ),
        maxWidth = 80
      ),
      padj_chip = colDef(
        name =  glue(&quot;p&lt;sub&gt;{params$enrichment$adj}&lt;/sub&gt; (ChIP)&quot;), html = TRUE,
        cell = function(value) ifelse(
          value &lt; 0.001,
          sprintf(&quot;%.2e&quot;, value),
          sprintf(&quot;%.3f&quot;, value)
        ),
        maxWidth = 80
      ),
      numDEInCat = colDef(name = &quot;ChIP Targets in Leading Edge&quot;, maxWidth = 100),
      numInCat = colDef(name = &quot;Mapped Genes&quot;, maxWidth = 100),
      leadingEdge = colDef(
        name = &quot;Leading Edge ChIP Targets&quot;,
        cell = function(value) with_tooltip(value, width = 50),
        minWidth = 120
      )
    )
  )
div(
  class = &quot;table&quot;, 
  div(
    class = &quot;table-header&quot;,
    div(class = &quot;caption&quot;, cp)
  ),
  tbl
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Genes mapped to all windows showing evidence of differential binding were 
tested for enrichment using goseq, and results were compared to GSEA results
for the RNA-Seq dataset. Wilkinson's method was used to integrate the two
p-values with a combined FDR-adjusted p-value &lt; 0.05 being taken
as evidence of potential regulatory targets from differentially bound 
H3K27ac binding sites. Of the 18 gene-sets of interest, 
0 were individually enriched in both datasets,
as indicated in the 'Status' column</em>
</div>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-74ed54727b939d37d54f" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-74ed54727b939d37d54f">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"gs_name":["HES2_TARGET_GENES","HALLMARK_ANDROGEN_RESPONSE","HALLMARK_ESTROGEN_RESPONSE_EARLY","REACTOME_FATTY_ACID_METABOLISM","REACTOME_PEROXISOMAL_PROTEIN_IMPORT","ZBTB18_TARGET_GENES","HALLMARK_ESTROGEN_RESPONSE_LATE","REACTOME_PHASE_II_CONJUGATION_OF_COMPOUNDS","GREB1_TARGET_GENES","REACTOME_METABOLISM_OF_LIPIDS","KEGG_PEROXISOME","HALLMARK_MTORC1_SIGNALING","WP_STEROL_REGULATORY_ELEMENTBINDING_PROTEINS_SREBP_SIGNALING","BPTF_TARGET_GENES","WP_VEGFAVEGFR2_SIGNALING_PATHWAY","REACTOME_PROTEIN_LOCALIZATION","REACTOME_BIOLOGICAL_OXIDATIONS","ZNF510_TARGET_GENES"],"adj_p":[2.2222977461285487e-05,5.6291789218286691e-05,0.0030987108301090472,0.0077992140477392106,0.0077992140477392106,0.0077992140477392106,0.0083802562543930353,0.0083802562543930353,0.0095028391861888186,0.011537293503521846,0.019060289208749824,0.025390901647575615,0.029061386759932986,0.0306465415828194,0.0306465415828194,0.0306465415828194,0.032005861127395799,0.037286175533215067],"Status":["ChIP Only","Neither","ChIP Only","Neither","Neither","Neither","ChIP Only","Neither","Neither","Neither","Neither","Neither","Neither","Neither","Neither","Neither","Neither","Neither"],"NES":[1.3581071646536731,1.6406866779751446,1.4663464243649271,1.6013882506471595,1.528148642682146,1.3266386090964712,1.388448095783483,1.483572017371747,1.2719768449590245,1.3660360772957867,1.4370076987946829,1.4710453536310579,1.4096613255950525,1.2550130445969765,1.2669831674366263,1.5100769311126172,1.4675910376099002,1.4751600837208043],"padj_rna":[0.072520680951891361,0.0630045895037077,0.21513799193981131,0.072520680951891361,0.2167909272102537,0.2167909272102537,0.31295139090778956,0.31295139090778956,0.33279176884377748,0.1727392011451048,0.38621347998090516,0.1727392011451048,0.44402093231135159,0.47074993778919533,0.47341927562922043,0.18856731287137352,0.2906794720812188,0.34143503525914676],"padj_chip":[0.00017816290202312402,0.16636956904932759,0.00017816290202312402,0.47127052398422131,0.47127052398422131,0.47779718482122274,0.042513239604109916,0.38998496975255842,0.47779718482122274,0.62024968150921433,0.69756273087674725,0.76667135761635063,0.70081415156864824,0.41546651994032757,0.40738548022578203,0.8396321113256815,0.85485288144030414,0.85485288144030414],"numDEInCat":[13,3,9,5,3,7,5,3,12,10,3,4,3,6,5,3,5,3],"numInCat":[880,89,176,113,50,618,164,51,649,519,62,190,63,520,343,145,95,30],"leadingEdge":["AQP3; EHF; NRP1; SYBU; NEDD4L; DIO2; CRYBG1; IQGAP2; NFKBIA; MCCC2; SGK3; MTMR9; SMIM14","FKBP5; IQGAP2; SORD","AQP3; FKBP5; SEC14L2; KDM4B; SYBU; WWC1; TMEM164; CHPT1; DEPTOR","PRKAB2; ECI2; CRAT; ACACA; PRKAA2","ECI2; CRAT; PEX10","KDM4B; CRYBG1; CD9; IQGAP2; MCCC2; SGK3; TTC21A","UGDH; FKBP5; CD9; SORD; CHPT1","UGDH; GSTM3; ACSM1","SEC14L2; ZNF689; EHF; NRP1; KDM4B; SYBU; WWC1; NFKBIA; MCCC2; CCDC40; DSCAM-AS1; CHPT1","HSD11B2; GPCPD1; PRKAB2; ECI2; MTMR9; CRAT; ACACA; PRKAA2; CHPT1; MED21","ECI2; CRAT; PEX10","CD9; SORD; NAMPT; ACACA","PRKAB2; ACACA; PRKAA2","PRKAB2; TTC21A; SMIM14; CUEDC1; AL391684.1; ARID5B","PTPRJ; NFKBIA; ACACA; PRKAA2; ITGAV","ECI2; CRAT; PEX10","UGDH; GSTM3; ACSM1; SULT2B1; GSTM4","RANBP3L; NOL6; MED21"]},"columns":[{"id":"gs_name","name":"Gene Set","type":"character","cell":[{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["HES2 TARGET GENES"]},{"name":"a","attribs":{"href":null,"target":"_blank"},"children":["HALLMARK ANDROGEN RESPONSE"]},{"name":"a","attribs":{"href":null,"target":"_blank"},"children":["HALLMARK ESTROGEN RESPONSE EARLY"]},{"name":"a","attribs":{"href":"https://www.reactome.org/content/detail/R-HSA-8978868","target":"_blank"},"children":["REACTOME FATTY ACID METABOLISM"]},{"name":"a","attribs":{"href":"https://www.reactome.org/content/detail/R-HSA-9033241","target":"_blank"},"children":["REACTOME PEROXISOMAL PROTEIN IMPORT"]},{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["ZBTB18 TARGET GENES"]},{"name":"a","attribs":{"href":null,"target":"_blank"},"children":["HALLMARK ESTROGEN RESPONSE LATE"]},{"name":"a","attribs":{"href":"https://www.reactome.org/content/detail/R-HSA-156580","target":"_blank"},"children":["REACTOME PHASE II CONJUGATION OF COMPOUNDS"]},{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["GREB1 TARGET GENES"]},{"name":"a","attribs":{"href":"https://www.reactome.org/content/detail/R-HSA-556833","target":"_blank"},"children":["REACTOME METABOLISM OF LIPIDS"]},{"name":"a","attribs":{"href":"http://www.genome.jp/kegg/pathway/hsa/hsa04146.html","target":"_blank"},"children":["KEGG PEROXISOME"]},{"name":"a","attribs":{"href":null,"target":"_blank"},"children":["HALLMARK MTORC1 SIGNALING"]},{"name":"a","attribs":{"href":"http://www.wikipathways.org/instance/WP1982_r116442","target":"_blank"},"children":["WP STEROL REGULATORY ELEMENTBINDING PROTEINS SREBP SIGNALING"]},{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["BPTF TARGET GENES"]},{"name":"a","attribs":{"href":"http://www.wikipathways.org/instance/WP3888_r116782","target":"_blank"},"children":["WP VEGFAVEGFR2 SIGNALING PATHWAY"]},{"name":"a","attribs":{"href":"https://www.reactome.org/content/detail/R-HSA-9609507","target":"_blank"},"children":["REACTOME PROTEIN LOCALIZATION"]},{"name":"a","attribs":{"href":"https://www.reactome.org/content/detail/R-HSA-211859","target":"_blank"},"children":["REACTOME BIOLOGICAL OXIDATIONS"]},{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["ZNF510 TARGET GENES"]}],"minWidth":120},{"id":"adj_p","name":"p<sub>fdr<\/sub>","type":"numeric","cell":["2.22e-05","5.63e-05","0.003","0.008","0.008","0.008","0.008","0.008","0.010","0.012","0.019","0.025","0.029","0.031","0.031","0.031","0.032","0.037"],"html":true,"maxWidth":80},{"id":"Status","name":"Prior Status","type":"factor","maxWidth":100},{"id":"NES","name":"NES","type":"numeric","format":{"cell":{"digits":2},"aggregated":{"digits":2}},"maxWidth":80,"style":[{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"}]},{"id":"padj_rna","name":"p<sub>fdr<\/sub> (RNA)","type":"numeric","cell":["0.073","0.063","0.215","0.073","0.217","0.217","0.313","0.313","0.333","0.173","0.386","0.173","0.444","0.471","0.473","0.189","0.291","0.341"],"html":true,"maxWidth":80},{"id":"padj_chip","name":"p<sub>fdr<\/sub> (ChIP)","type":"numeric","cell":["1.78e-04","0.166","1.78e-04","0.471","0.471","0.478","0.043","0.390","0.478","0.620","0.698","0.767","0.701","0.415","0.407","0.840","0.855","0.855"],"html":true,"maxWidth":80},{"id":"numDEInCat","name":"ChIP Targets in Leading Edge","type":"numeric","maxWidth":100},{"id":"numInCat","name":"Mapped Genes","type":"numeric","maxWidth":100},{"id":"leadingEdge","name":"Leading Edge ChIP Targets","type":"character","cell":[{"name":"span","attribs":{"title":"AQP3; EHF; NRP1; SYBU; NEDD4L; DIO2; CRYBG1; IQGAP2; NFKBIA; MCCC2; SGK3; MTMR9; SMIM14"},"children":["AQP3; EHF; NRP1; SYBU; NEDD4L; DIO2; CRYBG1; IQ..."]},{"name":"span","attribs":{"title":"FKBP5; IQGAP2; SORD"},"children":["FKBP5; IQGAP2; SORD"]},{"name":"span","attribs":{"title":"AQP3; FKBP5; SEC14L2; KDM4B; SYBU; WWC1; TMEM164; CHPT1; DEPTOR"},"children":["AQP3; FKBP5; SEC14L2; KDM4B; SYBU; WWC1; TMEM16..."]},{"name":"span","attribs":{"title":"PRKAB2; ECI2; CRAT; ACACA; PRKAA2"},"children":["PRKAB2; ECI2; CRAT; ACACA; PRKAA2"]},{"name":"span","attribs":{"title":"ECI2; CRAT; PEX10"},"children":["ECI2; CRAT; PEX10"]},{"name":"span","attribs":{"title":"KDM4B; CRYBG1; CD9; IQGAP2; MCCC2; SGK3; TTC21A"},"children":["KDM4B; CRYBG1; CD9; IQGAP2; MCCC2; SGK3; TTC21A"]},{"name":"span","attribs":{"title":"UGDH; FKBP5; CD9; SORD; CHPT1"},"children":["UGDH; FKBP5; CD9; SORD; CHPT1"]},{"name":"span","attribs":{"title":"UGDH; GSTM3; ACSM1"},"children":["UGDH; GSTM3; ACSM1"]},{"name":"span","attribs":{"title":"SEC14L2; ZNF689; EHF; NRP1; KDM4B; SYBU; WWC1; NFKBIA; MCCC2; CCDC40; DSCAM-AS1; CHPT1"},"children":["SEC14L2; ZNF689; EHF; NRP1; KDM4B; SYBU; WWC1; ..."]},{"name":"span","attribs":{"title":"HSD11B2; GPCPD1; PRKAB2; ECI2; MTMR9; CRAT; ACACA; PRKAA2; CHPT1; MED21"},"children":["HSD11B2; GPCPD1; PRKAB2; ECI2; MTMR9; CRAT; ACA..."]},{"name":"span","attribs":{"title":"ECI2; CRAT; PEX10"},"children":["ECI2; CRAT; PEX10"]},{"name":"span","attribs":{"title":"CD9; SORD; NAMPT; ACACA"},"children":["CD9; SORD; NAMPT; ACACA"]},{"name":"span","attribs":{"title":"PRKAB2; ACACA; PRKAA2"},"children":["PRKAB2; ACACA; PRKAA2"]},{"name":"span","attribs":{"title":"PRKAB2; TTC21A; SMIM14; CUEDC1; AL391684.1; ARID5B"},"children":["PRKAB2; TTC21A; SMIM14; CUEDC1; AL391684.1; ARID5B"]},{"name":"span","attribs":{"title":"PTPRJ; NFKBIA; ACACA; PRKAA2; ITGAV"},"children":["PTPRJ; NFKBIA; ACACA; PRKAA2; ITGAV"]},{"name":"span","attribs":{"title":"ECI2; CRAT; PEX10"},"children":["ECI2; CRAT; PEX10"]},{"name":"span","attribs":{"title":"UGDH; GSTM3; ACSM1; SULT2B1; GSTM4"},"children":["UGDH; GSTM3; ACSM1; SULT2B1; GSTM4"]},{"name":"span","attribs":{"title":"RANBP3L; NOL6; MED21"},"children":["RANBP3L; NOL6; MED21"]}],"minWidth":120}],"filterable":true,"showPageSizeOptions":true,"dataKey":"3fe6455de2a0100821deae519f90ef9b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="network-plot" class="section level4">
<h4>Network Plot</h4>
<pre class="r"><code>tg_diff %&gt;% 
  activate(nodes) %&gt;% 
  mutate(direction = ifelse(NES &gt; 0, &quot;Up&quot;, &quot;Down&quot;))%&gt;% 
  ggraph(layout = net_layout, weights = oc^2) +
  geom_edge_link(aes(width = oc^2, alpha = oc^2)) +
  geom_node_point(
    aes(fill = Status, size = numDEInCat),
    shape = 21
  ) +
  geom_node_text(
    aes(label = label, colour = direction),
    size = 3, 
    data = . %&gt;%
      mutate(
        label = str_replace_all(label, &quot;_&quot;, &quot; &quot;) %&gt;% str_trunc(80) %&gt;% str_wrap(width = 18)
      ),
    repel = TRUE, max.overlaps = max(10, round(length(tg_diff) / 4, 0)),
    bg.color = &quot;white&quot;, bg.r = 0.1, 
  ) +
  scale_x_continuous(expand = expansion(c(0.1, 0.1))) +
  scale_y_continuous(expand = expansion(c(0.1, 0.1))) +
  scale_fill_manual(values = status_cols) +
  scale_size_continuous(range = c(1, 10)) +
  scale_edge_width(range = c(1, 6), limits = c(0, 1)) +
  scale_edge_alpha(range = c(0.1, 0.4), limits = c(0, 1))  +
  scale_colour_manual(
    values = setNames(direction_colours, str_to_title(names(direction_colours)))
  ) +
  guides(edge_alpha= &quot;none&quot;) +
  labs(
    size = glue(&quot;{target} Targets In Leading Edge&quot;) %&gt;% str_wrap(15),
    colour = &quot;GSEA\nDirection&quot;,
    fill = &quot;Prior\nSignificance&quot;,
    edge_width = expr(paste(OC^2))
  ) +
  theme_void() +
  theme(legend.text = element_text(hjust = 0.5))</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/network-cmn-alldiff-1.png" alt="*Network plot for pathways considered significant when assessing all differentially bound H3K27ac sites along with GSEA on the provided RNA-Seq data. Distances are derived from all detected genes within the pathway. Label colours indicate the direction of enrichment in GSEA results for genes in the pathway.*" width="960" />
<p class="caption">
<em>Network plot for pathways considered significant when assessing all
differentially bound H3K27ac sites along with GSEA on the provided
RNA-Seq data. Distances are derived from all detected genes within the
pathway. Label colours indicate the direction of enrichment in GSEA
results for genes in the pathway.</em>
</p>
</div>
</div>
</div>
<div id="windows-with-increased-h3k27ac" class="section level3 tabset">
<h3 class="tabset">Windows With Increased H3K27ac</h3>
<pre class="r"><code>cmn_up &lt;- rnaseq_gsea %&gt;%
  dplyr::select(-log2err, -ES, -size) %&gt;% 
  left_join(
    goseq_up, by = c(&quot;pathway&quot; = &quot;gs_name&quot;), suffix = c(&quot;.rna&quot;, &quot;.chip&quot;)
  ) %&gt;%
  dplyr::filter(!is.na(pval.rna), !is.na(pval.chip)) %&gt;% 
  nest(p = starts_with(&quot;pval&quot;)) %&gt;% 
  mutate(
    pval = vapply(p, function(x) metap::maximump(unlist(x))$p, numeric(1))
    ) %&gt;%
  unnest(p) %&gt;% 
  dplyr::rename(padj_chip = adj_p, padj_rna = padj) %&gt;% 
  mutate(adj_p = p.adjust(pval, params$enrichment$adj)) %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(adj_p &lt; enrich_alpha) %&gt;% 
  mutate(
    leadingEdge = lapply(
      leadingEdge, intersect, dplyr::filter(mapped_ids, up)$gene_id
    ),
    numDEInCat = vapply(leadingEdge, length, integer(1)),
    Status = case_when(
      padj_rna &lt; enrich_alpha &amp; padj_chip &lt; enrich_alpha ~ &quot;Both&quot;,
      padj_rna &lt; enrich_alpha &amp; !padj_chip &lt; enrich_alpha ~ &quot;RNA Only&quot;,
      !padj_rna &lt; enrich_alpha &amp; padj_chip &lt; enrich_alpha ~ &quot;ChIP Only&quot;,
      !padj_rna &lt; enrich_alpha &amp; !padj_chip &lt; enrich_alpha ~ &quot;Neither&quot;
    ) %&gt;% 
      factor(levels = names(status_cols))
  ) %&gt;% 
  dplyr::filter(numDEInCat &gt;= min_sig) %&gt;% 
  dplyr::select(
    gs_name = pathway, adj_p, Status, NES, starts_with(&quot;padj&quot;),
    starts_with(&quot;num&quot;), leadingEdge
  ) 
tg_up &lt;- cmn_up %&gt;% 
  make_tbl_graph(
    setNames(.$leadingEdge, .$gs_name)
  )
plot_net &lt;- length(tg_up) &gt;= min_network_size
txt &lt;- ifelse(
  nrow(cmn_up) == 0,
  glue(&quot;No gene sets were jointly enriched between all increasing {target} bound windows and the RNA-Seq data&quot;),
  &quot;#### Results Table&quot;
)</code></pre>
<div id="results-table-3" class="section level4">
<h4>Results Table</h4>
<pre class="r"><code>cp &lt;- htmltools::tags$em(
  glue(
    &quot;
    Genes mapped to all windows showing evidence of increased {target} binding were 
    tested for enrichment using goseq, and results were compared to GSEA results
    for the RNA-Seq dataset. Wilkinson&#39;s method was used to integrate the two
    p-values with a combined FDR-adjusted p-value &lt; {enrich_alpha} being taken
    as evidence of potential regulatory targets from increasingly bound 
    {target} binding sites. Of the {nrow(cmn_up)} gene-sets of interest, 
    {sum(cmn_up$Status == &#39;Both&#39;)} were individually enriched in both datasets,
    as indicated in the &#39;Status&#39; column
    &quot;
  )
)
tbl &lt;- cmn_up %&gt;%
  mutate(
    leadingEdge = vapply(
      leadingEdge,
      function(x) paste(id2gene[x], collapse = &quot;; &quot;),
      character(1)
    )
  ) %&gt;% 
  reactable(
    filterable = TRUE, showPageSizeOptions = TRUE,
    columns = list(
      gs_name = colDef(
        name = &quot;Gene Set&quot;,
        cell = function(value) htmltools::tags$a(
          href = gs_url[[value]], 
          target = &quot;_blank&quot;, 
          str_replace_all(value, &quot;_&quot;, &quot; &quot;)
        ),
        minWidth = 120
      ),
      adj_p = colDef(
        name = glue(&quot;p&lt;sub&gt;{params$enrichment$adj}&lt;/sub&gt;&quot;), html = TRUE,
        cell = function(value) ifelse(
          value &lt; 0.001,
          sprintf(&quot;%.2e&quot;, value),
          sprintf(&quot;%.3f&quot;, value)
        ),
        maxWidth = 80
      ),
      Status = colDef(name = &quot;Prior Status&quot;, maxWidth = 100),
      NES = colDef(
        format = colFormat(digits = 2),
        style = function(value) {
          col &lt;- ifelse(value &gt; 0, colours$direction[&quot;up&quot;], colours$direction[&quot;down&quot;])
          list(color = col)
        },
        maxWidth = 80
      ),
      padj_rna = colDef(
        name =  glue(&quot;p&lt;sub&gt;{params$enrichment$adj}&lt;/sub&gt; (RNA)&quot;), html = TRUE,
        cell = function(value) ifelse(
          value &lt; 0.001,
          sprintf(&quot;%.2e&quot;, value),
          sprintf(&quot;%.3f&quot;, value)
        ),
        maxWidth = 80
      ),
      padj_chip = colDef(
        name =  glue(&quot;p&lt;sub&gt;{params$enrichment$adj}&lt;/sub&gt; (ChIP)&quot;), html = TRUE,
        cell = function(value) ifelse(
          value &lt; 0.001,
          sprintf(&quot;%.2e&quot;, value),
          sprintf(&quot;%.3f&quot;, value)
        ),
        maxWidth = 80
      ),
      numDEInCat = colDef(name = &quot;ChIP Targets in Leading Edge&quot;, maxWidth = 100),
      numInCat = colDef(name = &quot;Mapped Genes&quot;, maxWidth = 100),
      leadingEdge = colDef(
        name = &quot;Leading Edge ChIP Targets&quot;,
        cell = function(value) with_tooltip(value, width = 50),
        minWidth = 120
      )
    )
  )
div(
  class = &quot;table&quot;, 
  div(
    class = &quot;table-header&quot;,
    div(class = &quot;caption&quot;, cp)
  ),
  tbl
)</code></pre>
<div class="table">
<div class="table-header">
<div class="caption">
<em>Genes mapped to all windows showing evidence of increased H3K27ac binding were 
tested for enrichment using goseq, and results were compared to GSEA results
for the RNA-Seq dataset. Wilkinson's method was used to integrate the two
p-values with a combined FDR-adjusted p-value &lt; 0.05 being taken
as evidence of potential regulatory targets from increasingly bound 
H3K27ac binding sites. Of the 19 gene-sets of interest, 
0 were individually enriched in both datasets,
as indicated in the 'Status' column</em>
</div>
</div>
<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f931cf1bb85f7c04260f" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f931cf1bb85f7c04260f">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"gs_name":["HES2_TARGET_GENES","HALLMARK_ANDROGEN_RESPONSE","HALLMARK_ESTROGEN_RESPONSE_EARLY","REACTOME_FATTY_ACID_METABOLISM","REACTOME_PEROXISOMAL_PROTEIN_IMPORT","ZBTB18_TARGET_GENES","HALLMARK_ESTROGEN_RESPONSE_LATE","REACTOME_PHASE_II_CONJUGATION_OF_COMPOUNDS","GREB1_TARGET_GENES","REACTOME_METABOLISM_OF_LIPIDS","KEGG_PEROXISOME","HALLMARK_MTORC1_SIGNALING","WP_STEROL_REGULATORY_ELEMENTBINDING_PROTEINS_SREBP_SIGNALING","BPTF_TARGET_GENES","REACTOME_PROTEIN_LOCALIZATION","WP_VEGFAVEGFR2_SIGNALING_PATHWAY","REACTOME_BIOLOGICAL_OXIDATIONS","ZNF510_TARGET_GENES","NOTCH3_TARGET_GENES"],"adj_p":[2.2175083113308577e-05,5.3560427562919608e-05,0.0030920325740096746,0.007782405396774255,0.007782405396774255,0.007782405396774255,0.0083621953572930487,0.0083621953572930487,0.0094823589293220323,0.010750363200593031,0.018547723824007406,0.024358784317248132,0.028998754460881408,0.030467034776587694,0.030467034776587694,0.030467034776587694,0.031083884693764212,0.036601470795525268,0.048954981883044417],"Status":["ChIP Only","Neither","ChIP Only","Neither","Neither","Neither","ChIP Only","Neither","Neither","Neither","Neither","Neither","Neither","Neither","Neither","Neither","Neither","Neither","Neither"],"NES":[1.3581071646536731,1.6406866779751446,1.4663464243649271,1.6013882506471595,1.528148642682146,1.3266386090964712,1.388448095783483,1.483572017371747,1.2719768449590245,1.3660360772957867,1.4370076987946829,1.4710453536310579,1.4096613255950525,1.2550130445969765,1.5100769311126172,1.2669831674366263,1.4675910376099002,1.4751600837208043,1.2169588147419428],"padj_rna":[0.072520680951891361,0.0630045895037077,0.21513799193981131,0.072520680951891361,0.2167909272102537,0.2167909272102537,0.31295139090778956,0.31295139090778956,0.33279176884377748,0.1727392011451048,0.38621347998090516,0.1727392011451048,0.44402093231135159,0.47074993778919533,0.18856731287137352,0.47341927562922043,0.2906794720812188,0.34143503525914676,0.48825217299031065],"padj_chip":[0.00016025252251856129,0.16185703800340961,0.00016025252251856129,0.46655463938480701,0.46655463938480701,0.47085340393993663,0.04090160682409056,0.3793640354090308,0.47085340393993663,0.61411256631241584,0.68259684421668376,0.74895579870743811,0.68259684421668376,0.39870202570288565,0.82286488679983882,0.39658582252815888,0.83518190395170011,0.83518190395170011,0.86613730948316003],"numDEInCat":[13,3,9,5,3,7,5,3,12,10,3,4,3,6,3,5,5,3,8],"numInCat":[880,89,176,113,50,618,164,51,649,519,62,190,63,520,145,343,95,30,747],"leadingEdge":["AQP3; EHF; NRP1; SYBU; NEDD4L; DIO2; CRYBG1; IQGAP2; NFKBIA; MCCC2; SGK3; MTMR9; SMIM14","FKBP5; IQGAP2; SORD","AQP3; FKBP5; SEC14L2; KDM4B; SYBU; WWC1; TMEM164; CHPT1; DEPTOR","PRKAB2; ECI2; CRAT; ACACA; PRKAA2","ECI2; CRAT; PEX10","KDM4B; CRYBG1; CD9; IQGAP2; MCCC2; SGK3; TTC21A","UGDH; FKBP5; CD9; SORD; CHPT1","UGDH; GSTM3; ACSM1","SEC14L2; ZNF689; EHF; NRP1; KDM4B; SYBU; WWC1; NFKBIA; MCCC2; CCDC40; DSCAM-AS1; CHPT1","HSD11B2; GPCPD1; PRKAB2; ECI2; MTMR9; CRAT; ACACA; PRKAA2; CHPT1; MED21","ECI2; CRAT; PEX10","CD9; SORD; NAMPT; ACACA","PRKAB2; ACACA; PRKAA2","PRKAB2; TTC21A; SMIM14; CUEDC1; AL391684.1; ARID5B","ECI2; CRAT; PEX10","PTPRJ; NFKBIA; ACACA; PRKAA2; ITGAV","UGDH; GSTM3; ACSM1; SULT2B1; GSTM4","RANBP3L; NOL6; MED21","MYCBP2; CNNM1; CRAT; CCDC96; OLMALINC; CUEDC1; MTCL1; STX18"]},"columns":[{"id":"gs_name","name":"Gene Set","type":"character","cell":[{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["HES2 TARGET GENES"]},{"name":"a","attribs":{"href":null,"target":"_blank"},"children":["HALLMARK ANDROGEN RESPONSE"]},{"name":"a","attribs":{"href":null,"target":"_blank"},"children":["HALLMARK ESTROGEN RESPONSE EARLY"]},{"name":"a","attribs":{"href":"https://www.reactome.org/content/detail/R-HSA-8978868","target":"_blank"},"children":["REACTOME FATTY ACID METABOLISM"]},{"name":"a","attribs":{"href":"https://www.reactome.org/content/detail/R-HSA-9033241","target":"_blank"},"children":["REACTOME PEROXISOMAL PROTEIN IMPORT"]},{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["ZBTB18 TARGET GENES"]},{"name":"a","attribs":{"href":null,"target":"_blank"},"children":["HALLMARK ESTROGEN RESPONSE LATE"]},{"name":"a","attribs":{"href":"https://www.reactome.org/content/detail/R-HSA-156580","target":"_blank"},"children":["REACTOME PHASE II CONJUGATION OF COMPOUNDS"]},{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["GREB1 TARGET GENES"]},{"name":"a","attribs":{"href":"https://www.reactome.org/content/detail/R-HSA-556833","target":"_blank"},"children":["REACTOME METABOLISM OF LIPIDS"]},{"name":"a","attribs":{"href":"http://www.genome.jp/kegg/pathway/hsa/hsa04146.html","target":"_blank"},"children":["KEGG PEROXISOME"]},{"name":"a","attribs":{"href":null,"target":"_blank"},"children":["HALLMARK MTORC1 SIGNALING"]},{"name":"a","attribs":{"href":"http://www.wikipathways.org/instance/WP1982_r116442","target":"_blank"},"children":["WP STEROL REGULATORY ELEMENTBINDING PROTEINS SREBP SIGNALING"]},{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["BPTF TARGET GENES"]},{"name":"a","attribs":{"href":"https://www.reactome.org/content/detail/R-HSA-9609507","target":"_blank"},"children":["REACTOME PROTEIN LOCALIZATION"]},{"name":"a","attribs":{"href":"http://www.wikipathways.org/instance/WP3888_r116782","target":"_blank"},"children":["WP VEGFAVEGFR2 SIGNALING PATHWAY"]},{"name":"a","attribs":{"href":"https://www.reactome.org/content/detail/R-HSA-211859","target":"_blank"},"children":["REACTOME BIOLOGICAL OXIDATIONS"]},{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["ZNF510 TARGET GENES"]},{"name":"a","attribs":{"href":"http://gtrd.biouml.org/","target":"_blank"},"children":["NOTCH3 TARGET GENES"]}],"minWidth":120},{"id":"adj_p","name":"p<sub>fdr<\/sub>","type":"numeric","cell":["2.22e-05","5.36e-05","0.003","0.008","0.008","0.008","0.008","0.008","0.009","0.011","0.019","0.024","0.029","0.030","0.030","0.030","0.031","0.037","0.049"],"html":true,"maxWidth":80},{"id":"Status","name":"Prior Status","type":"factor","maxWidth":100},{"id":"NES","name":"NES","type":"numeric","format":{"cell":{"digits":2},"aggregated":{"digits":2}},"maxWidth":80,"style":[{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"},{"color":"#CA0020"}]},{"id":"padj_rna","name":"p<sub>fdr<\/sub> (RNA)","type":"numeric","cell":["0.073","0.063","0.215","0.073","0.217","0.217","0.313","0.313","0.333","0.173","0.386","0.173","0.444","0.471","0.189","0.473","0.291","0.341","0.488"],"html":true,"maxWidth":80},{"id":"padj_chip","name":"p<sub>fdr<\/sub> (ChIP)","type":"numeric","cell":["1.60e-04","0.162","1.60e-04","0.467","0.467","0.471","0.041","0.379","0.471","0.614","0.683","0.749","0.683","0.399","0.823","0.397","0.835","0.835","0.866"],"html":true,"maxWidth":80},{"id":"numDEInCat","name":"ChIP Targets in Leading Edge","type":"numeric","maxWidth":100},{"id":"numInCat","name":"Mapped Genes","type":"numeric","maxWidth":100},{"id":"leadingEdge","name":"Leading Edge ChIP Targets","type":"character","cell":[{"name":"span","attribs":{"title":"AQP3; EHF; NRP1; SYBU; NEDD4L; DIO2; CRYBG1; IQGAP2; NFKBIA; MCCC2; SGK3; MTMR9; SMIM14"},"children":["AQP3; EHF; NRP1; SYBU; NEDD4L; DIO2; CRYBG1; IQ..."]},{"name":"span","attribs":{"title":"FKBP5; IQGAP2; SORD"},"children":["FKBP5; IQGAP2; SORD"]},{"name":"span","attribs":{"title":"AQP3; FKBP5; SEC14L2; KDM4B; SYBU; WWC1; TMEM164; CHPT1; DEPTOR"},"children":["AQP3; FKBP5; SEC14L2; KDM4B; SYBU; WWC1; TMEM16..."]},{"name":"span","attribs":{"title":"PRKAB2; ECI2; CRAT; ACACA; PRKAA2"},"children":["PRKAB2; ECI2; CRAT; ACACA; PRKAA2"]},{"name":"span","attribs":{"title":"ECI2; CRAT; PEX10"},"children":["ECI2; CRAT; PEX10"]},{"name":"span","attribs":{"title":"KDM4B; CRYBG1; CD9; IQGAP2; MCCC2; SGK3; TTC21A"},"children":["KDM4B; CRYBG1; CD9; IQGAP2; MCCC2; SGK3; TTC21A"]},{"name":"span","attribs":{"title":"UGDH; FKBP5; CD9; SORD; CHPT1"},"children":["UGDH; FKBP5; CD9; SORD; CHPT1"]},{"name":"span","attribs":{"title":"UGDH; GSTM3; ACSM1"},"children":["UGDH; GSTM3; ACSM1"]},{"name":"span","attribs":{"title":"SEC14L2; ZNF689; EHF; NRP1; KDM4B; SYBU; WWC1; NFKBIA; MCCC2; CCDC40; DSCAM-AS1; CHPT1"},"children":["SEC14L2; ZNF689; EHF; NRP1; KDM4B; SYBU; WWC1; ..."]},{"name":"span","attribs":{"title":"HSD11B2; GPCPD1; PRKAB2; ECI2; MTMR9; CRAT; ACACA; PRKAA2; CHPT1; MED21"},"children":["HSD11B2; GPCPD1; PRKAB2; ECI2; MTMR9; CRAT; ACA..."]},{"name":"span","attribs":{"title":"ECI2; CRAT; PEX10"},"children":["ECI2; CRAT; PEX10"]},{"name":"span","attribs":{"title":"CD9; SORD; NAMPT; ACACA"},"children":["CD9; SORD; NAMPT; ACACA"]},{"name":"span","attribs":{"title":"PRKAB2; ACACA; PRKAA2"},"children":["PRKAB2; ACACA; PRKAA2"]},{"name":"span","attribs":{"title":"PRKAB2; TTC21A; SMIM14; CUEDC1; AL391684.1; ARID5B"},"children":["PRKAB2; TTC21A; SMIM14; CUEDC1; AL391684.1; ARID5B"]},{"name":"span","attribs":{"title":"ECI2; CRAT; PEX10"},"children":["ECI2; CRAT; PEX10"]},{"name":"span","attribs":{"title":"PTPRJ; NFKBIA; ACACA; PRKAA2; ITGAV"},"children":["PTPRJ; NFKBIA; ACACA; PRKAA2; ITGAV"]},{"name":"span","attribs":{"title":"UGDH; GSTM3; ACSM1; SULT2B1; GSTM4"},"children":["UGDH; GSTM3; ACSM1; SULT2B1; GSTM4"]},{"name":"span","attribs":{"title":"RANBP3L; NOL6; MED21"},"children":["RANBP3L; NOL6; MED21"]},{"name":"span","attribs":{"title":"MYCBP2; CNNM1; CRAT; CCDC96; OLMALINC; CUEDC1; MTCL1; STX18"},"children":["MYCBP2; CNNM1; CRAT; CCDC96; OLMALINC; CUEDC1; ..."]}],"minWidth":120}],"filterable":true,"showPageSizeOptions":true,"dataKey":"81512477cc03ef101ce4cf2b58643627"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="network-plot-1" class="section level4">
<h4>Network Plot</h4>
<pre class="r"><code>tg_up %&gt;% 
  activate(nodes) %&gt;% 
  mutate(direction = ifelse(NES &gt; 0, &quot;Up&quot;, &quot;Down&quot;)) %&gt;% 
  ggraph(layout = net_layout, weights = oc^2) +
  geom_edge_link(aes(width = oc^2, alpha = oc^2)) +
  geom_node_point(
    aes(fill = Status, size = numDEInCat),
    shape = 21
  ) +
  geom_node_text(
    aes(label = label, colour = direction),
    size = 3, 
    data = . %&gt;%
      mutate(
        label = str_replace_all(label, &quot;_&quot;, &quot; &quot;) %&gt;% str_trunc(80) %&gt;% str_wrap(width = 18)
      ),
    repel = TRUE, max.overlaps = max(10, round(length(tg_up) / 4, 0)),
    bg.color = &quot;white&quot;, bg.r = 0.1, 
  ) +
  scale_x_continuous(expand = expansion(c(0.1, 0.1))) +
  scale_y_continuous(expand = expansion(c(0.1, 0.1))) +
  scale_fill_manual(values = status_cols) +
  scale_size_continuous(range = c(1, 10)) +
  scale_edge_width(range = c(1, 6), limits = c(0, 1)) +
  scale_edge_alpha(range = c(0.1, 0.4), limits = c(0, 1))  +
  scale_colour_manual(
    values = setNames(direction_colours, str_to_title(names(direction_colours)))
  ) +
  guides(edge_alpha= &quot;none&quot;) +
  labs(
    size = glue(&quot;{target} Targets In Leading Edge&quot;) %&gt;% str_wrap(15),
    colour = &quot;GSEA\nDirection&quot;,
    fill = &quot;Prior\nSignificance&quot;,
    edge_width = expr(paste(OC^2))
  ) +
  theme_void() +
  theme(legend.text = element_text(hjust = 0.5))</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/network-cmn-allup-1.png" alt="*Network plot for pathways considered significant when assessing all increasingly bound H3K27ac sites along with GSEA on the provided RNA-Seq data. Distances are derived from all detected genes within the pathway. Label colours indicate the direction of enrichment in GSEA results for genes in the pathway.*" width="960" />
<p class="caption">
<em>Network plot for pathways considered significant when assessing all
increasingly bound H3K27ac sites along with GSEA on the provided RNA-Seq
data. Distances are derived from all detected genes within the pathway.
Label colours indicate the direction of enrichment in GSEA results for
genes in the pathway.</em>
</p>
</div>
</div>
</div>
<div id="windows-with-decreased-h3k27ac" class="section level3 tabset">
<h3 class="tabset">Windows With Decreased H3K27ac</h3>
<pre class="r"><code>cmn_down &lt;- rnaseq_gsea %&gt;%
  dplyr::select(-log2err, -ES, -size) %&gt;% 
  left_join(
    goseq_down, by = c(&quot;pathway&quot; = &quot;gs_name&quot;), suffix = c(&quot;.rna&quot;, &quot;.chip&quot;)
  ) %&gt;%
  dplyr::filter(!is.na(pval.rna), !is.na(pval.chip)) %&gt;% 
  nest(p = starts_with(&quot;pval&quot;)) %&gt;% 
  mutate(
    pval = vapply(p, function(x) metap::maximump(unlist(x))$p, numeric(1))
    ) %&gt;%
  dplyr::rename(padj_chip = adj_p, padj_rna = padj) %&gt;% 
  mutate(adj_p = p.adjust(pval, params$enrichment$adj)) %&gt;% 
  arrange(pval) %&gt;% 
  dplyr::filter(adj_p &lt; enrich_alpha) %&gt;% 
  mutate(
    leadingEdge = lapply(
      leadingEdge, intersect, dplyr::filter(mapped_ids, down)$gene_id
    ),
    numDEInCat = vapply(leadingEdge, length, integer(1)),
    Status = case_when(
      padj_rna &lt; enrich_alpha &amp; padj_chip &lt; enrich_alpha ~ &quot;Both&quot;,
      padj_rna &lt; enrich_alpha &amp; !padj_chip &lt; enrich_alpha ~ &quot;RNA Only&quot;,
      !padj_rna &lt; enrich_alpha &amp; padj_chip &lt; enrich_alpha ~ &quot;ChIP Only&quot;,
      !padj_rna &lt; enrich_alpha &amp; !padj_chip &lt; enrich_alpha ~ &quot;Neither&quot;
    ) %&gt;% 
      factor(levels = names(status_cols))
  ) %&gt;% 
  dplyr::filter(numDEInCat &gt;= min_sig) %&gt;% 
  dplyr::select(
    gs_name = pathway, adj_p, Status, NES, starts_with(&quot;padj&quot;),
    starts_with(&quot;num&quot;), leadingEdge
  ) 
tg_down &lt;- cmn_down %&gt;% 
  make_tbl_graph(
    setNames(.$leadingEdge, .$gs_name)
  )
plot_net &lt;- length(tg_down) &gt;= min_network_size
txt &lt;- ifelse(
  nrow(cmn_down) == 0,
  glue(&quot;No gene sets were jointly enriched between all decreasing {target} bound windows and the RNA-Seq data&quot;),
  &quot;#### Results Table&quot;
)</code></pre>
<p>No gene sets were jointly enriched between all decreasing H3K27ac
bound windows and the RNA-Seq data</p>
<pre class="r"><code>tg_down %&gt;% 
  activate(nodes) %&gt;% 
  mutate(direction = ifelse(NES &gt; 0, &quot;Up&quot;, &quot;Down&quot;)) %&gt;% 
  ggraph(layout = net_layout, weights = oc^2) +
  geom_edge_link(aes(width = oc^2, alpha = oc^2)) +
  geom_node_point(
    aes(fill = Status, size = numDEInCat),
    shape = 21
  ) +
  geom_node_text(
    aes(label = label, colour = direction),
    size = 3, 
    data = . %&gt;%
      mutate(
        label = str_replace_all(label, &quot;_&quot;, &quot; &quot;) %&gt;% str_trunc(80) %&gt;% str_wrap(width = 18)
      ),
    repel = TRUE, max.overlaps = max(10, round(length(tg_down) / 4, 0)),
    bg.color = &quot;white&quot;, bg.r = 0.1, 
  ) +
  scale_x_continuous(expand = expansion(c(0.1, 0.1))) +
  scale_y_continuous(expand = expansion(c(0.1, 0.1))) +
  scale_fill_manual(values = status_cols) +
  scale_size_continuous(range = c(1, 10)) +
  scale_edge_width(range = c(1, 6), limits = c(0, 1)) +
  scale_edge_alpha(range = c(0.1, 0.4), limits = c(0, 1))  +
  scale_colour_manual(
    values = setNames(direction_colours, str_to_title(names(direction_colours)))
  ) +
  guides(edge_alpha= &quot;none&quot;) +
  labs(
    size = glue(&quot;{target} Targets In Leading Edge&quot;) %&gt;% str_wrap(15),
    colour = &quot;GSEA\nDirection&quot;,
    fill = &quot;Prior\nSignificance&quot;,
    edge_width = expr(paste(OC^2))
  ) +
  theme_void() +
  theme(legend.text = element_text(hjust = 0.5))</code></pre>
</div>
</div>
<div id="highly-ranked-genes" class="section level2 tabset">
<h2 class="tabset">Highly Ranked Genes</h2>
<pre class="r"><code>knitr::opts_chunk$set(dev = fig_type)
all_ids &lt;- unlist(merged_results$gene_id)
db_ids &lt;- unlist(filter(merged_results, !!sym(fdr_column) &lt; fdr_alpha)$gene_id)
top_diff_win &lt;- rnaseq %&gt;% 
  mutate(
    n_windows = vapply(
      gene_id,
      function(x) sum(str_detect(all_ids, x)),
      integer(1)
    ),
    n_db_windows = vapply(
      gene_id,
      function(x) sum(str_detect(db_ids, x)),
      integer(1)
    )
  ) %&gt;% 
  arrange(!!sym(rna_p_col)) %&gt;% 
  dplyr::filter(n_windows &gt; 1) %&gt;% 
  dplyr::slice(1:5)
grl_to_plot &lt;- top_diff_win$gene_id %&gt;% 
  sapply(
    function(x) {
      subset(
        merged_results, 
        vapply(gene_id, function(id) x %in% id, logical(1))
      ) %&gt;% 
        granges() %&gt;% 
        ## Restrict this to only sites within 5Mb of a gene
        subsetByOverlaps(
          resize(subset(genes_gr, gene_id == x), width = 1e7, fix = &#39;center&#39;)
        ) %&gt;% 
        c(
          granges(subset(genes_gr, gene_id == x))
        ) %&gt;% 
        unstrand() %&gt;% 
        sort()
    },
    simplify = FALSE
  ) %&gt;% 
  lapply(range) %&gt;% 
  GRangesList()
hfgc_genes &lt;- hfgc_genes[names(hfgc_genes) != &quot;Undetected&quot;]
if (!is.null(config$external$coverage)) {
  y_ranges &lt;- granges(unlist(grl_to_plot))
  y_lim &lt;- c(
    y_lim[target],
    bwfl[names(bwfl) != target] %&gt;% 
      lapply(
        function(x) {
          GRangesList(lapply(x, import.bw, which = y_ranges)) %&gt;% 
            unlist() %&gt;% 
            filter(score == max(score)) %&gt;% 
            mcols() %&gt;% 
            .[[&quot;score&quot;]] %&gt;% 
            c(0) %&gt;% 
            range()
        }
      )
  )
}
i &lt;- 1</code></pre>
<p>Using the ranked list of genes from the RNA-Seq data, the 5 genes
most highly ranked for differential expression, with more than one
H3K27ac-bound window mapped to it were selected for visualisation.</p>
<div id="aqp3" class="section level3">
<h3>AQP3</h3>
<pre class="r"><code>ct &lt;- trans_models %&gt;% 
  subsetByOverlaps(grl_to_plot[[i]]) %&gt;% 
  as_tibble() %&gt;% 
  pull(&quot;transcript&quot;) %&gt;% 
  unique() %&gt;% 
  length() %&gt;% 
  is_greater_than(10) %&gt;% 
  ifelse(&quot;meta&quot;, FALSE)
plotHFGC(
  grl_to_plot[[i]],
  hic = hic %&gt;% 
     subsetByOverlaps(
       subset(genes_gr, gene_id == names(grl_to_plot)[[i]])
     ) %&gt;% 
    subsetByOverlaps(
      subsetByOverlaps(merged_results, grl_to_plot[[i]])
    ),
  features = feat_gr, featcol = feature_colours, featstack = &quot;dense&quot;, 
  genes = hfgc_genes, genecol = gene_col, genesize = 0.7,
  coverage = bwfl,
  linecol = line_col,
  annotation = annot,
  annotcol = colours$direction %&gt;%
    setNames(str_to_title(names(.))),
  cytobands = bands_df,
  collapseTranscripts = ct, # Set this as a function of n_transcripts
  zoom = 1.1,
  fontsize = 10,
  max = width(grl_to_plot[[i]]),
  ylim = y_lim,
  highlight = c(),
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-gene1-1.png" alt="*Region showing all merged H3K27ac-bound windows mapped to UGDH. Windows considered to be unchanged for H3K27ac are annotated in grey, with other colours indicating H3K27ac gain or loss. Mapped windows are only shown if within 5Mb of UGDH. Gene-centric regions and external features are shown in the top panel. The estimated logFC for UGDH is 1.52 with an FDR of 2.34e-10. Undetected and unchanged genes are shown on separate tracks.*" width="960" />
<p class="caption">
<em>Region showing all merged H3K27ac-bound windows mapped to UGDH.
Windows considered to be unchanged for H3K27ac are annotated in grey,
with other colours indicating H3K27ac gain or loss. Mapped windows are
only shown if within 5Mb of UGDH. Gene-centric regions and external
features are shown in the top panel. The estimated logFC for UGDH is
1.52 with an FDR of 2.34e-10. Undetected and unchanged genes are shown
on separate tracks.</em>
</p>
</div>
<pre class="r"><code>i &lt;- i + 1</code></pre>
</div>
<div id="ugdh" class="section level3">
<h3>UGDH</h3>
<pre class="r"><code>ct &lt;- trans_models %&gt;% 
  subsetByOverlaps(grl_to_plot[[i]]) %&gt;% 
  as_tibble() %&gt;% 
  pull(&quot;transcript&quot;) %&gt;% 
  unique() %&gt;% 
  length() %&gt;% 
  is_greater_than(10) %&gt;% 
  ifelse(&quot;meta&quot;, FALSE)
plotHFGC(
  grl_to_plot[[i]],
  hic = hic %&gt;% 
     subsetByOverlaps(
       subset(genes_gr, gene_id == names(grl_to_plot)[[i]])
     ) %&gt;% 
    subsetByOverlaps(
      subsetByOverlaps(merged_results, grl_to_plot[[i]])
    ),
  features = feat_gr, featcol = feature_colours, featstack = &quot;dense&quot;, 
  genes = hfgc_genes, genecol = gene_col, genesize = 0.7,
  coverage = bwfl,
  linecol = line_col,
  annotation = annot,
  annotcol = colours$direction %&gt;%
    setNames(str_to_title(names(.))),
  cytobands = bands_df,
  collapseTranscripts = ct, # Set this as a function of n_transcripts
  zoom = 1.1,
  max = width(grl_to_plot[[i]]),
  fontsize = 10,
  ylim = y_lim,
  highlight = c(),
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-gene2-1.png" alt="*Region showing all merged H3K27ac-bound windows mapped to FKBP5. Windows considered to be unchanged for H3K27ac are annotated in grey, with other colours indicating H3K27ac gain or loss. Mapped windows are only shown if within 5Mb of FKBP5. Gene-centric regions and external features are shown in the top panel. The estimated logFC for FKBP5 is 2.00 with an FDR of 6.51e-10. Undetected and unchanged genes are shown on separate tracks.*" width="960" />
<p class="caption">
<em>Region showing all merged H3K27ac-bound windows mapped to FKBP5.
Windows considered to be unchanged for H3K27ac are annotated in grey,
with other colours indicating H3K27ac gain or loss. Mapped windows are
only shown if within 5Mb of FKBP5. Gene-centric regions and external
features are shown in the top panel. The estimated logFC for FKBP5 is
2.00 with an FDR of 6.51e-10. Undetected and unchanged genes are shown
on separate tracks.</em>
</p>
</div>
<pre class="r"><code>i &lt;- i + 1</code></pre>
</div>
<div id="fkbp5" class="section level3">
<h3>FKBP5</h3>
<pre class="r"><code>ct &lt;- trans_models %&gt;% 
  subsetByOverlaps(grl_to_plot[[i]]) %&gt;% 
  as_tibble() %&gt;% 
  pull(&quot;transcript&quot;) %&gt;% 
  unique() %&gt;% 
  length() %&gt;% 
  is_greater_than(10) %&gt;% 
  ifelse(&quot;meta&quot;, FALSE)
plotHFGC(
  grl_to_plot[[i]],
  hic = hic %&gt;% 
     subsetByOverlaps(
       subset(genes_gr, gene_id == names(grl_to_plot)[[i]])
     ) %&gt;% 
    subsetByOverlaps(
      subsetByOverlaps(merged_results, grl_to_plot[[i]])
    ),
  features = feat_gr, featcol = feature_colours, featstack = &quot;dense&quot;, 
  genes = hfgc_genes, genecol = gene_col, genesize = 0.7,
  coverage = bwfl,
  linecol = line_col,
  annotation = annot,
  annotcol = colours$direction %&gt;%
    setNames(str_to_title(names(.))),
  cytobands = bands_df,
  collapseTranscripts = ct, # Set this as a function of n_transcripts
  zoom = 1.1,
  max = width(grl_to_plot[[i]]),
  fontsize = 10,
  ylim = y_lim,
  highlight = c(),
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-gene3-1.png" alt="*Region showing all merged H3K27ac-bound windows mapped to SEC14L2. Windows considered to be unchanged for H3K27ac are annotated in grey, with other colours indicating H3K27ac gain or loss. Mapped windows are only shown if within 5Mb of SEC14L2. Gene-centric regions and external features are shown in the top panel. The estimated logFC for SEC14L2 is 2.65 with an FDR of 8.87e-10. Undetected and unchanged genes are shown on separate tracks.*" width="960" />
<p class="caption">
<em>Region showing all merged H3K27ac-bound windows mapped to SEC14L2.
Windows considered to be unchanged for H3K27ac are annotated in grey,
with other colours indicating H3K27ac gain or loss. Mapped windows are
only shown if within 5Mb of SEC14L2. Gene-centric regions and external
features are shown in the top panel. The estimated logFC for SEC14L2 is
2.65 with an FDR of 8.87e-10. Undetected and unchanged genes are shown
on separate tracks.</em>
</p>
</div>
<pre class="r"><code>i &lt;- i + 1</code></pre>
</div>
<div id="sec14l2" class="section level3">
<h3>SEC14L2</h3>
<pre class="r"><code>ct &lt;- trans_models %&gt;% 
  subsetByOverlaps(grl_to_plot[[i]]) %&gt;% 
  as_tibble() %&gt;% 
  pull(&quot;transcript&quot;) %&gt;% 
  unique() %&gt;% 
  length() %&gt;% 
  is_greater_than(10) %&gt;% 
  ifelse(&quot;meta&quot;, FALSE)
plotHFGC(
  grl_to_plot[[i]],
  hic = hic %&gt;% 
     subsetByOverlaps(
       subset(genes_gr, gene_id == names(grl_to_plot)[[i]])
     ) %&gt;% 
    subsetByOverlaps(
      subsetByOverlaps(merged_results, grl_to_plot[[i]])
    ),
  features = feat_gr, featcol = feature_colours, featstack = &quot;dense&quot;, 
  genes = hfgc_genes, genecol = gene_col, genesize = 0.7,
  coverage = bwfl,
  linecol = line_col,
  annotation = annot,
  annotcol = colours$direction %&gt;%
    setNames(str_to_title(names(.))),
  cytobands = bands_df,
  collapseTranscripts = ct, # Set this as a function of n_transcripts
  zoom = 1.1,
  max = width(grl_to_plot[[i]]),
  fontsize = 10,
  ylim = y_lim,
  highlight = c(),
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-gene4-1.png" alt="*Region showing all merged H3K27ac-bound windows mapped to CLDN8. Windows considered to be unchanged for H3K27ac are annotated in grey, with other colours indicating H3K27ac gain or loss. Mapped windows are only shown if within 5Mb of CLDN8. Gene-centric regions and external features are shown in the top panel. The estimated logFC for CLDN8 is 2.31 with an FDR of 1.01e-09. Undetected and unchanged genes are shown on separate tracks.*" width="960" />
<p class="caption">
<em>Region showing all merged H3K27ac-bound windows mapped to CLDN8.
Windows considered to be unchanged for H3K27ac are annotated in grey,
with other colours indicating H3K27ac gain or loss. Mapped windows are
only shown if within 5Mb of CLDN8. Gene-centric regions and external
features are shown in the top panel. The estimated logFC for CLDN8 is
2.31 with an FDR of 1.01e-09. Undetected and unchanged genes are shown
on separate tracks.</em>
</p>
</div>
<pre class="r"><code>i &lt;- i + 1</code></pre>
</div>
<div id="cldn8" class="section level3">
<h3>CLDN8</h3>
<pre class="r"><code>ct &lt;- trans_models %&gt;% 
  subsetByOverlaps(grl_to_plot[[i]]) %&gt;% 
  as_tibble() %&gt;% 
  pull(&quot;transcript&quot;) %&gt;% 
  unique() %&gt;% 
  length() %&gt;% 
  is_greater_than(10) %&gt;% 
  ifelse(&quot;meta&quot;, FALSE)
plotHFGC(
  grl_to_plot[[i]],
  hic = hic %&gt;% 
     subsetByOverlaps(
       subset(genes_gr, gene_id == names(grl_to_plot)[[i]])
     ) %&gt;% 
    subsetByOverlaps(
      subsetByOverlaps(merged_results, grl_to_plot[[i]])
    ),
  features = feat_gr, featcol = feature_colours, featstack = &quot;dense&quot;, 
  genes = hfgc_genes, genecol = gene_col, genesize = 0.7,
  coverage = bwfl,
  linecol = line_col,
  annotation = annot,
  annotcol = colours$direction %&gt;%
    setNames(str_to_title(names(.))),
  cytobands = bands_df,
  collapseTranscripts = ct, # Set this as a function of n_transcripts
  zoom = 1.1,
  max = width(grl_to_plot[[i]]),
  fontsize = 10,
  ylim = y_lim,
  highlight = c(),
  col.title = &quot;black&quot;, background.title = &quot;white&quot;, showAxis = FALSE,
  rotation.title = 90
)</code></pre>
<div class="figure" style="text-align: center">
<img src="H3K27ac_E2_E2DHT_differential_binding_files/figure-html/plot-gene5-1.png" alt="*Region showing all merged H3K27ac-bound windows mapped to CLDN8. Windows considered to be unchanged for H3K27ac are annotated in grey, with other colours indicating H3K27ac gain or loss. Mapped windows are only shown if within 5Mb of CLDN8. Gene-centric regions and external features are shown in the top panel. The estimated logFC for CLDN8 is 2.31 with an FDR of 1.01e-09. Undetected and unchanged genes are shown on separate tracks.*" width="960" />
<p class="caption">
<em>Region showing all merged H3K27ac-bound windows mapped to CLDN8.
Windows considered to be unchanged for H3K27ac are annotated in grey,
with other colours indicating H3K27ac gain or loss. Mapped windows are
only shown if within 5Mb of CLDN8. Gene-centric regions and external
features are shown in the top panel. The estimated logFC for CLDN8 is
2.31 with an FDR of 1.01e-09. Undetected and unchanged genes are shown
on separate tracks.</em>
</p>
</div>
</div>
</div>
</div>
<div id="data-export" class="section level1">
<h1>Data Export</h1>
<pre class="r"><code>merged_results %&gt;% 
  as_tibble() %&gt;%
  unnest(all_of(&quot;gene_id&quot;)) %&gt;%
  mutate(gene_name = id2gene[gene_id]) %&gt;% 
  dplyr::select(
    gene_id, gene_name, range, AveExpr, logFC, P.Value, FDR = !!sym(fdr_column), 
    status, any_of(c(&quot;region&quot;, &quot;feature&quot;)), macs2_peak = overlaps_ref,
  ) %&gt;% 
  mutate(
    distance_to_gene = distance(
      GRanges(range),
      setNames(genes_gr, genes_gr$gene_id)[gene_id]
    )
  ) %&gt;% 
  write_csv(
    gzfile(all_out$csv)
  )</code></pre>
<pre class="r"><code>write_rds(merged_results, all_out$results, compress = &quot;gz&quot;)
write_rds(filtered_counts, all_out$windows, compress = &quot;gz&quot;)
file.create(all_out$de_genes)
if (has_rnaseq) write_csv(de_genes_db_regions, all_out$de_genes)

file.create(all_out$up_regions)
if (sum(merged_results$status == &quot;Up&quot;) &gt; 0) {
  merged_results %&gt;% 
    filter(status == &quot;Up&quot;) %&gt;% 
    granges() %&gt;% 
    export.bed(all_out$up_regions)
}

file.create(all_out$down_regions)
if (sum(merged_results$status == &quot;Down&quot;) &gt; 0) {
  merged_results %&gt;% 
    filter(status == &quot;Down&quot;) %&gt;% 
    granges() %&gt;% 
    export.bed(all_out$up_regions)
}
## Enrichment results need a bit of tweaking to match the tables
list2(
  `All Differentially Bound` = goseq_diff,
  &quot;All Increased {target}&quot; := goseq_up,
  &quot;All Decreased {target}&quot; := goseq_down
) %&gt;% 
  bind_rows(.id = &#39;group&#39;) %&gt;% 
  dplyr::filter(adj_p &lt; enrich_alpha) %&gt;% 
  left_join(
    dplyr::select(msigdb, gs_name, gene_name, gene_id, gs_url, gs_description),
    by = &quot;gs_name&quot;
  ) %&gt;% 
  dplyr::filter(
    gene_id %in% unlist(subset(merged_results, status != &quot;Unchanged&quot;)$gene_id)
  ) %&gt;% 
  dplyr::select(-gene_id) %&gt;% 
  chop(gene_name) %&gt;% 
  mutate(
    gene_name = vapply(gene_name, paste, character(1), collapse = &quot;: &quot;),
    `%` = numDEInCat / numInCat,
  ) %&gt;% 
  dplyr::select(
    group,
    `Gene Set` = gs_name, Description = gs_description, URL = gs_url,
    `%`, numDEInCat, numInCat, p = pval, adj_p, 
    `Genes Mapped to DB Windows` = gene_name
  ) %&gt;% 
  write_csv(all_out$enrichment)
list2(
  `All Differentially Bound` = cmn_diff,
  &quot;All Increased {target}&quot; := cmn_up,
  &quot;All Decreased {target}&quot; := cmn_down
) %&gt;% 
  bind_rows(.id = &quot;group&quot;) %&gt;% 
  mutate(
    genes = vapply(leadingEdge, paste, character(1), collapse = &quot;; &quot;),
    leadingEdge = vapply(leadingEdge, paste, character(1), collapse = &quot;; &quot;),
  ) %&gt;% 
  write_csv(all_out$rna_enrichment)
## Save key memory on the HDD
rm(window_counts)
gc()
save.image(all_out$renv)</code></pre>
<p>During this workflow, the following files were exported:</p>
<ul>
<li><strong>results</strong>:
output/differential_binding/H3K27ac/H3K27ac_E2_E2DHT-differential_binding.rds</li>
<li><strong>csv</strong>:
output/differential_binding/H3K27ac/H3K27ac_E2_E2DHT-differential_binding.csv.gz</li>
<li><strong>windows</strong>:
output/differential_binding/H3K27ac/H3K27ac_E2_E2DHT-filtered_windows.rds</li>
<li><strong>up_regions</strong>:
output/differential_binding/H3K27ac/H3K27ac_E2_E2DHT-up.bed</li>
<li><strong>down_regions</strong>:
output/differential_binding/H3K27ac/H3K27ac_E2_E2DHT-down.bed</li>
<li><strong>de_genes</strong>:
output/differential_binding/H3K27ac/H3K27ac_E2_E2DHT-DE_genes.csv</li>
<li><strong>enrichment</strong>:
output/differential_binding/H3K27ac/H3K27ac_E2_E2DHT-enrichment.csv</li>
<li><strong>rna_enrichment</strong>:
output/differential_binding/H3K27ac/H3K27ac_E2_E2DHT-rnaseq_enrichment.csv</li>
<li><strong>renv</strong>:
output/envs/H3K27ac_E2_E2DHT-differential_binding.RData</li>
</ul>
<!-- end of list -->
<div id="references" class="section level2">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-HicksQuantro2015" class="csl-entry">
Hicks, S. C., and R. A. Irizarry. 2015. <span>“<span
class="nocase">quantro: a data-driven approach to guide the choice of an
appropriate normalization method</span>.”</span> <em>Genome Biol</em> 16
(June): 117.
</div>
<div id="ref-HicksSQN2017" class="csl-entry">
Hicks, Stephanie C, Kwame Okrah, Joseph N Paulson, John Quackenbush,
Rafael A Irizarry, and Héctor Corrada Bravo. 2017. <span>“<span
class="nocase">Smooth quantile normalization</span>.”</span>
<em>Biostatistics</em> 19 (2): 185–98. <a
href="https://doi.org/10.1093/biostatistics/kxx028">https://doi.org/10.1093/biostatistics/kxx028</a>.
</div>
<div id="ref-IgnatiadisIHW2016" class="csl-entry">
Ignatiadis, N., B. Klaus, J. B. Zaugg, and W. Huber. 2016. <span>“<span
class="nocase"><span>D</span>ata-driven hypothesis weighting increases
detection power in genome-scale multiple testing</span>.”</span> <em>Nat
Methods</em> 13 (7): 577–80.
</div>
<div id="ref-KorotkevichFgsea2019" class="csl-entry">
Korotkevich, Gennady, Vladimir Sukhov, and Alexey Sergushichev. 2019.
<span>“Fast Gene Set Enrichment Analysis.”</span> <em>bioRxiv</em>. <a
href="https://doi.org/10.1101/060012">https://doi.org/10.1101/060012</a>.
</div>
<div id="ref-LawVoom2014" class="csl-entry">
Law, C. W., Y. Chen, W. Shi, and G. K. Smyth. 2014. <span>“<span
class="nocase">voom: <span>P</span>recision weights unlock linear model
analysis tools for <span>R</span><span>N</span><span>A</span>-seq read
counts</span>.”</span> <em>Genome Biol</em> 15 (2): R29.
</div>
<div id="ref-LunSmythF1000" class="csl-entry">
Lun, A. T., and G. K. Smyth. 2015. <span>“<span
class="nocase"><span>F</span>rom reads to regions: a
<span>B</span>ioconductor workflow to detect differential binding in
<span>C</span>h<span>I</span><span>P</span>-seq data</span>.”</span>
<em>F1000Res</em> 4: 1080.
</div>
<div id="ref-LunSmythCsaw2014" class="csl-entry">
Lun, Aaron T L, and Gordon K Smyth. 2014. <span>“<span>D</span>e Novo
Detection of Differentially Bound Regions for
<span>C</span>h<span>I</span><span>P</span>-Seq Data Using Peaks and
Windows: Controlling Error Rates Correctly.”</span> <em>Nucleic Acids
Res.</em> 42 (11): e95.
</div>
<div id="ref-McCarthyTreat2009" class="csl-entry">
McCarthy, Davis J., and Gordon K. Smyth. 2009. <span>“<span
class="nocase">Testing significance relative to a fold-change threshold
is a TREAT</span>.”</span> <em>Bioinformatics</em> 25 (6): 765–71. <a
href="https://doi.org/10.1093/bioinformatics/btp053">https://doi.org/10.1093/bioinformatics/btp053</a>.
</div>
<div id="ref-SubramanianGsea2005" class="csl-entry">
Subramanian, Aravind, Pablo Tamayo, Vamsi K. Mootha, Sayan Mukherjee,
Benjamin L. Ebert, Michael A. Gillette, Amanda Paulovich, et al. 2005.
<span>“Gene Set Enrichment Analysis: A Knowledge-Based Approach for
Interpreting Genome-Wide Expression Profiles.”</span> <em>Proceedings of
the National Academy of Sciences</em> 102 (43): 15545–50. <a
href="https://doi.org/10.1073/pnas.0506580102">https://doi.org/10.1073/pnas.0506580102</a>.
</div>
<div id="ref-YoungGoseq2010" class="csl-entry">
Young, M. D., M. J. Wakefield, G. K. Smyth, and A. Oshlack. 2010.
<span>“<span class="nocase"><span>G</span>ene ontology analysis for
<span>R</span><span>N</span><span>A</span>-seq: accounting for selection
bias</span>.”</span> <em>Genome Biol</em> 11 (2): R14.
</div>
<div id="ref-Zhang18798982" class="csl-entry">
Zhang, Y., T. Liu, C. A. Meyer, J. Eeckhoute, D. S. Johnson, B. E.
Bernstein, C. Nusbaum, et al. 2008. <span>“<span
class="nocase"><span>M</span>odel-based analysis of
<span>C</span>h<span>I</span><span>P</span>-<span>S</span>eq
(<span>M</span><span>A</span><span>C</span><span>S</span>)</span>.”</span>
<em>Genome Biol</em> 9 (9): R137.
</div>
</div>
<br>
<button type="button" class="btn btn-default btn-sessioninfo" data-toggle="collapse" data-target="#sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
Session information </button>
</p>
<div id="sessioninfo" class="collapse">
<p><strong>R version 4.2.2 (2022-10-31)</strong></p>
<p><strong>Platform:</strong> x86_64-conda-linux-gnu (64-bit)</p>
<p><strong>locale:</strong> <em>LC_CTYPE=en_AU.UTF-8</em>,
<em>LC_NUMERIC=C</em>, <em>LC_TIME=en_AU.UTF-8</em>,
<em>LC_COLLATE=en_AU.UTF-8</em>, <em>LC_MONETARY=en_AU.UTF-8</em>,
<em>LC_MESSAGES=en_AU.UTF-8</em>, <em>LC_PAPER=en_AU.UTF-8</em>,
<em>LC_NAME=C</em>, <em>LC_ADDRESS=C</em>, <em>LC_TELEPHONE=C</em>,
<em>LC_MEASUREMENT=en_AU.UTF-8</em> and <em>LC_IDENTIFICATION=C</em></p>
<p><strong>attached base packages:</strong> <em>stats4</em>,
<em>stats</em>, <em>graphics</em>, <em>grDevices</em>, <em>utils</em>,
<em>datasets</em>, <em>methods</em> and <em>base</em></p>
<p><strong>other attached packages:</strong> <em>fgsea(v.1.24.0)</em>,
<em>qsmooth(v.1.14.0)</em>, <em>quantro(v.1.32.0)</em>,
<em>metap(v.1.1)</em>, <em>ggraph(v.2.1.0)</em>,
<em>tidygraph(v.1.2.3)</em>, <em>extraChIPs(v.1.2.4)</em>,
<em>goseq(v.1.50.0)</em>, <em>geneLenDataBase(v.1.34.0)</em>,
<em>BiasedUrn(v.2.0.10)</em>, <em>msigdbr(v.7.5.1)</em>,
<em>htmltools(v.0.5.5)</em>, <em>reactable(v.0.4.4)</em>,
<em>GenomicInteractions(v.1.32.0)</em>,
<em>InteractionSet(v.1.26.0)</em>, <em>ggside(v.0.2.2)</em>,
<em>rlang(v.1.1.1)</em>, <em>ggrepel(v.0.9.3)</em>,
<em>IHW(v.1.26.0)</em>, <em>statmod(v.1.5.0)</em>,
<em>magrittr(v.2.0.3)</em>, <em>scales(v.1.2.1)</em>,
<em>edgeR(v.3.40.0)</em>, <em>limma(v.3.54.0)</em>,
<em>csaw(v.1.32.0)</em>, <em>SummarizedExperiment(v.1.28.0)</em>,
<em>Biobase(v.2.58.0)</em>, <em>MatrixGenerics(v.1.10.0)</em>,
<em>matrixStats(v.1.0.0)</em>, <em>ngsReports(v.2.0.0)</em>,
<em>patchwork(v.1.1.2)</em>, <em>cowplot(v.1.1.1)</em>,
<em>Rsamtools(v.2.14.0)</em>, <em>Biostrings(v.2.66.0)</em>,
<em>XVector(v.0.38.0)</em>, <em>rtracklayer(v.1.58.0)</em>,
<em>plyranges(v.1.18.0)</em>, <em>GenomicRanges(v.1.50.0)</em>,
<em>GenomeInfoDb(v.1.34.9)</em>, <em>IRanges(v.2.32.0)</em>,
<em>S4Vectors(v.0.36.0)</em>, <em>BiocGenerics(v.0.44.0)</em>,
<em>yaml(v.2.3.7)</em>, <em>BiocParallel(v.1.32.5)</em>,
<em>pander(v.0.6.5)</em>, <em>glue(v.1.6.2)</em>,
<em>lubridate(v.1.9.2)</em>, <em>forcats(v.1.0.0)</em>,
<em>stringr(v.1.5.0)</em>, <em>dplyr(v.1.1.2)</em>,
<em>purrr(v.1.0.1)</em>, <em>readr(v.2.1.4)</em>,
<em>tidyr(v.1.3.0)</em>, <em>tibble(v.3.2.1)</em>,
<em>ggplot2(v.3.4.2)</em> and <em>tidyverse(v.2.0.0)</em></p>
<p><strong>loaded via a namespace (and not attached):</strong>
<em>rappdirs(v.0.3.3)</em>, <em>bumphunter(v.1.40.0)</em>,
<em>minfi(v.1.44.0)</em>, <em>bit64(v.4.0.5)</em>,
<em>knitr(v.1.43)</em>, <em>DelayedArray(v.0.24.0)</em>,
<em>data.table(v.1.14.8)</em>, <em>rpart(v.4.1.19)</em>,
<em>GEOquery(v.2.66.0)</em>, <em>KEGGREST(v.1.38.0)</em>,
<em>RCurl(v.1.98-1.12)</em>, <em>AnnotationFilter(v.1.22.0)</em>,
<em>doParallel(v.1.0.17)</em>, <em>generics(v.0.1.3)</em>,
<em>preprocessCore(v.1.60.2)</em>, <em>GenomicFeatures(v.1.50.2)</em>,
<em>EnrichedHeatmap(v.1.27.2)</em>, <em>lambda.r(v.1.2.4)</em>,
<em>RSQLite(v.2.3.1)</em>, <em>bit(v.4.0.5)</em>,
<em>tzdb(v.0.4.0)</em>, <em>xml2(v.1.3.3)</em>,
<em>viridis(v.0.6.3)</em>, <em>xfun(v.0.39)</em>, <em>hms(v.1.1.3)</em>,
<em>jquerylib(v.0.1.4)</em>, <em>babelgene(v.22.9)</em>,
<em>evaluate(v.0.21)</em>, <em>scrime(v.1.3.5)</em>,
<em>fansi(v.1.0.4)</em>, <em>restfulr(v.0.0.15)</em>,
<em>progress(v.1.2.2)</em>, <em>dbplyr(v.2.3.2)</em>,
<em>igraph(v.1.4.2)</em>, <em>DBI(v.1.1.3)</em>,
<em>htmlwidgets(v.1.6.2)</em>, <em>futile.logger(v.1.4.3)</em>,
<em>reshape(v.0.8.9)</em>, <em>ellipsis(v.0.3.2)</em>,
<em>crosstalk(v.1.2.0)</em>, <em>backports(v.1.4.1)</em>,
<em>annotate(v.1.76.0)</em>, <em>biomaRt(v.2.54.0)</em>,
<em>deldir(v.1.0-9)</em>, <em>sparseMatrixStats(v.1.10.0)</em>,
<em>vctrs(v.0.6.3)</em>, <em>here(v.1.0.1)</em>,
<em>ensembldb(v.2.22.0)</em>, <em>cachem(v.1.0.8)</em>,
<em>withr(v.2.5.0)</em>, <em>ggforce(v.0.4.1)</em>,
<em>Gviz(v.1.42.0)</em>, <em>BSgenome(v.1.66.3)</em>,
<em>checkmate(v.2.2.0)</em>, <em>vroom(v.1.6.3)</em>,
<em>GenomicAlignments(v.1.34.0)</em>, <em>fdrtool(v.1.2.17)</em>,
<em>prettyunits(v.1.1.1)</em>, <em>mclust(v.6.0.0)</em>,
<em>cluster(v.2.1.4)</em>, <em>lazyeval(v.0.2.2)</em>,
<em>crayon(v.1.5.2)</em>, <em>genefilter(v.1.80.0)</em>,
<em>labeling(v.0.4.2)</em>, <em>pkgconfig(v.2.0.3)</em>,
<em>slam(v.0.1-50)</em>, <em>tweenr(v.2.0.2)</em>,
<em>nlme(v.3.1-162)</em>, <em>ProtGenerics(v.1.30.0)</em>,
<em>nnet(v.7.3-19)</em>, <em>lifecycle(v.1.0.3)</em>,
<em>filelock(v.1.0.2)</em>, <em>BiocFileCache(v.2.6.0)</em>,
<em>dichromat(v.2.0-0.1)</em>, <em>VennDiagram(v.1.7.3)</em>,
<em>rprojroot(v.2.0.3)</em>, <em>polyclip(v.1.10-4)</em>,
<em>reactR(v.0.4.4)</em>, <em>rngtools(v.1.5.2)</em>,
<em>base64(v.2.0.1)</em>, <em>Matrix(v.1.5-4.1)</em>,
<em>lpsymphony(v.1.26.0)</em>, <em>Rhdf5lib(v.1.20.0)</em>,
<em>zoo(v.1.8-12)</em>, <em>base64enc(v.0.1-3)</em>,
<em>GlobalOptions(v.0.1.2)</em>, <em>png(v.0.1-8)</em>,
<em>viridisLite(v.0.4.2)</em>, <em>rjson(v.0.2.21)</em>,
<em>bitops(v.1.0-7)</em>, <em>rhdf5filters(v.1.10.0)</em>,
<em>blob(v.1.2.4)</em>, <em>DelayedMatrixStats(v.1.20.0)</em>,
<em>doRNG(v.1.8.6)</em>, <em>shape(v.1.4.6)</em>,
<em>nor1mix(v.1.3-0)</em>, <em>jpeg(v.0.1-10)</em>,
<em>memoise(v.2.0.1)</em>, <em>plyr(v.1.8.8)</em>,
<em>zlibbioc(v.1.44.0)</em>, <em>compiler(v.4.2.2)</em>,
<em>BiocIO(v.1.8.0)</em>, <em>illuminaio(v.0.40.0)</em>,
<em>RColorBrewer(v.1.1-3)</em>, <em>clue(v.0.3-64)</em>,
<em>cli(v.3.6.1)</em>, <em>htmlTable(v.2.4.1)</em>,
<em>formatR(v.1.14)</em>, <em>Formula(v.1.2-5)</em>,
<em>MASS(v.7.3-60)</em>, <em>mgcv(v.1.8-42)</em>,
<em>tidyselect(v.1.2.0)</em>, <em>stringi(v.1.7.12)</em>,
<em>highr(v.0.10)</em>, <em>askpass(v.1.1)</em>,
<em>locfit(v.1.5-9.8)</em>, <em>latticeExtra(v.0.6-30)</em>,
<em>grid(v.4.2.2)</em>, <em>sass(v.0.4.6)</em>,
<em>VariantAnnotation(v.1.44.0)</em>, <em>fastmatch(v.1.1-3)</em>,
<em>tools(v.4.2.2)</em>, <em>timechange(v.0.2.0)</em>,
<em>parallel(v.4.2.2)</em>, <em>circlize(v.0.4.15)</em>,
<em>rstudioapi(v.0.14)</em>, <em>foreach(v.1.5.2)</em>,
<em>foreign(v.0.8-84)</em>, <em>metapod(v.1.6.0)</em>,
<em>gridExtra(v.2.3)</em>, <em>farver(v.2.1.1)</em>,
<em>ComplexUpset(v.1.3.3)</em>, <em>digest(v.0.6.31)</em>,
<em>quadprog(v.1.5-8)</em>, <em>Rcpp(v.1.0.10)</em>,
<em>siggenes(v.1.72.0)</em>, <em>broom(v.1.0.5)</em>,
<em>httr(v.1.4.6)</em>, <em>ggdendro(v.0.1.23)</em>,
<em>AnnotationDbi(v.1.60.0)</em>, <em>biovizBase(v.1.46.0)</em>,
<em>ComplexHeatmap(v.2.14.0)</em>, <em>Rdpack(v.2.4)</em>,
<em>colorspace(v.2.1-0)</em>, <em>XML(v.3.99-0.14)</em>,
<em>splines(v.4.2.2)</em>, <em>graphlayouts(v.1.0.0)</em>,
<em>multtest(v.2.54.0)</em>, <em>plotly(v.4.10.2)</em>,
<em>xtable(v.1.8-4)</em>, <em>jsonlite(v.1.8.5)</em>,
<em>futile.options(v.1.0.1)</em>, <em>R6(v.2.5.1)</em>,
<em>Hmisc(v.5.1-0)</em>, <em>pillar(v.1.9.0)</em>,
<em>fastmap(v.1.1.1)</em>, <em>DT(v.0.28)</em>,
<em>beanplot(v.1.3.1)</em>, <em>codetools(v.0.2-19)</em>,
<em>utf8(v.1.2.3)</em>, <em>sva(v.3.46.0)</em>,
<em>lattice(v.0.21-8)</em>, <em>bslib(v.0.5.0)</em>,
<em>curl(v.5.0.1)</em>, <em>openssl(v.2.0.6)</em>,
<em>GO.db(v.3.16.0)</em>, <em>interp(v.1.1-4)</em>,
<em>survival(v.3.5-5)</em>, <em>rmarkdown(v.2.22)</em>,
<em>munsell(v.0.5.0)</em>, <em>GetoptLong(v.1.0.5)</em>,
<em>rhdf5(v.2.42.0)</em>, <em>GenomeInfoDbData(v.1.2.9)</em>,
<em>iterators(v.1.0.14)</em>, <em>HDF5Array(v.1.26.0)</em>,
<em>gtable(v.0.3.3)</em> and <em>rbibutils(v.2.2.13)</em></p>
</div>
</div>
</div>

<div class="footer">
  Workflow developed by:<br>
  Dr Stephen Pederson<br>
  Dame Roma Mitchell Cancer Research Laboratories<br>
  Adelaide Medical School, University of Adelaide, SA, Australia
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
